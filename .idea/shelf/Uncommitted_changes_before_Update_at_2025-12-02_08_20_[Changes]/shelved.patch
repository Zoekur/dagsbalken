Index: app/src/main/java/com/example/stalp/widget/LinearClockConfigActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.widget\r\n\r\nimport android.appwidget.AppWidgetManager\r\nimport android.content.Intent\r\nimport android.os.Bundle\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.setContent\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.*\r\nimport androidx.compose.material3.*\r\nimport androidx.compose.runtime.*\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.glance.appwidget.GlanceAppWidgetManager\r\nimport androidx.glance.appwidget.state.updateAppWidgetState\r\nimport androidx.glance.state.PreferencesGlanceStateDefinition\r\nimport androidx.datastore.preferences.core.MutablePreferences\r\nimport com.example.stalp.ui.settings.ThemePreferences\r\nimport com.example.stalp.ui.theme.StalpTheme\r\nimport com.example.stalp.ui.theme.ThemeOption\r\nimport com.example.stalp.ui.theme.ThemeSelector\r\nimport kotlinx.coroutines.launch\r\n\r\n// Datamodell för configen\r\ndata class WidgetConfig(\r\n    val font: String = LinearClockPrefs.DEF_FONT,\r\n    val scale: Float = LinearClockPrefs.DEF_SCALE,\r\n    val backgroundColor: Int = LinearClockPrefs.DEF_BG,\r\n    val textColor: Int = LinearClockPrefs.DEF_TEXT,\r\n    val accentColor: Int = LinearClockPrefs.DEF_ACCENT,\r\n    val hoursToShow: Int = LinearClockPrefs.DEF_HOURS_TO_SHOW\r\n)\r\n\r\nclass LinearClockConfigActivity : ComponentActivity() {\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n\r\n        // Hämta widget ID\r\n        val appWidgetId = intent?.getIntExtra(\r\n            AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID\r\n        ) ?: AppWidgetManager.INVALID_APPWIDGET_ID\r\n\r\n        if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {\r\n            setResult(RESULT_CANCELED)\r\n            finish()\r\n            return\r\n        }\r\n\r\n        setContent {\r\n            val themeOption by ThemePreferences.themeOptionFlow(applicationContext)\r\n                .collectAsState(initial = ThemeOption.NordicCalm)\r\n\r\n            // Lokalt state för konfigurationen\r\n            var config by remember { mutableStateOf(WidgetConfig()) }\r\n            val scope = rememberCoroutineScope()\r\n\r\n            StalpTheme(themeOption = themeOption, dynamicColorEnabled = false) {\r\n                Surface(Modifier.fillMaxSize()) {\r\n                    Column(Modifier.padding(16.dp)) {\r\n                        Text(\"Widget-inställningar\", style = MaterialTheme.typography.titleLarge)\r\n                        Spacer(Modifier.height(16.dp))\r\n\r\n                        // FÄRGVÄLJARE (Exempel)\r\n                        Text(\"Bakgrundsfärg\")\r\n                        Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {\r\n                            listOf(0xFFFFFFFF.toInt(), 0xFF111827.toInt()).forEach { c ->\r\n                                Box(\r\n                                    Modifier\r\n                                        .size(40.dp)\r\n                                        .background(Color(c))\r\n                                        .clickable { config = config.copy(backgroundColor = c) }\r\n                                )\r\n                            }\r\n                        }\r\n\r\n                        Spacer(Modifier.height(32.dp))\r\n\r\n                        // SPARA-KNAPP\r\n                        Button(\r\n                            onClick = {\r\n                                scope.launch {\r\n                                    val context = this@LinearClockConfigActivity\r\n                                    val manager = GlanceAppWidgetManager(context)\r\n                                    val glanceId = manager.getGlanceIdBy(appWidgetId)\r\n\r\n                                    if (glanceId != null) {\r\n                                        updateAppWidgetState(context, PreferencesGlanceStateDefinition, glanceId) { prefs ->\r\n                                            prefs.toMutablePreferences().apply {\r\n                                                this[LinearClockPrefs.FONT_FAMILY] = config.font\r\n                                                this[LinearClockPrefs.FONT_SCALE] = config.scale\r\n                                                this[LinearClockPrefs.COLOR_BG] = config.backgroundColor\r\n                                                this[LinearClockPrefs.COLOR_TEXT] = config.textColor\r\n                                                this[LinearClockPrefs.COLOR_ACCENT] = config.accentColor\r\n                                                this[LinearClockPrefs.HOURS_TO_SHOW] = config.hoursToShow\r\n                                            }\r\n                                        }\r\n                                        LinearClockWidget.update(context, glanceId)\r\n                                    }\r\n\r\n                                    val result = Intent().putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\r\n                                    setResult(RESULT_OK, result)\r\n                                    finish()\r\n                                }\r\n                            },\r\n                            modifier = Modifier.fillMaxWidth()\r\n                        ) { Text(\"Spara\") }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/widget/LinearClockConfigActivity.kt b/app/src/main/java/com/example/stalp/widget/LinearClockConfigActivity.kt
--- a/app/src/main/java/com/example/stalp/widget/LinearClockConfigActivity.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/widget/LinearClockConfigActivity.kt	(date 1764634261701)
@@ -7,108 +7,132 @@
 import androidx.activity.compose.setContent
 import androidx.compose.foundation.background
 import androidx.compose.foundation.clickable
-import androidx.compose.foundation.layout.*
-import androidx.compose.material3.*
-import androidx.compose.runtime.*
+import androidx.compose.foundation.layout.Arrangement
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.Column
+import androidx.compose.foundation.layout.Row
+import androidx.compose.foundation.layout.Spacer
+import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.fillMaxWidth
+import androidx.compose.foundation.layout.height
+import androidx.compose.foundation.layout.padding
+import androidx.compose.foundation.layout.size
+import androidx.compose.material3.Button
+import androidx.compose.material3.MaterialTheme
+import androidx.compose.material3.Surface
+import androidx.compose.material3.Text
+import androidx.compose.runtime.collectAsState
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.mutableStateOf
+import androidx.compose.runtime.remember
+import androidx.compose.runtime.rememberCoroutineScope
+import androidx.compose.runtime.setValue
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.unit.dp
 import androidx.glance.appwidget.GlanceAppWidgetManager
 import androidx.glance.appwidget.state.updateAppWidgetState
 import androidx.glance.state.PreferencesGlanceStateDefinition
-import androidx.datastore.preferences.core.MutablePreferences
 import com.example.stalp.ui.settings.ThemePreferences
 import com.example.stalp.ui.theme.StalpTheme
 import com.example.stalp.ui.theme.ThemeOption
-import com.example.stalp.ui.theme.ThemeSelector
 import kotlinx.coroutines.launch
 
 // Datamodell för configen
 data class WidgetConfig(
-    val font: String = LinearClockPrefs.DEF_FONT,
-    val scale: Float = LinearClockPrefs.DEF_SCALE,
-    val backgroundColor: Int = LinearClockPrefs.DEF_BG,
-    val textColor: Int = LinearClockPrefs.DEF_TEXT,
-    val accentColor: Int = LinearClockPrefs.DEF_ACCENT,
-    val hoursToShow: Int = LinearClockPrefs.DEF_HOURS_TO_SHOW
+	val font: String = LinearClockPrefs.DEF_FONT,
+	val scale: Float = LinearClockPrefs.DEF_SCALE,
+	val backgroundColor: Int = LinearClockPrefs.DEF_BG,
+	val textColor: Int = LinearClockPrefs.DEF_TEXT,
+	val accentColor: Int = LinearClockPrefs.DEF_ACCENT,
+	val hoursToShow: Int = LinearClockPrefs.DEF_HOURS_TO_SHOW
 )
 
 class LinearClockConfigActivity : ComponentActivity() {
-    override fun onCreate(savedInstanceState: Bundle?) {
-        super.onCreate(savedInstanceState)
+	override fun onCreate(savedInstanceState: Bundle?) {
+		super.onCreate(savedInstanceState)
 
-        // Hämta widget ID
-        val appWidgetId = intent?.getIntExtra(
-            AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID
-        ) ?: AppWidgetManager.INVALID_APPWIDGET_ID
+		// Hämta widget ID
+		val appWidgetId = intent?.getIntExtra(
+			AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID
+		) ?: AppWidgetManager.INVALID_APPWIDGET_ID
 
-        if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
-            setResult(RESULT_CANCELED)
-            finish()
-            return
-        }
+		if (appWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
+			setResult(RESULT_CANCELED)
+			finish()
+			return
+		}
 
-        setContent {
-            val themeOption by ThemePreferences.themeOptionFlow(applicationContext)
-                .collectAsState(initial = ThemeOption.NordicCalm)
+		setContent {
+			val themePreferences = remember { ThemePreferences(applicationContext) }
+			val themeOption by themePreferences.themeOptionFlow()
+				.collectAsState(initial = ThemeOption.NordicCalm)
 
-            // Lokalt state för konfigurationen
-            var config by remember { mutableStateOf(WidgetConfig()) }
-            val scope = rememberCoroutineScope()
+			// Lokalt state för konfigurationen
+			var config by remember { mutableStateOf(WidgetConfig()) }
+			val scope = rememberCoroutineScope()
 
-            StalpTheme(themeOption = themeOption, dynamicColorEnabled = false) {
-                Surface(Modifier.fillMaxSize()) {
-                    Column(Modifier.padding(16.dp)) {
-                        Text("Widget-inställningar", style = MaterialTheme.typography.titleLarge)
-                        Spacer(Modifier.height(16.dp))
+			StalpTheme(themeOption = themeOption, dynamicColorEnabled = false) {
+				Surface(Modifier.fillMaxSize()) {
+					Column(Modifier.padding(16.dp)) {
+						Text("Widget-inställningar", style = MaterialTheme.typography.titleLarge)
+						Spacer(Modifier.height(16.dp))
 
-                        // FÄRGVÄLJARE (Exempel)
-                        Text("Bakgrundsfärg")
-                        Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {
-                            listOf(0xFFFFFFFF.toInt(), 0xFF111827.toInt()).forEach { c ->
-                                Box(
-                                    Modifier
-                                        .size(40.dp)
-                                        .background(Color(c))
-                                        .clickable { config = config.copy(backgroundColor = c) }
-                                )
-                            }
-                        }
+						// FÄRGVÄLJARE (Exempel)
+						Text("Bakgrundsfärg")
+						Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {
+							listOf(0xFFFFFFFF.toInt(), 0xFF111827.toInt()).forEach { c ->
+								Box(
+									Modifier
+										.size(40.dp)
+										.background(Color(c))
+										.clickable { config = config.copy(backgroundColor = c) }
+								)
+							}
+						}
 
-                        Spacer(Modifier.height(32.dp))
+						Spacer(Modifier.height(32.dp))
 
-                        // SPARA-KNAPP
-                        Button(
-                            onClick = {
-                                scope.launch {
-                                    val context = this@LinearClockConfigActivity
-                                    val manager = GlanceAppWidgetManager(context)
-                                    val glanceId = manager.getGlanceIdBy(appWidgetId)
+						// SPARA-KNAPP
+						Button(
+							onClick = {
+								scope.launch {
+									val context = this@LinearClockConfigActivity
+									val manager = GlanceAppWidgetManager(context)
+									val glanceId = manager.getGlanceIdBy(appWidgetId)
 
-                                    if (glanceId != null) {
-                                        updateAppWidgetState(context, PreferencesGlanceStateDefinition, glanceId) { prefs ->
-                                            prefs.toMutablePreferences().apply {
-                                                this[LinearClockPrefs.FONT_FAMILY] = config.font
-                                                this[LinearClockPrefs.FONT_SCALE] = config.scale
-                                                this[LinearClockPrefs.COLOR_BG] = config.backgroundColor
-                                                this[LinearClockPrefs.COLOR_TEXT] = config.textColor
-                                                this[LinearClockPrefs.COLOR_ACCENT] = config.accentColor
-                                                this[LinearClockPrefs.HOURS_TO_SHOW] = config.hoursToShow
-                                            }
-                                        }
-                                        LinearClockWidget.update(context, glanceId)
-                                    }
+									updateAppWidgetState(
+										context,
+										PreferencesGlanceStateDefinition,
+										glanceId
+									) { prefs ->
+										prefs.toMutablePreferences().apply {
+											this[LinearClockPrefs.FONT_FAMILY] = config.font
+											this[LinearClockPrefs.FONT_SCALE] = config.scale
+											this[LinearClockPrefs.COLOR_BG] =
+												config.backgroundColor
+											this[LinearClockPrefs.COLOR_TEXT] = config.textColor
+											this[LinearClockPrefs.COLOR_ACCENT] =
+												config.accentColor
+											this[LinearClockPrefs.HOURS_TO_SHOW] =
+												config.hoursToShow
+										}
+									}
+									LinearClockWidget.update(context, glanceId)
 
-                                    val result = Intent().putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)
-                                    setResult(RESULT_OK, result)
-                                    finish()
-                                }
-                            },
-                            modifier = Modifier.fillMaxWidth()
-                        ) { Text("Spara") }
-                    }
-                }
-            }
-        }
-    }
+									val result = Intent().putExtra(
+										AppWidgetManager.EXTRA_APPWIDGET_ID,
+										appWidgetId
+									)
+									setResult(RESULT_OK, result)
+									finish()
+								}
+							},
+							modifier = Modifier.fillMaxWidth()
+						) { Text("Spara") }
+					}
+				}
+			}
+		}
+	}
 }
Index: app/src/main/java/com/example/stalp/MainActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp\r\n\r\nimport android.Manifest\r\nimport android.content.pm.PackageManager\r\nimport android.graphics.Paint\r\nimport android.graphics.Typeface\r\nimport android.os.Bundle\r\nimport androidx.activity.ComponentActivity\r\nimport androidx.activity.compose.rememberLauncherForActivityResult\r\nimport androidx.activity.compose.setContent\r\nimport androidx.activity.enableEdgeToEdge\r\nimport androidx.activity.result.contract.ActivityResultContracts\r\nimport androidx.activity.viewModels\r\nimport androidx.compose.foundation.Canvas\r\nimport androidx.compose.foundation.background\r\nimport androidx.compose.foundation.layout.Arrangement\r\nimport androidx.compose.foundation.layout.Box\r\nimport androidx.compose.foundation.layout.Column\r\nimport androidx.compose.foundation.layout.Row\r\nimport androidx.compose.foundation.layout.Spacer\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.foundation.layout.fillMaxWidth\r\nimport androidx.compose.foundation.layout.height\r\nimport androidx.compose.foundation.layout.padding\r\nimport androidx.compose.foundation.layout.size\r\nimport androidx.compose.foundation.layout.systemBarsPadding\r\nimport androidx.compose.foundation.shape.RoundedCornerShape\r\nimport androidx.compose.material3.Card\r\nimport androidx.compose.material3.CardDefaults\r\nimport androidx.compose.material3.CircularProgressIndicator\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.IconButton\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.Surface\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.DisposableEffect\r\nimport androidx.compose.runtime.LaunchedEffect\r\nimport androidx.compose.runtime.SideEffect\r\nimport androidx.compose.runtime.State\r\nimport androidx.compose.runtime.collectAsState\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.mutableStateOf\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.runtime.rememberCoroutineScope\r\nimport androidx.compose.runtime.setValue\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.geometry.CornerRadius\r\nimport androidx.compose.ui.geometry.Offset\r\nimport androidx.compose.ui.geometry.Size\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.graphics.StrokeCap\r\nimport androidx.compose.ui.graphics.drawscope.Stroke\r\nimport androidx.compose.ui.graphics.nativeCanvas\r\nimport androidx.compose.ui.graphics.toArgb\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.text.style.TextAlign\r\nimport androidx.compose.ui.unit.Dp\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.compose.ui.unit.sp\r\nimport androidx.core.content.ContextCompat\r\nimport androidx.lifecycle.Lifecycle\r\nimport androidx.lifecycle.LifecycleEventObserver\r\nimport androidx.lifecycle.ViewModel\r\nimport androidx.lifecycle.ViewModelProvider\r\nimport androidx.navigation.compose.NavHost\r\nimport androidx.navigation.compose.composable\r\nimport androidx.navigation.compose.rememberNavController\r\nimport com.example.stalp.data.CalendarRepository\r\nimport com.example.stalp.data.DayEvent\r\nimport com.example.stalp.data.WeatherData\r\nimport com.example.stalp.data.WeatherRepository\r\nimport com.example.stalp.ui.MainViewModel\r\nimport com.example.stalp.ui.icons.StalpIcons\r\nimport com.example.stalp.ui.settings.SettingsScreen\r\nimport com.example.stalp.ui.settings.ThemePreferences\r\nimport com.example.stalp.ui.theme.StalpTheme\r\nimport com.example.stalp.ui.theme.ThemeOption\r\nimport com.example.stalp.ui.theme.ThemeSelector\r\nimport com.example.stalp.workers.WeatherWorker\r\nimport kotlinx.coroutines.delay\r\nimport kotlinx.coroutines.launch\r\nimport java.time.LocalDateTime\r\nimport java.time.LocalTime\r\nimport java.time.format.DateTimeFormatter\r\n\r\n// -------- HUVUDAKTIVITET --------\r\nclass MainActivity : ComponentActivity() {\r\n\r\n    private val viewModel: MainViewModel by viewModels {\r\n        object : ViewModelProvider.Factory {\r\n            override fun <T : ViewModel> create(modelClass: Class<T>): T {\r\n                val themePrefs = ThemePreferences(applicationContext)\r\n                @Suppress(\"UNCHECKED_CAST\")\r\n                return MainViewModel(themePrefs) as T\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        // Enable Edge to Edge to draw behind system bars\r\n        enableEdgeToEdge()\r\n\r\n        // Schemalägger väder-workern att starta så snart appen öppnas\r\n        WeatherWorker.schedule(applicationContext)\r\n\r\n        setContent {\r\n            val themeOption by viewModel.themeOptionFlow\r\n                .collectAsState(initial = ThemeOption.NordicCalm)\r\n\r\n            StalpTheme(themeOption = themeOption) {\r\n                Surface(Modifier.fillMaxSize()) {\r\n                    val navController = rememberNavController()\r\n\r\n                    NavHost(navController = navController, startDestination = \"home\") {\r\n                        composable(\"home\") {\r\n                            LinearClockScreen(\r\n                                themeOption = themeOption,\r\n                                onThemeOptionChange = { option ->\r\n                                    viewModel.onThemeOptionChange(option)\r\n                                },\r\n                                onSettingsClick = {\r\n                                    navController.navigate(\"settings\")\r\n                                }\r\n                            )\r\n                        }\r\n                        composable(\"settings\") {\r\n                            SettingsScreen(onBack = {\r\n                                navController.popBackStack()\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// -------- SKÄRM (Kombinerar tidslinje & kort) --------\r\n@Composable\r\nfun LinearClockScreen(\r\n    themeOption: ThemeOption,\r\n    onThemeOptionChange: (ThemeOption) -> Unit,\r\n    onSettingsClick: () -> Unit\r\n) {\r\n    val context = LocalContext.current\r\n    val scope = rememberCoroutineScope()\r\n    val weatherRepository = remember { WeatherRepository(context) }\r\n    val calendarRepository = remember { CalendarRepository(context) }\r\n    val lifecycleOwner = androidx.lifecycle.compose.LocalLifecycleOwner.current\r\n\r\n    // Samlar in väderdata från DataStore i realtid\r\n    val weatherData by weatherRepository.weatherDataFlow.collectAsState(initial = WeatherData())\r\n\r\n    // Events state\r\n    var events by remember { mutableStateOf(emptyList<DayEvent>()) }\r\n\r\n    // Funktion för att ladda events\r\n    fun loadEvents() {\r\n        if (ContextCompat.checkSelfPermission(\r\n                context,\r\n                Manifest.permission.READ_CALENDAR\r\n            ) == PackageManager.PERMISSION_GRANTED\r\n        ) {\r\n            scope.launch {\r\n                events = calendarRepository.getEventsForToday()\r\n            }\r\n        }\r\n    }\r\n\r\n    // Permission launcher\r\n    val launcher = rememberLauncherForActivityResult(\r\n        contract = ActivityResultContracts.RequestPermission(),\r\n        onResult = { isGranted: Boolean ->\r\n            if (isGranted) {\r\n                loadEvents()\r\n            }\r\n        }\r\n    )\r\n\r\n    // Lyssna på Lifecycle ON_RESUME för att uppdatera events om användaren ändrat kalendern\r\n    DisposableEffect(lifecycleOwner) {\r\n        val observer = LifecycleEventObserver { _, event ->\r\n            if (event == Lifecycle.Event.ON_RESUME) {\r\n                loadEvents()\r\n            }\r\n        }\r\n        lifecycleOwner.lifecycle.addObserver(observer)\r\n        onDispose {\r\n            lifecycleOwner.lifecycle.removeObserver(observer)\r\n        }\r\n    }\r\n\r\n    // Initiera laddning vid start om permission finns, annars fråga\r\n    LaunchedEffect(Unit) {\r\n        if (ContextCompat.checkSelfPermission(\r\n                context,\r\n                Manifest.permission.READ_CALENDAR\r\n            ) != PackageManager.PERMISSION_GRANTED\r\n        ) {\r\n            launcher.launch(Manifest.permission.READ_CALENDAR)\r\n        }\r\n    }\r\n\r\n    val now by rememberTicker1s()\r\n\r\n    Column(\r\n        Modifier\r\n            .fillMaxSize()\r\n            .systemBarsPadding() // Fixar \"black bar\" problemet genom att undvika system bars\r\n            .padding(horizontal = 16.dp, vertical = 8.dp),\r\n        horizontalAlignment = Alignment.CenterHorizontally\r\n    ) {\r\n        // TOP HEADER: Title (Left) + Settings (Right)\r\n        Row(\r\n            modifier = Modifier.fillMaxWidth().padding(top = 8.dp),\r\n            horizontalArrangement = Arrangement.SpaceBetween,\r\n            verticalAlignment = Alignment.CenterVertically\r\n        ) {\r\n            Text(\r\n                text = \"Stalp\",\r\n                style = MaterialTheme.typography.titleLarge,\r\n                fontWeight = FontWeight.Bold,\r\n                fontSize = 24.sp\r\n            )\r\n\r\n            IconButton(onClick = onSettingsClick) {\r\n                Icon(\r\n                    imageVector = StalpIcons.Settings,\r\n                    contentDescription = \"Settings\",\r\n                    tint = MaterialTheme.colorScheme.onSurface\r\n                )\r\n            }\r\n        }\r\n\r\n        Spacer(Modifier.height(8.dp))\r\n\r\n        // Theme Selector\r\n        ThemeSelector(\r\n            selectedOption = themeOption,\r\n            onOptionSelected = onThemeOptionChange,\r\n        )\r\n\r\n        Spacer(Modifier.height(24.dp))\r\n\r\n        // 1. Tidslinjen (Huvudkomponenten) - Nu med dubbel höjd och hela dygnet\r\n        LinearDayCard(\r\n            now = now.toLocalTime(),\r\n            height = 168.dp,\r\n            events = events\r\n        )\r\n\r\n        Spacer(Modifier.height(16.dp))\r\n\r\n        // 2. Nästa Händelse (Tilläggsinformation)\r\n        NextEventCard(events = events, now = now.toLocalTime())\r\n\r\n        Spacer(Modifier.height(24.dp))\r\n\r\n        // 3. Väder- och Klädrådsrutor\r\n        Row(\r\n            modifier = Modifier.fillMaxWidth(),\r\n            horizontalArrangement = Arrangement.spacedBy(16.dp)\r\n        ) {\r\n            // Väderinformationsruta (Vänster)\r\n            WeatherInfoCard(modifier = Modifier.weight(1f), data = weatherData)\r\n\r\n            // Klädrådsruta (Höger)\r\n            ClothingAdviceCard(modifier = Modifier.weight(1f), data = weatherData)\r\n        }\r\n\r\n        Spacer(Modifier.height(16.dp))\r\n\r\n        // Version info\r\n        Text(\r\n            text = \"v${BuildConfig.VERSION_NAME}\",\r\n            style = MaterialTheme.typography.labelSmall,\r\n            color = Color.Gray.copy(alpha = 0.5f)\r\n        )\r\n    }\r\n}\r\n\r\n// ----------------------------------------------------------\r\n// 1. TIDSLINJE KOMPONENTER\r\n// ----------------------------------------------------------\r\n\r\n@Composable\r\nfun LinearDayCard(\r\n    now: LocalTime,\r\n    height: Dp = 160.dp,\r\n    events: List<DayEvent> = emptyList()\r\n) {\r\n    val hourLabelPaint = remember {\r\n        Paint().apply {\r\n            textAlign = Paint.Align.CENTER\r\n            textSize = 36f\r\n            isAntiAlias = true\r\n            typeface = Typeface.DEFAULT_BOLD\r\n        }\r\n    }\r\n    val hourLabelColor = MaterialTheme.colorScheme.onSurface.toArgb()\r\n    SideEffect { hourLabelPaint.color = hourLabelColor }\r\n\r\n    val cornerRadiusDp = 28.dp\r\n\r\n    // Theme colors\r\n    val surfaceColor = MaterialTheme.colorScheme.surface\r\n    val trackBgColor = MaterialTheme.colorScheme.surfaceVariant\r\n    val borderColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.75f)\r\n    val tickColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)\r\n    val passedColor = Color(0xFFB7EA27)\r\n    val nowColor = Color(0xFFEF4444)\r\n\r\n    Box(\r\n        Modifier\r\n            .fillMaxWidth()\r\n            .height(height + 24.dp)\r\n            .background(Color.Transparent)\r\n    ) {\r\n        // Yttre kapsel (Bakgrund)\r\n        Box(\r\n            Modifier\r\n                .align(Alignment.TopCenter)\r\n                .fillMaxWidth()\r\n                .height(height)\r\n                .background(surfaceColor, RoundedCornerShape(cornerRadiusDp))\r\n        )\r\n\r\n        // Canvas för tidslinje (00 - 24)\r\n        Canvas(\r\n            modifier = Modifier\r\n                .align(Alignment.TopCenter)\r\n                .fillMaxWidth()\r\n                .height(height)\r\n        ) {\r\n            val pad = 20.dp.toPx()\r\n            val trackTop = size.height * 0.10f\r\n            val trackHeight = size.height * 0.80f\r\n            val right = size.width - pad\r\n            val trackWidth = right - pad\r\n            val left = pad\r\n            val cornerRadiusPx = 24f\r\n\r\n            // Inre kapsel (Bakgrund)\r\n            drawRoundRect(\r\n                color = trackBgColor,\r\n                topLeft = Offset(left, trackTop),\r\n                size = Size(trackWidth, trackHeight),\r\n                cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)\r\n            )\r\n\r\n            // Beräkna pixlar per minut för HELA dygnet (24h = 1440 min)\r\n            val totalMinutes = 24 * 60\r\n            val pxPerMin = trackWidth / totalMinutes\r\n\r\n            // Rita events\r\n            events.forEach { event ->\r\n                val startMin = event.start.hour * 60 + event.start.minute\r\n                val endMin = (event.end?.hour ?: 0) * 60 + (event.end?.minute ?: 0)\r\n\r\n                // Enkel hantering av events som går över midnatt eller saknar slut -> visa 1h\r\n                val actualEndMin = if (event.end != null && endMin > startMin) endMin else startMin + 60\r\n\r\n                val eventStartPx = left + (startMin * pxPerMin)\r\n                val eventWidthPx = (actualEndMin - startMin) * pxPerMin\r\n\r\n                // Rita event som ett färgat block (svagt)\r\n                drawRect(\r\n                    color = event.color.copy(alpha = 0.3f),\r\n                    topLeft = Offset(eventStartPx, trackTop),\r\n                    size = Size(eventWidthPx, trackHeight)\r\n                )\r\n            }\r\n\r\n            // Nuvarande tid i minuter\r\n            val currentMinutes = now.hour * 60 + now.minute\r\n            val currentX = left + (currentMinutes * pxPerMin)\r\n\r\n            // Grön fyllnad (Från 00:00 till nu)\r\n            val passedWidth = currentX - left\r\n            if (passedWidth > 0) {\r\n                 drawRoundRect(\r\n                    color = passedColor,\r\n                    topLeft = Offset(left, trackTop),\r\n                    size = Size(passedWidth, trackHeight),\r\n                    cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)\r\n                )\r\n                 // Om \"passed\" är bredare än radiens kurva, rita en fyrkant över högra hörnen\r\n                 // för att få en skarp kant mot \"framtiden\" (eller behåll rundad om det är designen)\r\n                 // Här behåller vi den klippt vid 'currentX' men säkerställer att vi inte ritar utanför vänster kant.\r\n                 if (passedWidth > cornerRadiusPx) {\r\n                     // Fyll ut högra hörnen så det ser ut som progress bar som fortsätter\r\n                     drawRect(\r\n                         color = passedColor,\r\n                         topLeft = Offset(currentX - 10f, trackTop), // Lite överlapp\r\n                         size = Size(10f, trackHeight)\r\n                     )\r\n                 }\r\n            }\r\n\r\n            // Inre kapsel (Border - ritas ovanpå för snyggare kant)\r\n            drawRoundRect(\r\n                color = borderColor,\r\n                topLeft = Offset(left, trackTop),\r\n                size = Size(trackWidth, trackHeight),\r\n                style = Stroke(width = 2f),\r\n                cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)\r\n            )\r\n\r\n            // Loopa igenom 24 timmar\r\n            for (h in 0..24) {\r\n                val min = h * 60\r\n                val x = left + (min * pxPerMin)\r\n\r\n                // Rita Tim-markering (långt streck)\r\n                drawLine(\r\n                    color = tickColor,\r\n                    start = Offset(x, trackTop),\r\n                    end = Offset(x, trackTop + trackHeight * 0.4f),\r\n                    strokeWidth = 2f\r\n                )\r\n\r\n                // Text: Endast för 6, 12, 18, 24\r\n                if (h % 6 == 0 && h != 0) {\r\n                    val label = h.toString()\r\n                    drawContext.canvas.nativeCanvas.drawText(\r\n                        label,\r\n                        x,\r\n                        trackTop + trackHeight / 2f + 18f,\r\n                        hourLabelPaint\r\n                    )\r\n                }\r\n\r\n                // Halvtimmar (korta streck) - men inte efter 24\r\n                if (h < 24) {\r\n                    val halfMin = min + 30\r\n                    val halfX = left + (halfMin * pxPerMin)\r\n                    drawLine(\r\n                        color = tickColor.copy(alpha = 0.3f),\r\n                        start = Offset(halfX, trackTop),\r\n                        end = Offset(halfX, trackTop + trackHeight * 0.2f),\r\n                        strokeWidth = 2f\r\n                    )\r\n                }\r\n            }\r\n\r\n            // Nu-markör (röd linje)\r\n            drawLine(\r\n                color = nowColor,\r\n                start = Offset(currentX, trackTop),\r\n                end = Offset(currentX, trackTop + trackHeight),\r\n                strokeWidth = 4f,\r\n                cap = StrokeCap.Square\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n// -------- NÄSTA HÄNDELSE --------\r\n@Composable\r\nfun NextEventCard(events: List<DayEvent>, now: LocalTime) {\r\n    val sortedEvents = remember(events) { events.sortedBy { it.start } }\r\n    val next = remember(sortedEvents, now) {\r\n        // Hitta nästa händelse som inte har passerat (minus 1 minut för att hantera tickern)\r\n        sortedEvents.firstOrNull { !it.start.isBefore(now.minusMinutes(1)) }\r\n    } ?: return\r\n\r\n    Row(\r\n        Modifier\r\n            .fillMaxWidth()\r\n            .background(Color(0xFFF7F7F7), RoundedCornerShape(16.dp))\r\n            .padding(16.dp),\r\n        verticalAlignment = Alignment.CenterVertically\r\n    ) {\r\n        Text(next.icon ?: \"•\", fontSize = 22.sp, modifier = Modifier.padding(end = 8.dp))\r\n        Column {\r\n            Text(next.title, fontSize = 18.sp, fontWeight = FontWeight.Medium)\r\n            Text(\r\n                text = \"${next.start.format(DateTimeFormatter.ofPattern(\"HH:mm\"))}${\r\n                    next.end?.let {\r\n                        \" – ${\r\n                            it.format(\r\n                                DateTimeFormatter.ofPattern(\"HH:mm\")\r\n                            )\r\n                        }\"\r\n                    } ?: \"\"\r\n                }\",\r\n                color = Color(0xFF6B7280),\r\n                fontSize = 14.sp\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\n// ----------------------------------------------------------\r\n// 2. VÄDER-KOMPONENT (Uppdaterad för att ta emot data)\r\n// ----------------------------------------------------------\r\n\r\n@Composable\r\nfun WeatherInfoCard(modifier: Modifier = Modifier, data: WeatherData) {\r\n    Card(\r\n        modifier = modifier.height(200.dp),\r\n        shape = RoundedCornerShape(12.dp),\r\n        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),\r\n        elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)\r\n    ) {\r\n        Box(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(16.dp),\r\n            contentAlignment = Alignment.Center\r\n        ) {\r\n            if (!data.isDataLoaded) {\r\n                // Laddningsindikator\r\n                Column(horizontalAlignment = Alignment.CenterHorizontally) {\r\n                    CircularProgressIndicator(modifier = Modifier.size(32.dp))\r\n                    Spacer(Modifier.height(8.dp))\r\n                    Text(\"Laddar väderdata...\", fontSize = 14.sp, color = Color.Gray)\r\n                }\r\n            } else {\r\n                // Visar riktig data\r\n                Column(horizontalAlignment = Alignment.CenterHorizontally) {\r\n                    Text(\r\n                        \"Väderinformation\",\r\n                        style = MaterialTheme.typography.titleMedium,\r\n                        color = MaterialTheme.colorScheme.onSurface\r\n                    )\r\n                    Spacer(Modifier.height(8.dp))\r\n                    Text(\r\n                        \"${data.temperatureCelsius}°C\",\r\n                        fontSize = 32.sp,\r\n                        fontWeight = FontWeight.Bold,\r\n                        color = MaterialTheme.colorScheme.onSurface\r\n                    )\r\n                    Text(\r\n                        \"${data.precipitationChance}% risk för nederbörd\",\r\n                        fontSize = 16.sp,\r\n                        color = Color.Gray\r\n                    )\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ----------------------------------------------------------\r\n// 3. KLÄDRÅDS-KOMPONENT (Uppdaterad för att ta emot data)\r\n// ----------------------------------------------------------\r\n\r\n@Composable\r\nfun ClothingAdviceCard(modifier: Modifier = Modifier, data: WeatherData) {\r\n    Card(\r\n        modifier = modifier.height(200.dp),\r\n        shape = RoundedCornerShape(12.dp),\r\n        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),\r\n        elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)\r\n    ) {\r\n        Box(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(16.dp),\r\n            contentAlignment = Alignment.Center\r\n        ) {\r\n            if (!data.isDataLoaded) {\r\n                // Laddningsindikator (synkroniserad med väderkortet)\r\n                Column(horizontalAlignment = Alignment.CenterHorizontally) {\r\n                    Text(data.adviceIcon, fontSize = 48.sp)\r\n                    Text(\r\n                        data.adviceText,\r\n                        fontSize = 12.sp,\r\n                        textAlign = TextAlign.Center,\r\n                        modifier = Modifier.padding(top = 8.dp)\r\n                    )\r\n                }\r\n            } else {\r\n                // Visar klädråd baserat på logik i WeatherRepository\r\n                Column(horizontalAlignment = Alignment.CenterHorizontally) {\r\n                    Text(\r\n                        \"Klädråd\",\r\n                        style = MaterialTheme.typography.titleMedium,\r\n                        color = MaterialTheme.colorScheme.onSurface\r\n                    )\r\n                    Spacer(Modifier.height(8.dp))\r\n                    Text(data.adviceIcon, fontSize = 48.sp)\r\n                    Text(\r\n                        data.adviceText,\r\n                        fontSize = 12.sp,\r\n                        color = Color.Gray,\r\n                        textAlign = TextAlign.Center\r\n                    )\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// -------- HJÄLPARE --------\r\n\r\n// -------- ENKEL TICKER --------\r\n@Composable\r\nfun rememberTicker1s(): State<LocalDateTime> {\r\n    val state = remember { mutableStateOf(LocalDateTime.now()) }\r\n    LaunchedEffect(Unit) {\r\n        while (true) {\r\n            // Uppdatera varje minut (eller oftare vid behov, men minut räcker för UI)\r\n            state.value = LocalDateTime.now()\r\n            delay(60000)\r\n        }\r\n    }\r\n    return state\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/MainActivity.kt b/app/src/main/java/com/example/stalp/MainActivity.kt
--- a/app/src/main/java/com/example/stalp/MainActivity.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/MainActivity.kt	(date 1764633892677)
@@ -89,198 +89,200 @@
 // -------- HUVUDAKTIVITET --------
 class MainActivity : ComponentActivity() {
 
-    private val viewModel: MainViewModel by viewModels {
-        object : ViewModelProvider.Factory {
-            override fun <T : ViewModel> create(modelClass: Class<T>): T {
-                val themePrefs = ThemePreferences(applicationContext)
-                @Suppress("UNCHECKED_CAST")
-                return MainViewModel(themePrefs) as T
-            }
-        }
-    }
+	private val viewModel: MainViewModel by viewModels {
+		object : ViewModelProvider.Factory {
+			override fun <T : ViewModel> create(modelClass: Class<T>): T {
+				val themePrefs = ThemePreferences(applicationContext)
+				@Suppress("UNCHECKED_CAST")
+				return MainViewModel(themePrefs) as T
+			}
+		}
+	}
 
-    override fun onCreate(savedInstanceState: Bundle?) {
-        super.onCreate(savedInstanceState)
-        // Enable Edge to Edge to draw behind system bars
-        enableEdgeToEdge()
+	override fun onCreate(savedInstanceState: Bundle?) {
+		super.onCreate(savedInstanceState)
+		// Enable Edge to Edge to draw behind system bars
+		enableEdgeToEdge()
 
-        // Schemalägger väder-workern att starta så snart appen öppnas
-        WeatherWorker.schedule(applicationContext)
+		// Schemalägger väder-workern att starta så snart appen öppnas
+		WeatherWorker.schedule(applicationContext)
 
-        setContent {
-            val themeOption by viewModel.themeOptionFlow
-                .collectAsState(initial = ThemeOption.NordicCalm)
+		setContent {
+			val themeOption by viewModel.themeOptionFlow
+				.collectAsState(initial = ThemeOption.NordicCalm)
 
-            StalpTheme(themeOption = themeOption) {
-                Surface(Modifier.fillMaxSize()) {
-                    val navController = rememberNavController()
+			StalpTheme(themeOption = themeOption) {
+				Surface(Modifier.fillMaxSize()) {
+					val navController = rememberNavController()
 
-                    NavHost(navController = navController, startDestination = "home") {
-                        composable("home") {
-                            LinearClockScreen(
-                                themeOption = themeOption,
-                                onThemeOptionChange = { option ->
-                                    viewModel.onThemeOptionChange(option)
-                                },
-                                onSettingsClick = {
-                                    navController.navigate("settings")
-                                }
-                            )
-                        }
-                        composable("settings") {
-                            SettingsScreen(onBack = {
-                                navController.popBackStack()
-                            })
-                        }
-                    }
-                }
-            }
-        }
-    }
+					NavHost(navController = navController, startDestination = "home") {
+						composable("home") {
+							LinearClockScreen(
+								themeOption = themeOption,
+								onThemeOptionChange = { option ->
+									viewModel.onThemeOptionChange(option)
+								},
+								onSettingsClick = {
+									navController.navigate("settings")
+								}
+							)
+						}
+						composable("settings") {
+							SettingsScreen(onBack = {
+								navController.popBackStack()
+							})
+						}
+					}
+				}
+			}
+		}
+	}
 }
 
 // -------- SKÄRM (Kombinerar tidslinje & kort) --------
 @Composable
 fun LinearClockScreen(
-    themeOption: ThemeOption,
-    onThemeOptionChange: (ThemeOption) -> Unit,
-    onSettingsClick: () -> Unit
+	themeOption: ThemeOption,
+	onThemeOptionChange: (ThemeOption) -> Unit,
+	onSettingsClick: () -> Unit
 ) {
-    val context = LocalContext.current
-    val scope = rememberCoroutineScope()
-    val weatherRepository = remember { WeatherRepository(context) }
-    val calendarRepository = remember { CalendarRepository(context) }
-    val lifecycleOwner = androidx.lifecycle.compose.LocalLifecycleOwner.current
+	val context = LocalContext.current
+	val scope = rememberCoroutineScope()
+	val weatherRepository = remember { WeatherRepository(context) }
+	val calendarRepository = remember { CalendarRepository(context) }
+	val lifecycleOwner = androidx.lifecycle.compose.LocalLifecycleOwner.current
 
-    // Samlar in väderdata från DataStore i realtid
-    val weatherData by weatherRepository.weatherDataFlow.collectAsState(initial = WeatherData())
+	// Samlar in väderdata från DataStore i realtid
+	val weatherData by weatherRepository.weatherDataFlow.collectAsState(initial = WeatherData())
 
-    // Events state
-    var events by remember { mutableStateOf(emptyList<DayEvent>()) }
+	// Events state
+	var events by remember { mutableStateOf(emptyList<DayEvent>()) }
 
-    // Funktion för att ladda events
-    fun loadEvents() {
-        if (ContextCompat.checkSelfPermission(
-                context,
-                Manifest.permission.READ_CALENDAR
-            ) == PackageManager.PERMISSION_GRANTED
-        ) {
-            scope.launch {
-                events = calendarRepository.getEventsForToday()
-            }
-        }
-    }
+	// Funktion för att ladda events
+	fun loadEvents() {
+		if (ContextCompat.checkSelfPermission(
+				context,
+				Manifest.permission.READ_CALENDAR
+			) == PackageManager.PERMISSION_GRANTED
+		) {
+			scope.launch {
+				events = calendarRepository.getEventsForToday()
+			}
+		}
+	}
 
-    // Permission launcher
-    val launcher = rememberLauncherForActivityResult(
-        contract = ActivityResultContracts.RequestPermission(),
-        onResult = { isGranted: Boolean ->
-            if (isGranted) {
-                loadEvents()
-            }
-        }
-    )
+	// Permission launcher
+	val launcher = rememberLauncherForActivityResult(
+		contract = ActivityResultContracts.RequestPermission(),
+		onResult = { isGranted: Boolean ->
+			if (isGranted) {
+				loadEvents()
+			}
+		}
+	)
 
-    // Lyssna på Lifecycle ON_RESUME för att uppdatera events om användaren ändrat kalendern
-    DisposableEffect(lifecycleOwner) {
-        val observer = LifecycleEventObserver { _, event ->
-            if (event == Lifecycle.Event.ON_RESUME) {
-                loadEvents()
-            }
-        }
-        lifecycleOwner.lifecycle.addObserver(observer)
-        onDispose {
-            lifecycleOwner.lifecycle.removeObserver(observer)
-        }
-    }
+	// Lyssna på Lifecycle ON_RESUME för att uppdatera events om användaren ändrat kalendern
+	DisposableEffect(lifecycleOwner) {
+		val observer = LifecycleEventObserver { _, event ->
+			if (event == Lifecycle.Event.ON_RESUME) {
+				loadEvents()
+			}
+		}
+		lifecycleOwner.lifecycle.addObserver(observer)
+		onDispose {
+			lifecycleOwner.lifecycle.removeObserver(observer)
+		}
+	}
 
-    // Initiera laddning vid start om permission finns, annars fråga
-    LaunchedEffect(Unit) {
-        if (ContextCompat.checkSelfPermission(
-                context,
-                Manifest.permission.READ_CALENDAR
-            ) != PackageManager.PERMISSION_GRANTED
-        ) {
-            launcher.launch(Manifest.permission.READ_CALENDAR)
-        }
-    }
+	// Initiera laddning vid start om permission finns, annars fråga
+	LaunchedEffect(Unit) {
+		if (ContextCompat.checkSelfPermission(
+				context,
+				Manifest.permission.READ_CALENDAR
+			) != PackageManager.PERMISSION_GRANTED
+		) {
+			launcher.launch(Manifest.permission.READ_CALENDAR)
+		}
+	}
 
-    val now by rememberTicker1s()
+	val now by rememberTicker1s()
 
-    Column(
-        Modifier
-            .fillMaxSize()
-            .systemBarsPadding() // Fixar "black bar" problemet genom att undvika system bars
-            .padding(horizontal = 16.dp, vertical = 8.dp),
-        horizontalAlignment = Alignment.CenterHorizontally
-    ) {
-        // TOP HEADER: Title (Left) + Settings (Right)
-        Row(
-            modifier = Modifier.fillMaxWidth().padding(top = 8.dp),
-            horizontalArrangement = Arrangement.SpaceBetween,
-            verticalAlignment = Alignment.CenterVertically
-        ) {
-            Text(
-                text = "Stalp",
-                style = MaterialTheme.typography.titleLarge,
-                fontWeight = FontWeight.Bold,
-                fontSize = 24.sp
-            )
+	Column(
+		Modifier
+			.fillMaxSize()
+			.systemBarsPadding() // Fixar "black bar" problemet genom att undvika system bars
+			.padding(horizontal = 16.dp, vertical = 8.dp),
+		horizontalAlignment = Alignment.CenterHorizontally
+	) {
+		// TOP HEADER: Title (Left) + Settings (Right)
+		Row(
+			modifier = Modifier
+				.fillMaxWidth()
+				.padding(top = 8.dp),
+			horizontalArrangement = Arrangement.SpaceBetween,
+			verticalAlignment = Alignment.CenterVertically
+		) {
+			Text(
+				text = "Stalp",
+				style = MaterialTheme.typography.titleLarge,
+				fontWeight = FontWeight.Bold,
+				fontSize = 24.sp
+			)
 
-            IconButton(onClick = onSettingsClick) {
-                Icon(
-                    imageVector = StalpIcons.Settings,
-                    contentDescription = "Settings",
-                    tint = MaterialTheme.colorScheme.onSurface
-                )
-            }
-        }
+			IconButton(onClick = onSettingsClick) {
+				Icon(
+					imageVector = StalpIcons.Settings,
+					contentDescription = "Settings",
+					tint = MaterialTheme.colorScheme.onSurface
+				)
+			}
+		}
 
-        Spacer(Modifier.height(8.dp))
+		Spacer(Modifier.height(8.dp))
 
-        // Theme Selector
-        ThemeSelector(
-            selectedOption = themeOption,
-            onOptionSelected = onThemeOptionChange,
-        )
+		// Theme Selector
+		ThemeSelector(
+			selectedOption = themeOption,
+			onOptionSelected = onThemeOptionChange,
+		)
 
-        Spacer(Modifier.height(24.dp))
+		Spacer(Modifier.height(24.dp))
 
-        // 1. Tidslinjen (Huvudkomponenten) - Nu med dubbel höjd och hela dygnet
-        LinearDayCard(
-            now = now.toLocalTime(),
-            height = 168.dp,
-            events = events
-        )
+		// 1. Tidslinjen (Huvudkomponenten) - Nu med dubbel höjd och hela dygnet
+		LinearDayCard(
+			now = now.toLocalTime(),
+			height = 168.dp,
+			events = events
+		)
 
-        Spacer(Modifier.height(16.dp))
+		Spacer(Modifier.height(16.dp))
 
-        // 2. Nästa Händelse (Tilläggsinformation)
-        NextEventCard(events = events, now = now.toLocalTime())
+		// 2. Nästa Händelse (Tilläggsinformation)
+		NextEventCard(events = events, now = now.toLocalTime())
 
-        Spacer(Modifier.height(24.dp))
+		Spacer(Modifier.height(24.dp))
 
-        // 3. Väder- och Klädrådsrutor
-        Row(
-            modifier = Modifier.fillMaxWidth(),
-            horizontalArrangement = Arrangement.spacedBy(16.dp)
-        ) {
-            // Väderinformationsruta (Vänster)
-            WeatherInfoCard(modifier = Modifier.weight(1f), data = weatherData)
+		// 3. Väder- och Klädrådsrutor
+		Row(
+			modifier = Modifier.fillMaxWidth(),
+			horizontalArrangement = Arrangement.spacedBy(16.dp)
+		) {
+			// Väderinformationsruta (Vänster)
+			WeatherInfoCard(modifier = Modifier.weight(1f), data = weatherData)
 
-            // Klädrådsruta (Höger)
-            ClothingAdviceCard(modifier = Modifier.weight(1f), data = weatherData)
-        }
+			// Klädrådsruta (Höger)
+			ClothingAdviceCard(modifier = Modifier.weight(1f), data = weatherData)
+		}
 
-        Spacer(Modifier.height(16.dp))
+		Spacer(Modifier.height(16.dp))
 
-        // Version info
-        Text(
-            text = "v${BuildConfig.VERSION_NAME}",
-            style = MaterialTheme.typography.labelSmall,
-            color = Color.Gray.copy(alpha = 0.5f)
-        )
-    }
+		// Version info
+		Text(
+			text = "v${BuildConfig.VERSION_NAME}",
+			style = MaterialTheme.typography.labelSmall,
+			color = Color.Gray.copy(alpha = 0.5f)
+		)
+	}
 }
 
 // ----------------------------------------------------------
@@ -289,210 +291,211 @@
 
 @Composable
 fun LinearDayCard(
-    now: LocalTime,
-    height: Dp = 160.dp,
-    events: List<DayEvent> = emptyList()
+	now: LocalTime,
+	height: Dp = 160.dp,
+	events: List<DayEvent> = emptyList()
 ) {
-    val hourLabelPaint = remember {
-        Paint().apply {
-            textAlign = Paint.Align.CENTER
-            textSize = 36f
-            isAntiAlias = true
-            typeface = Typeface.DEFAULT_BOLD
-        }
-    }
-    val hourLabelColor = MaterialTheme.colorScheme.onSurface.toArgb()
-    SideEffect { hourLabelPaint.color = hourLabelColor }
+	val hourLabelPaint = remember {
+		Paint().apply {
+			textAlign = Paint.Align.CENTER
+			textSize = 36f
+			isAntiAlias = true
+			typeface = Typeface.DEFAULT_BOLD
+		}
+	}
+	val hourLabelColor = MaterialTheme.colorScheme.onSurface.toArgb()
+	SideEffect { hourLabelPaint.color = hourLabelColor }
 
-    val cornerRadiusDp = 28.dp
+	val cornerRadiusDp = 28.dp
 
-    // Theme colors
-    val surfaceColor = MaterialTheme.colorScheme.surface
-    val trackBgColor = MaterialTheme.colorScheme.surfaceVariant
-    val borderColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.75f)
-    val tickColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)
-    val passedColor = Color(0xFFB7EA27)
-    val nowColor = Color(0xFFEF4444)
+	// Theme colors
+	val surfaceColor = MaterialTheme.colorScheme.surface
+	val trackBgColor = MaterialTheme.colorScheme.surfaceVariant
+	val borderColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.75f)
+	val tickColor = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)
+	val passedColor = Color(0xFFB7EA27)
+	val nowColor = Color(0xFFEF4444)
 
-    Box(
-        Modifier
-            .fillMaxWidth()
-            .height(height + 24.dp)
-            .background(Color.Transparent)
-    ) {
-        // Yttre kapsel (Bakgrund)
-        Box(
-            Modifier
-                .align(Alignment.TopCenter)
-                .fillMaxWidth()
-                .height(height)
-                .background(surfaceColor, RoundedCornerShape(cornerRadiusDp))
-        )
+	Box(
+		Modifier
+			.fillMaxWidth()
+			.height(height + 24.dp)
+			.background(Color.Transparent)
+	) {
+		// Yttre kapsel (Bakgrund)
+		Box(
+			Modifier
+				.align(Alignment.TopCenter)
+				.fillMaxWidth()
+				.height(height)
+				.background(surfaceColor, RoundedCornerShape(cornerRadiusDp))
+		)
 
-        // Canvas för tidslinje (00 - 24)
-        Canvas(
-            modifier = Modifier
-                .align(Alignment.TopCenter)
-                .fillMaxWidth()
-                .height(height)
-        ) {
-            val pad = 20.dp.toPx()
-            val trackTop = size.height * 0.10f
-            val trackHeight = size.height * 0.80f
-            val right = size.width - pad
-            val trackWidth = right - pad
-            val left = pad
-            val cornerRadiusPx = 24f
+		// Canvas för tidslinje (00 - 24)
+		Canvas(
+			modifier = Modifier
+				.align(Alignment.TopCenter)
+				.fillMaxWidth()
+				.height(height)
+		) {
+			val pad = 20.dp.toPx()
+			val trackTop = size.height * 0.10f
+			val trackHeight = size.height * 0.80f
+			val right = size.width - pad
+			val trackWidth = right - pad
+			val left = pad
+			val cornerRadiusPx = 24f
 
-            // Inre kapsel (Bakgrund)
-            drawRoundRect(
-                color = trackBgColor,
-                topLeft = Offset(left, trackTop),
-                size = Size(trackWidth, trackHeight),
-                cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
-            )
+			// Inre kapsel (Bakgrund)
+			drawRoundRect(
+				color = trackBgColor,
+				topLeft = Offset(left, trackTop),
+				size = Size(trackWidth, trackHeight),
+				cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
+			)
 
-            // Beräkna pixlar per minut för HELA dygnet (24h = 1440 min)
-            val totalMinutes = 24 * 60
-            val pxPerMin = trackWidth / totalMinutes
+			// Beräkna pixlar per minut för HELA dygnet (24h = 1440 min)
+			val totalMinutes = 24 * 60
+			val pxPerMin = trackWidth / totalMinutes
 
-            // Rita events
-            events.forEach { event ->
-                val startMin = event.start.hour * 60 + event.start.minute
-                val endMin = (event.end?.hour ?: 0) * 60 + (event.end?.minute ?: 0)
+			// Rita events
+			events.forEach { event ->
+				val startMin = event.start.hour * 60 + event.start.minute
+				val endMin = (event.end?.hour ?: 0) * 60 + (event.end?.minute ?: 0)
 
-                // Enkel hantering av events som går över midnatt eller saknar slut -> visa 1h
-                val actualEndMin = if (event.end != null && endMin > startMin) endMin else startMin + 60
+				// Enkel hantering av events som går över midnatt eller saknar slut -> visa 1h
+				val actualEndMin =
+					if (event.end != null && endMin > startMin) endMin else startMin + 60
 
-                val eventStartPx = left + (startMin * pxPerMin)
-                val eventWidthPx = (actualEndMin - startMin) * pxPerMin
+				val eventStartPx = left + (startMin * pxPerMin)
+				val eventWidthPx = (actualEndMin - startMin) * pxPerMin
 
-                // Rita event som ett färgat block (svagt)
-                drawRect(
-                    color = event.color.copy(alpha = 0.3f),
-                    topLeft = Offset(eventStartPx, trackTop),
-                    size = Size(eventWidthPx, trackHeight)
-                )
-            }
+				// Rita event som ett färgat block (svagt)
+				drawRect(
+					color = event.color.copy(alpha = 0.3f),
+					topLeft = Offset(eventStartPx, trackTop),
+					size = Size(eventWidthPx, trackHeight)
+				)
+			}
 
-            // Nuvarande tid i minuter
-            val currentMinutes = now.hour * 60 + now.minute
-            val currentX = left + (currentMinutes * pxPerMin)
+			// Nuvarande tid i minuter
+			val currentMinutes = now.hour * 60 + now.minute
+			val currentX = left + (currentMinutes * pxPerMin)
 
-            // Grön fyllnad (Från 00:00 till nu)
-            val passedWidth = currentX - left
-            if (passedWidth > 0) {
-                 drawRoundRect(
-                    color = passedColor,
-                    topLeft = Offset(left, trackTop),
-                    size = Size(passedWidth, trackHeight),
-                    cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
-                )
-                 // Om "passed" är bredare än radiens kurva, rita en fyrkant över högra hörnen
-                 // för att få en skarp kant mot "framtiden" (eller behåll rundad om det är designen)
-                 // Här behåller vi den klippt vid 'currentX' men säkerställer att vi inte ritar utanför vänster kant.
-                 if (passedWidth > cornerRadiusPx) {
-                     // Fyll ut högra hörnen så det ser ut som progress bar som fortsätter
-                     drawRect(
-                         color = passedColor,
-                         topLeft = Offset(currentX - 10f, trackTop), // Lite överlapp
-                         size = Size(10f, trackHeight)
-                     )
-                 }
-            }
+			// Grön fyllnad (Från 00:00 till nu)
+			val passedWidth = currentX - left
+			if (passedWidth > 0) {
+				drawRoundRect(
+					color = passedColor,
+					topLeft = Offset(left, trackTop),
+					size = Size(passedWidth, trackHeight),
+					cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
+				)
+				// Om "passed" är bredare än radiens kurva, rita en fyrkant över högra hörnen
+				// för att få en skarp kant mot "framtiden" (eller behåll rundad om det är designen)
+				// Här behåller vi den klippt vid 'currentX' men säkerställer att vi inte ritar utanför vänster kant.
+				if (passedWidth > cornerRadiusPx) {
+					// Fyll ut högra hörnen så det ser ut som progress bar som fortsätter
+					drawRect(
+						color = passedColor,
+						topLeft = Offset(currentX - 10f, trackTop), // Lite överlapp
+						size = Size(10f, trackHeight)
+					)
+				}
+			}
 
-            // Inre kapsel (Border - ritas ovanpå för snyggare kant)
-            drawRoundRect(
-                color = borderColor,
-                topLeft = Offset(left, trackTop),
-                size = Size(trackWidth, trackHeight),
-                style = Stroke(width = 2f),
-                cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
-            )
+			// Inre kapsel (Border - ritas ovanpå för snyggare kant)
+			drawRoundRect(
+				color = borderColor,
+				topLeft = Offset(left, trackTop),
+				size = Size(trackWidth, trackHeight),
+				style = Stroke(width = 2f),
+				cornerRadius = CornerRadius(cornerRadiusPx, cornerRadiusPx)
+			)
 
-            // Loopa igenom 24 timmar
-            for (h in 0..24) {
-                val min = h * 60
-                val x = left + (min * pxPerMin)
+			// Loopa igenom 24 timmar
+			for (h in 0..24) {
+				val min = h * 60
+				val x = left + (min * pxPerMin)
 
-                // Rita Tim-markering (långt streck)
-                drawLine(
-                    color = tickColor,
-                    start = Offset(x, trackTop),
-                    end = Offset(x, trackTop + trackHeight * 0.4f),
-                    strokeWidth = 2f
-                )
+				// Rita Tim-markering (långt streck)
+				drawLine(
+					color = tickColor,
+					start = Offset(x, trackTop),
+					end = Offset(x, trackTop + trackHeight * 0.4f),
+					strokeWidth = 2f
+				)
 
-                // Text: Endast för 6, 12, 18, 24
-                if (h % 6 == 0 && h != 0) {
-                    val label = h.toString()
-                    drawContext.canvas.nativeCanvas.drawText(
-                        label,
-                        x,
-                        trackTop + trackHeight / 2f + 18f,
-                        hourLabelPaint
-                    )
-                }
+				// Text: Endast för 6, 12, 18, 24
+				if (h % 6 == 0 && h != 0) {
+					val label = h.toString()
+					drawContext.canvas.nativeCanvas.drawText(
+						label,
+						x,
+						trackTop + trackHeight / 2f + 18f,
+						hourLabelPaint
+					)
+				}
 
-                // Halvtimmar (korta streck) - men inte efter 24
-                if (h < 24) {
-                    val halfMin = min + 30
-                    val halfX = left + (halfMin * pxPerMin)
-                    drawLine(
-                        color = tickColor.copy(alpha = 0.3f),
-                        start = Offset(halfX, trackTop),
-                        end = Offset(halfX, trackTop + trackHeight * 0.2f),
-                        strokeWidth = 2f
-                    )
-                }
-            }
+				// Halvtimmar (korta streck) - men inte efter 24
+				if (h < 24) {
+					val halfMin = min + 30
+					val halfX = left + (halfMin * pxPerMin)
+					drawLine(
+						color = tickColor.copy(alpha = 0.3f),
+						start = Offset(halfX, trackTop),
+						end = Offset(halfX, trackTop + trackHeight * 0.2f),
+						strokeWidth = 2f
+					)
+				}
+			}
 
-            // Nu-markör (röd linje)
-            drawLine(
-                color = nowColor,
-                start = Offset(currentX, trackTop),
-                end = Offset(currentX, trackTop + trackHeight),
-                strokeWidth = 4f,
-                cap = StrokeCap.Square
-            )
-        }
-    }
+			// Nu-markör (röd linje)
+			drawLine(
+				color = nowColor,
+				start = Offset(currentX, trackTop),
+				end = Offset(currentX, trackTop + trackHeight),
+				strokeWidth = 4f,
+				cap = StrokeCap.Square
+			)
+		}
+	}
 }
 
 // -------- NÄSTA HÄNDELSE --------
 @Composable
 fun NextEventCard(events: List<DayEvent>, now: LocalTime) {
-    val sortedEvents = remember(events) { events.sortedBy { it.start } }
-    val next = remember(sortedEvents, now) {
-        // Hitta nästa händelse som inte har passerat (minus 1 minut för att hantera tickern)
-        sortedEvents.firstOrNull { !it.start.isBefore(now.minusMinutes(1)) }
-    } ?: return
+	val sortedEvents = remember(events) { events.sortedBy { it.start } }
+	val next = remember(sortedEvents, now) {
+		// Hitta nästa händelse som inte har passerat (minus 1 minut för att hantera tickern)
+		sortedEvents.firstOrNull { !it.start.isBefore(now.minusMinutes(1)) }
+	} ?: return
 
-    Row(
-        Modifier
-            .fillMaxWidth()
-            .background(Color(0xFFF7F7F7), RoundedCornerShape(16.dp))
-            .padding(16.dp),
-        verticalAlignment = Alignment.CenterVertically
-    ) {
-        Text(next.icon ?: "•", fontSize = 22.sp, modifier = Modifier.padding(end = 8.dp))
-        Column {
-            Text(next.title, fontSize = 18.sp, fontWeight = FontWeight.Medium)
-            Text(
-                text = "${next.start.format(DateTimeFormatter.ofPattern("HH:mm"))}${
-                    next.end?.let {
-                        " – ${
-                            it.format(
-                                DateTimeFormatter.ofPattern("HH:mm")
-                            )
-                        }"
-                    } ?: ""
-                }",
-                color = Color(0xFF6B7280),
-                fontSize = 14.sp
-            )
-        }
-    }
+	Row(
+		Modifier
+			.fillMaxWidth()
+			.background(Color(0xFFF7F7F7), RoundedCornerShape(16.dp))
+			.padding(16.dp),
+		verticalAlignment = Alignment.CenterVertically
+	) {
+		Text(next.icon ?: "•", fontSize = 22.sp, modifier = Modifier.padding(end = 8.dp))
+		Column {
+			Text(next.title, fontSize = 18.sp, fontWeight = FontWeight.Medium)
+			Text(
+				text = "${next.start.format(DateTimeFormatter.ofPattern("HH:mm"))}${
+					next.end?.let {
+						" – ${
+							it.format(
+								DateTimeFormatter.ofPattern("HH:mm")
+							)
+						}"
+					} ?: ""
+				}",
+				color = Color(0xFF6B7280),
+				fontSize = 14.sp
+			)
+		}
+	}
 }
 
 // ----------------------------------------------------------
@@ -501,49 +504,49 @@
 
 @Composable
 fun WeatherInfoCard(modifier: Modifier = Modifier, data: WeatherData) {
-    Card(
-        modifier = modifier.height(200.dp),
-        shape = RoundedCornerShape(12.dp),
-        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),
-        elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
-    ) {
-        Box(
-            modifier = Modifier
-                .fillMaxSize()
-                .padding(16.dp),
-            contentAlignment = Alignment.Center
-        ) {
-            if (!data.isDataLoaded) {
-                // Laddningsindikator
-                Column(horizontalAlignment = Alignment.CenterHorizontally) {
-                    CircularProgressIndicator(modifier = Modifier.size(32.dp))
-                    Spacer(Modifier.height(8.dp))
-                    Text("Laddar väderdata...", fontSize = 14.sp, color = Color.Gray)
-                }
-            } else {
-                // Visar riktig data
-                Column(horizontalAlignment = Alignment.CenterHorizontally) {
-                    Text(
-                        "Väderinformation",
-                        style = MaterialTheme.typography.titleMedium,
-                        color = MaterialTheme.colorScheme.onSurface
-                    )
-                    Spacer(Modifier.height(8.dp))
-                    Text(
-                        "${data.temperatureCelsius}°C",
-                        fontSize = 32.sp,
-                        fontWeight = FontWeight.Bold,
-                        color = MaterialTheme.colorScheme.onSurface
-                    )
-                    Text(
-                        "${data.precipitationChance}% risk för nederbörd",
-                        fontSize = 16.sp,
-                        color = Color.Gray
-                    )
-                }
-            }
-        }
-    }
+	Card(
+		modifier = modifier.height(200.dp),
+		shape = RoundedCornerShape(12.dp),
+		colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),
+		elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
+	) {
+		Box(
+			modifier = Modifier
+				.fillMaxSize()
+				.padding(16.dp),
+			contentAlignment = Alignment.Center
+		) {
+			if (!data.isDataLoaded) {
+				// Laddningsindikator
+				Column(horizontalAlignment = Alignment.CenterHorizontally) {
+					CircularProgressIndicator(modifier = Modifier.size(32.dp))
+					Spacer(Modifier.height(8.dp))
+					Text("Laddar väderdata...", fontSize = 14.sp, color = Color.Gray)
+				}
+			} else {
+				// Visar riktig data
+				Column(horizontalAlignment = Alignment.CenterHorizontally) {
+					Text(
+						"Väderinformation",
+						style = MaterialTheme.typography.titleMedium,
+						color = MaterialTheme.colorScheme.onSurface
+					)
+					Spacer(Modifier.height(8.dp))
+					Text(
+						"${data.temperatureCelsius}°C",
+						fontSize = 32.sp,
+						fontWeight = FontWeight.Bold,
+						color = MaterialTheme.colorScheme.onSurface
+					)
+					Text(
+						"${data.precipitationChance}% risk för nederbörd",
+						fontSize = 16.sp,
+						color = Color.Gray
+					)
+				}
+			}
+		}
+	}
 }
 
 // ----------------------------------------------------------
@@ -552,49 +555,49 @@
 
 @Composable
 fun ClothingAdviceCard(modifier: Modifier = Modifier, data: WeatherData) {
-    Card(
-        modifier = modifier.height(200.dp),
-        shape = RoundedCornerShape(12.dp),
-        colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),
-        elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
-    ) {
-        Box(
-            modifier = Modifier
-                .fillMaxSize()
-                .padding(16.dp),
-            contentAlignment = Alignment.Center
-        ) {
-            if (!data.isDataLoaded) {
-                // Laddningsindikator (synkroniserad med väderkortet)
-                Column(horizontalAlignment = Alignment.CenterHorizontally) {
-                    Text(data.adviceIcon, fontSize = 48.sp)
-                    Text(
-                        data.adviceText,
-                        fontSize = 12.sp,
-                        textAlign = TextAlign.Center,
-                        modifier = Modifier.padding(top = 8.dp)
-                    )
-                }
-            } else {
-                // Visar klädråd baserat på logik i WeatherRepository
-                Column(horizontalAlignment = Alignment.CenterHorizontally) {
-                    Text(
-                        "Klädråd",
-                        style = MaterialTheme.typography.titleMedium,
-                        color = MaterialTheme.colorScheme.onSurface
-                    )
-                    Spacer(Modifier.height(8.dp))
-                    Text(data.adviceIcon, fontSize = 48.sp)
-                    Text(
-                        data.adviceText,
-                        fontSize = 12.sp,
-                        color = Color.Gray,
-                        textAlign = TextAlign.Center
-                    )
-                }
-            }
-        }
-    }
+	Card(
+		modifier = modifier.height(200.dp),
+		shape = RoundedCornerShape(12.dp),
+		colors = CardDefaults.cardColors(containerColor = MaterialTheme.colorScheme.surface),
+		elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
+	) {
+		Box(
+			modifier = Modifier
+				.fillMaxSize()
+				.padding(16.dp),
+			contentAlignment = Alignment.Center
+		) {
+			if (!data.isDataLoaded) {
+				// Laddningsindikator (synkroniserad med väderkortet)
+				Column(horizontalAlignment = Alignment.CenterHorizontally) {
+					Text(data.adviceIcon, fontSize = 48.sp)
+					Text(
+						data.adviceText,
+						fontSize = 12.sp,
+						textAlign = TextAlign.Center,
+						modifier = Modifier.padding(top = 8.dp)
+					)
+				}
+			} else {
+				// Visar klädråd baserat på logik i WeatherRepository
+				Column(horizontalAlignment = Alignment.CenterHorizontally) {
+					Text(
+						"Klädråd",
+						style = MaterialTheme.typography.titleMedium,
+						color = MaterialTheme.colorScheme.onSurface
+					)
+					Spacer(Modifier.height(8.dp))
+					Text(data.adviceIcon, fontSize = 48.sp)
+					Text(
+						data.adviceText,
+						fontSize = 12.sp,
+						color = Color.Gray,
+						textAlign = TextAlign.Center
+					)
+				}
+			}
+		}
+	}
 }
 
 // -------- HJÄLPARE --------
@@ -602,13 +605,13 @@
 // -------- ENKEL TICKER --------
 @Composable
 fun rememberTicker1s(): State<LocalDateTime> {
-    val state = remember { mutableStateOf(LocalDateTime.now()) }
-    LaunchedEffect(Unit) {
-        while (true) {
-            // Uppdatera varje minut (eller oftare vid behov, men minut räcker för UI)
-            state.value = LocalDateTime.now()
-            delay(60000)
-        }
-    }
-    return state
+	val state = remember { mutableStateOf(LocalDateTime.now()) }
+	LaunchedEffect(Unit) {
+		while (true) {
+			// Uppdatera varje minut (eller oftare vid behov, men minut räcker för UI)
+			state.value = LocalDateTime.now()
+			delay(60000)
+		}
+	}
+	return state
 }
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest package=\"com.example.stalp\"\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\">\r\n\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.READ_CALENDAR\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" />\r\n\r\n    <application\r\n        android:label=\"Stalp\"\r\n        android:icon=\"@mipmap/ic_launcher\"\r\n        android:allowBackup=\"true\"\r\n        android:supportsRtl=\"true\">\r\n        <activity\r\n            android:name=\".MainActivity\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\"/>\r\n                <category android:name=\"android.intent.category.LAUNCHER\"/>\r\n            </intent-filter>\r\n        </activity>\r\n\r\n\r\n        <receiver\r\n            android:name=\".widget.LinearClockWidgetReceiver\"\r\n            android:exported=\"true\"\r\n            android:label=\"@string/widget_name\">\r\n            <intent-filter>\r\n                <action android:name=\"android.appwidget.action.APPWIDGET_UPDATE\" />\r\n            </intent-filter>\r\n            <meta-data\r\n                android:name=\"android.appwidget.provider\"\r\n                android:resource=\"@xml/linear_clock_widget_info\" />\r\n        </receiver>\r\n\r\n        <activity\r\n            android:name=\".widget.LinearClockConfigActivity\"\r\n            android:exported=\"true\"\r\n            android:theme=\"@style/Theme.Stalp\" />\r\n\r\n        <receiver\r\n            android:name=\".widget.BootCompletedReceiver\"\r\n            android:enabled=\"true\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.BOOT_COMPLETED\" />\r\n            </intent-filter>\r\n        </receiver>\r\n\r\n    </application>\r\n\r\n\r\n</manifest>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/AndroidManifest.xml	(date 1764633892413)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
-<manifest package="com.example.stalp"
-    xmlns:android="http://schemas.android.com/apk/res/android">
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+    package="com.example.stalp">
 
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.READ_CALENDAR" />
@@ -8,16 +8,16 @@
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
 
     <application
-        android:label="Stalp"
-        android:icon="@mipmap/ic_launcher"
         android:allowBackup="true"
+        android:icon="@mipmap/ic_launcher"
+        android:label="Stalp"
         android:supportsRtl="true">
         <activity
             android:name=".MainActivity"
             android:exported="true">
             <intent-filter>
-                <action android:name="android.intent.action.MAIN"/>
-                <category android:name="android.intent.category.LAUNCHER"/>
+                <action android:name="android.intent.action.MAIN" />
+                <category android:name="android.intent.category.LAUNCHER" />
             </intent-filter>
         </activity>
 
Index: app/src/test/java/com/example/stalp/ExampleUnitTest.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp\r\n\r\nimport org.junit.Test\r\n\r\nimport org.junit.Assert.*\r\n\r\n/**\r\n * Example local unit test, which will execute on the development machine (host).\r\n *\r\n * See [testing documentation](http://d.android.com/tools/testing).\r\n */\r\nclass ExampleUnitTest {\r\n    @Test\r\n    fun addition_isCorrect() {\r\n        assertEquals(4, 2 + 2)\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/test/java/com/example/stalp/ExampleUnitTest.kt b/app/src/test/java/com/example/stalp/ExampleUnitTest.kt
--- a/app/src/test/java/com/example/stalp/ExampleUnitTest.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/test/java/com/example/stalp/ExampleUnitTest.kt	(date 1764633892172)
@@ -1,17 +1,16 @@
 package com.example.stalp
 
+import org.junit.Assert.assertEquals
 import org.junit.Test
 
-import org.junit.Assert.*
-
 /**
  * Example local unit test, which will execute on the development machine (host).
  *
  * See [testing documentation](http://d.android.com/tools/testing).
  */
 class ExampleUnitTest {
-    @Test
-    fun addition_isCorrect() {
-        assertEquals(4, 2 + 2)
-    }
+	@Test
+	fun addition_isCorrect() {
+		assertEquals(4, 2 + 2)
+	}
 }
\ No newline at end of file
Index: app/src/main/java/com/example/stalp/widget/LinearClockWidgetReceiver.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.widget\r\n\r\nimport androidx.glance.appwidget.GlanceAppWidget\r\nimport androidx.glance.appwidget.GlanceAppWidgetReceiver\r\n\r\nclass LinearClockWidgetReceiver : GlanceAppWidgetReceiver() {\r\n    override val glanceAppWidget: GlanceAppWidget = LinearClockWidget\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/widget/LinearClockWidgetReceiver.kt b/app/src/main/java/com/example/stalp/widget/LinearClockWidgetReceiver.kt
--- a/app/src/main/java/com/example/stalp/widget/LinearClockWidgetReceiver.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/widget/LinearClockWidgetReceiver.kt	(date 1764633892522)
@@ -4,5 +4,5 @@
 import androidx.glance.appwidget.GlanceAppWidgetReceiver
 
 class LinearClockWidgetReceiver : GlanceAppWidgetReceiver() {
-    override val glanceAppWidget: GlanceAppWidget = LinearClockWidget
+	override val glanceAppWidget: GlanceAppWidget = LinearClockWidget
 }
Index: app/src/main/java/com/example/stalp/data/WeatherRepository.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.data\r\n\r\nimport android.content.Context\r\nimport androidx.datastore.core.DataStore\r\nimport androidx.datastore.preferences.core.*\r\nimport androidx.datastore.preferences.preferencesDataStore\r\nimport kotlinx.coroutines.flow.Flow\r\nimport kotlinx.coroutines.flow.map\r\nimport java.io.IOException\r\n\r\n// --- DataStore Setup ---\r\n// Skapar en singleton DataStore för att lagra väderdata för huvudappen\r\nval Context.dataStore: DataStore<Preferences> by preferencesDataStore(name = \"main_app_weather\")\r\n\r\n// Nycklar för DataStore\r\nobject WeatherPreferencesKeys {\r\n    val TEMP_CELSIUS = intPreferencesKey(\"temp_c\")\r\n    val PRECIP_CHANCE = intPreferencesKey(\"precip_chance_pct\")\r\n    val IS_COLD_ADVICE = stringPreferencesKey(\"advice_icon\") // Sparar ikonen\r\n    val ADVICE_TEXT = stringPreferencesKey(\"advice_text\") // Sparar rådtexten\r\n    val CLOTHING_TYPE = stringPreferencesKey(\"clothing_type\") // Sparar typ av kläder som sträng\r\n    val DATA_LOADED = booleanPreferencesKey(\"data_loaded\")\r\n\r\n    // New Location Settings\r\n    val USE_CURRENT_LOCATION = booleanPreferencesKey(\"use_current_location\")\r\n    val MANUAL_LOCATION_NAME = stringPreferencesKey(\"manual_location_name\")\r\n}\r\n\r\n// Data class för att representera väderdata i Compose\r\ndata class WeatherData(\r\n    val temperatureCelsius: Int = 0,\r\n    val precipitationChance: Int = 0, // i procent (0-100)\r\n    val adviceIcon: String = \"☁\uFE0F\",\r\n    val adviceText: String = \"Laddar väderdata...\",\r\n    val clothingType: String = \"NORMAL\",\r\n    val isDataLoaded: Boolean = false\r\n) {\r\n    fun getClothingResourceId(): Int {\r\n        return when (clothingType) {\r\n            \"COLD\" -> com.example.stalp.R.drawable.ic_clothing_cold\r\n            \"HOT\" -> com.example.stalp.R.drawable.ic_clothing_hot\r\n            \"RAIN\" -> com.example.stalp.R.drawable.ic_clothing_rain\r\n            \"NORMAL\" -> com.example.stalp.R.drawable.ic_clothing_normal\r\n            else -> com.example.stalp.R.drawable.ic_clothing_normal\r\n        }\r\n    }\r\n}\r\n\r\n// Data class for location settings\r\ndata class WeatherLocationSettings(\r\n    val useCurrentLocation: Boolean = true,\r\n    val manualLocationName: String = \"\"\r\n)\r\n\r\n// Konstanter för klädrådslogik (enligt din skiss)\r\nobject ClothingAdvice {\r\n    // Kallt: Rekommenderar varma kläder vid denna temp eller kallare\r\n    const val COLD_THRESHOLD_C = 5\r\n    // Varmt: Rekommenderar lätta kläder vid denna temp eller varmare\r\n    const val HOT_THRESHOLD_C = 25\r\n    // Regn: Rekommenderar paraply vid denna risk eller högre\r\n    const val PRECIPITATION_THRESHOLD_PCT = 30\r\n}\r\n\r\n// --- Repository (Logiken för att läsa/skriva data) ---\r\nclass WeatherRepository(private val context: Context) {\r\n    private val dataStore = context.dataStore\r\n\r\n    // Flow som tillhandahåller väderdata i realtid till Compose\r\n    val weatherDataFlow = dataStore.data\r\n        .map { prefs ->\r\n            WeatherData(\r\n                temperatureCelsius = prefs[WeatherPreferencesKeys.TEMP_CELSIUS] ?: 15,\r\n                precipitationChance = prefs[WeatherPreferencesKeys.PRECIP_CHANCE] ?: 0,\r\n                adviceIcon = prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] ?: \"☁\uFE0F\",\r\n                adviceText = prefs[WeatherPreferencesKeys.ADVICE_TEXT] ?: \"Väntar på data...\",\r\n                clothingType = prefs[WeatherPreferencesKeys.CLOTHING_TYPE] ?: \"NORMAL\",\r\n                isDataLoaded = prefs[WeatherPreferencesKeys.DATA_LOADED] ?: false\r\n            )\r\n        }\r\n\r\n    // Flow for location settings\r\n    val locationSettingsFlow: Flow<WeatherLocationSettings> = dataStore.data\r\n        .map { prefs ->\r\n            WeatherLocationSettings(\r\n                useCurrentLocation = prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] ?: true,\r\n                manualLocationName = prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] ?: \"\"\r\n            )\r\n        }\r\n\r\n    // Skriver ny väderdata till DataStore\r\n    suspend fun saveWeatherData(temp: Int, precipChance: Int) {\r\n        val (adviceText, adviceIcon, clothingType) = generateClothingAdvice(temp, precipChance)\r\n\r\n        dataStore.edit { prefs ->\r\n            prefs[WeatherPreferencesKeys.TEMP_CELSIUS] = temp\r\n            prefs[WeatherPreferencesKeys.PRECIP_CHANCE] = precipChance\r\n            prefs[WeatherPreferencesKeys.ADVICE_TEXT] = adviceText\r\n            prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] = adviceIcon\r\n            prefs[WeatherPreferencesKeys.CLOTHING_TYPE] = clothingType\r\n            prefs[WeatherPreferencesKeys.DATA_LOADED] = true\r\n        }\r\n    }\r\n\r\n    // Save location settings\r\n    suspend fun saveLocationSettings(useCurrent: Boolean, manualName: String) {\r\n        dataStore.edit { prefs ->\r\n            prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] = useCurrent\r\n            prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] = manualName\r\n        }\r\n    }\r\n\r\n    // Kärnlogiken för klädråd\r\n    private fun generateClothingAdvice(temp: Int, precipChance: Int): Triple<String, String, String> {\r\n        return when {\r\n            // Varma kläder: -5 grader eller lägre (enligt skissen)\r\n            temp <= ClothingAdvice.COLD_THRESHOLD_C -> Triple(\r\n                \"Rekommenderar varma kläder: Jacka, mössa, handskar.\",\r\n                \"\uD83E\uDDE5\uD83E\uDDE3\uD83E\uDDE4\",\r\n                \"COLD\"\r\n            )\r\n            // Lätta kläder: +30 grader eller högre (enligt skissen)\r\n            temp > ClothingAdvice.HOT_THRESHOLD_C -> Triple(\r\n                \"Välj lätta kläder: Shorts och linne.\",\r\n                \"\uD83E\uDE73\uD83D\uDC55☀\uFE0F\",\r\n                \"HOT\"\r\n            )\r\n            // Regn\r\n            precipChance >= ClothingAdvice.PRECIPITATION_THRESHOLD_PCT -> Triple(\r\n                \"Hög risk för nederbörd (${precipChance}%). Ta med paraply eller regnjacka!\",\r\n                \"☔\uFE0F\uD83C\uDF27\uFE0F\",\r\n                \"RAIN\"\r\n            )\r\n            // Normalt\r\n            else -> Triple(\r\n                \"Lätt jacka eller tröja är lagom.\",\r\n                \"\uD83D\uDC5A\",\r\n                \"NORMAL\"\r\n            )\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/data/WeatherRepository.kt b/app/src/main/java/com/example/stalp/data/WeatherRepository.kt
--- a/app/src/main/java/com/example/stalp/data/WeatherRepository.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/data/WeatherRepository.kt	(date 1764633892256)
@@ -2,11 +2,14 @@
 
 import android.content.Context
 import androidx.datastore.core.DataStore
-import androidx.datastore.preferences.core.*
+import androidx.datastore.preferences.core.Preferences
+import androidx.datastore.preferences.core.booleanPreferencesKey
+import androidx.datastore.preferences.core.edit
+import androidx.datastore.preferences.core.intPreferencesKey
+import androidx.datastore.preferences.core.stringPreferencesKey
 import androidx.datastore.preferences.preferencesDataStore
 import kotlinx.coroutines.flow.Flow
 import kotlinx.coroutines.flow.map
-import java.io.IOException
 
 // --- DataStore Setup ---
 // Skapar en singleton DataStore för att lagra väderdata för huvudappen
@@ -14,129 +17,134 @@
 
 // Nycklar för DataStore
 object WeatherPreferencesKeys {
-    val TEMP_CELSIUS = intPreferencesKey("temp_c")
-    val PRECIP_CHANCE = intPreferencesKey("precip_chance_pct")
-    val IS_COLD_ADVICE = stringPreferencesKey("advice_icon") // Sparar ikonen
-    val ADVICE_TEXT = stringPreferencesKey("advice_text") // Sparar rådtexten
-    val CLOTHING_TYPE = stringPreferencesKey("clothing_type") // Sparar typ av kläder som sträng
-    val DATA_LOADED = booleanPreferencesKey("data_loaded")
+	val TEMP_CELSIUS = intPreferencesKey("temp_c")
+	val PRECIP_CHANCE = intPreferencesKey("precip_chance_pct")
+	val IS_COLD_ADVICE = stringPreferencesKey("advice_icon") // Sparar ikonen
+	val ADVICE_TEXT = stringPreferencesKey("advice_text") // Sparar rådtexten
+	val CLOTHING_TYPE = stringPreferencesKey("clothing_type") // Sparar typ av kläder som sträng
+	val DATA_LOADED = booleanPreferencesKey("data_loaded")
 
-    // New Location Settings
-    val USE_CURRENT_LOCATION = booleanPreferencesKey("use_current_location")
-    val MANUAL_LOCATION_NAME = stringPreferencesKey("manual_location_name")
+	// New Location Settings
+	val USE_CURRENT_LOCATION = booleanPreferencesKey("use_current_location")
+	val MANUAL_LOCATION_NAME = stringPreferencesKey("manual_location_name")
 }
 
 // Data class för att representera väderdata i Compose
 data class WeatherData(
-    val temperatureCelsius: Int = 0,
-    val precipitationChance: Int = 0, // i procent (0-100)
-    val adviceIcon: String = "☁️",
-    val adviceText: String = "Laddar väderdata...",
-    val clothingType: String = "NORMAL",
-    val isDataLoaded: Boolean = false
+	val temperatureCelsius: Int = 0,
+	val precipitationChance: Int = 0, // i procent (0-100)
+	val adviceIcon: String = "☁️",
+	val adviceText: String = "Laddar väderdata...",
+	val clothingType: String = "NORMAL",
+	val isDataLoaded: Boolean = false
 ) {
-    fun getClothingResourceId(): Int {
-        return when (clothingType) {
-            "COLD" -> com.example.stalp.R.drawable.ic_clothing_cold
-            "HOT" -> com.example.stalp.R.drawable.ic_clothing_hot
-            "RAIN" -> com.example.stalp.R.drawable.ic_clothing_rain
-            "NORMAL" -> com.example.stalp.R.drawable.ic_clothing_normal
-            else -> com.example.stalp.R.drawable.ic_clothing_normal
-        }
-    }
+	fun getClothingResourceId(): Int {
+		return when (clothingType) {
+			"COLD" -> com.example.stalp.R.drawable.ic_clothing_cold
+			"HOT" -> com.example.stalp.R.drawable.ic_clothing_hot
+			"RAIN" -> com.example.stalp.R.drawable.ic_clothing_rain
+			"NORMAL" -> com.example.stalp.R.drawable.ic_clothing_normal
+			else -> com.example.stalp.R.drawable.ic_clothing_normal
+		}
+	}
 }
 
 // Data class for location settings
 data class WeatherLocationSettings(
-    val useCurrentLocation: Boolean = true,
-    val manualLocationName: String = ""
+	val useCurrentLocation: Boolean = true,
+	val manualLocationName: String = ""
 )
 
 // Konstanter för klädrådslogik (enligt din skiss)
 object ClothingAdvice {
-    // Kallt: Rekommenderar varma kläder vid denna temp eller kallare
-    const val COLD_THRESHOLD_C = 5
-    // Varmt: Rekommenderar lätta kläder vid denna temp eller varmare
-    const val HOT_THRESHOLD_C = 25
-    // Regn: Rekommenderar paraply vid denna risk eller högre
-    const val PRECIPITATION_THRESHOLD_PCT = 30
+	// Kallt: Rekommenderar varma kläder vid denna temp eller kallare
+	const val COLD_THRESHOLD_C = 5
+
+	// Varmt: Rekommenderar lätta kläder vid denna temp eller varmare
+	const val HOT_THRESHOLD_C = 25
+
+	// Regn: Rekommenderar paraply vid denna risk eller högre
+	const val PRECIPITATION_THRESHOLD_PCT = 30
 }
 
 // --- Repository (Logiken för att läsa/skriva data) ---
 class WeatherRepository(private val context: Context) {
-    private val dataStore = context.dataStore
+	private val dataStore = context.dataStore
 
-    // Flow som tillhandahåller väderdata i realtid till Compose
-    val weatherDataFlow = dataStore.data
-        .map { prefs ->
-            WeatherData(
-                temperatureCelsius = prefs[WeatherPreferencesKeys.TEMP_CELSIUS] ?: 15,
-                precipitationChance = prefs[WeatherPreferencesKeys.PRECIP_CHANCE] ?: 0,
-                adviceIcon = prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] ?: "☁️",
-                adviceText = prefs[WeatherPreferencesKeys.ADVICE_TEXT] ?: "Väntar på data...",
-                clothingType = prefs[WeatherPreferencesKeys.CLOTHING_TYPE] ?: "NORMAL",
-                isDataLoaded = prefs[WeatherPreferencesKeys.DATA_LOADED] ?: false
-            )
-        }
+	// Flow som tillhandahåller väderdata i realtid till Compose
+	val weatherDataFlow = dataStore.data
+		.map { prefs ->
+			WeatherData(
+				temperatureCelsius = prefs[WeatherPreferencesKeys.TEMP_CELSIUS] ?: 15,
+				precipitationChance = prefs[WeatherPreferencesKeys.PRECIP_CHANCE] ?: 0,
+				adviceIcon = prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] ?: "☁️",
+				adviceText = prefs[WeatherPreferencesKeys.ADVICE_TEXT] ?: "Väntar på data...",
+				clothingType = prefs[WeatherPreferencesKeys.CLOTHING_TYPE] ?: "NORMAL",
+				isDataLoaded = prefs[WeatherPreferencesKeys.DATA_LOADED] ?: false
+			)
+		}
 
-    // Flow for location settings
-    val locationSettingsFlow: Flow<WeatherLocationSettings> = dataStore.data
-        .map { prefs ->
-            WeatherLocationSettings(
-                useCurrentLocation = prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] ?: true,
-                manualLocationName = prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] ?: ""
-            )
-        }
+	// Flow for location settings
+	val locationSettingsFlow: Flow<WeatherLocationSettings> = dataStore.data
+		.map { prefs ->
+			WeatherLocationSettings(
+				useCurrentLocation = prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] ?: true,
+				manualLocationName = prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] ?: ""
+			)
+		}
 
-    // Skriver ny väderdata till DataStore
-    suspend fun saveWeatherData(temp: Int, precipChance: Int) {
-        val (adviceText, adviceIcon, clothingType) = generateClothingAdvice(temp, precipChance)
+	// Skriver ny väderdata till DataStore
+	suspend fun saveWeatherData(temp: Int, precipChance: Int) {
+		val (adviceText, adviceIcon, clothingType) = generateClothingAdvice(temp, precipChance)
 
-        dataStore.edit { prefs ->
-            prefs[WeatherPreferencesKeys.TEMP_CELSIUS] = temp
-            prefs[WeatherPreferencesKeys.PRECIP_CHANCE] = precipChance
-            prefs[WeatherPreferencesKeys.ADVICE_TEXT] = adviceText
-            prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] = adviceIcon
-            prefs[WeatherPreferencesKeys.CLOTHING_TYPE] = clothingType
-            prefs[WeatherPreferencesKeys.DATA_LOADED] = true
-        }
-    }
+		dataStore.edit { prefs ->
+			prefs[WeatherPreferencesKeys.TEMP_CELSIUS] = temp
+			prefs[WeatherPreferencesKeys.PRECIP_CHANCE] = precipChance
+			prefs[WeatherPreferencesKeys.ADVICE_TEXT] = adviceText
+			prefs[WeatherPreferencesKeys.IS_COLD_ADVICE] = adviceIcon
+			prefs[WeatherPreferencesKeys.CLOTHING_TYPE] = clothingType
+			prefs[WeatherPreferencesKeys.DATA_LOADED] = true
+		}
+	}
 
-    // Save location settings
-    suspend fun saveLocationSettings(useCurrent: Boolean, manualName: String) {
-        dataStore.edit { prefs ->
-            prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] = useCurrent
-            prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] = manualName
-        }
-    }
+	// Save location settings
+	suspend fun saveLocationSettings(useCurrent: Boolean, manualName: String) {
+		dataStore.edit { prefs ->
+			prefs[WeatherPreferencesKeys.USE_CURRENT_LOCATION] = useCurrent
+			prefs[WeatherPreferencesKeys.MANUAL_LOCATION_NAME] = manualName
+		}
+	}
 
-    // Kärnlogiken för klädråd
-    private fun generateClothingAdvice(temp: Int, precipChance: Int): Triple<String, String, String> {
-        return when {
-            // Varma kläder: -5 grader eller lägre (enligt skissen)
-            temp <= ClothingAdvice.COLD_THRESHOLD_C -> Triple(
-                "Rekommenderar varma kläder: Jacka, mössa, handskar.",
-                "🧥🧣🧤",
-                "COLD"
-            )
-            // Lätta kläder: +30 grader eller högre (enligt skissen)
-            temp > ClothingAdvice.HOT_THRESHOLD_C -> Triple(
-                "Välj lätta kläder: Shorts och linne.",
-                "🩳👕☀️",
-                "HOT"
-            )
-            // Regn
-            precipChance >= ClothingAdvice.PRECIPITATION_THRESHOLD_PCT -> Triple(
-                "Hög risk för nederbörd (${precipChance}%). Ta med paraply eller regnjacka!",
-                "☔️🌧️",
-                "RAIN"
-            )
-            // Normalt
-            else -> Triple(
-                "Lätt jacka eller tröja är lagom.",
-                "👚",
-                "NORMAL"
-            )
-        }
-    }
+	// Kärnlogiken för klädråd
+	private fun generateClothingAdvice(
+		temp: Int,
+		precipChance: Int
+	): Triple<String, String, String> {
+		return when {
+			// Varma kläder: -5 grader eller lägre (enligt skissen)
+			temp <= ClothingAdvice.COLD_THRESHOLD_C -> Triple(
+				"Rekommenderar varma kläder: Jacka, mössa, handskar.",
+				"🧥🧣🧤",
+				"COLD"
+			)
+			// Lätta kläder: +30 grader eller högre (enligt skissen)
+			temp > ClothingAdvice.HOT_THRESHOLD_C -> Triple(
+				"Välj lätta kläder: Shorts och linne.",
+				"🩳👕☀️",
+				"HOT"
+			)
+			// Regn
+			precipChance >= ClothingAdvice.PRECIPITATION_THRESHOLD_PCT -> Triple(
+				"Hög risk för nederbörd (${precipChance}%). Ta med paraply eller regnjacka!",
+				"☔️🌧️",
+				"RAIN"
+			)
+			// Normalt
+			else -> Triple(
+				"Lätt jacka eller tröja är lagom.",
+				"👚",
+				"NORMAL"
+			)
+		}
+	}
 }
Index: app/src/main/java/com/example/stalp/data/CalendarRepository.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.data\r\n\r\nimport android.content.ContentUris\r\nimport android.content.Context\r\nimport android.provider.CalendarContract\r\nimport java.time.Instant\r\nimport java.time.LocalDate\r\nimport java.time.LocalTime\r\nimport java.time.ZoneId\r\n\r\nclass CalendarRepository(private val context: Context) {\r\n\r\n    suspend fun getEventsForToday(): List<DayEvent> = kotlinx.coroutines.withContext(kotlinx.coroutines.Dispatchers.IO) {\r\n        // Kontrollera behörighet först\r\n        if (context.checkSelfPermission(android.Manifest.permission.READ_CALENDAR) != android.content.pm.PackageManager.PERMISSION_GRANTED) {\r\n            return@withContext emptyList<DayEvent>()\r\n        }\r\n\r\n        val events = mutableListOf<DayEvent>()\r\n\r\n        val projection = arrayOf(\r\n            CalendarContract.Instances.EVENT_ID,\r\n            CalendarContract.Instances.TITLE,\r\n            CalendarContract.Instances.BEGIN,\r\n            CalendarContract.Instances.END,\r\n            CalendarContract.Instances.DISPLAY_COLOR\r\n        )\r\n\r\n        // Sätt upp tid för \"idag\" med java.time\r\n        val zoneId = ZoneId.systemDefault()\r\n        val today = LocalDate.now(zoneId)\r\n        val startOfDayMillis = today.atStartOfDay(zoneId).toInstant().toEpochMilli()\r\n        val endOfDayMillis = today.atTime(LocalTime.MAX).atZone(zoneId).toInstant().toEpochMilli()\r\n\r\n        // Bygg query\r\n        val builder = CalendarContract.Instances.CONTENT_URI.buildUpon()\r\n        ContentUris.appendId(builder, startOfDayMillis)\r\n        ContentUris.appendId(builder, endOfDayMillis)\r\n\r\n        try {\r\n            context.contentResolver.query(\r\n                builder.build(),\r\n                projection,\r\n                null,\r\n                null,\r\n                \"${CalendarContract.Instances.BEGIN} ASC\"\r\n            )?.use { cursor ->\r\n                val idIdx = cursor.getColumnIndex(CalendarContract.Instances.EVENT_ID)\r\n                val titleIdx = cursor.getColumnIndex(CalendarContract.Instances.TITLE)\r\n                val beginIdx = cursor.getColumnIndex(CalendarContract.Instances.BEGIN)\r\n                val endIdx = cursor.getColumnIndex(CalendarContract.Instances.END)\r\n                val colorIdx = cursor.getColumnIndex(CalendarContract.Instances.DISPLAY_COLOR)\r\n\r\n                while (cursor.moveToNext()) {\r\n                    val id = cursor.getString(idIdx)\r\n                    val title = cursor.getString(titleIdx) ?: \"No Title\"\r\n                    val begin = cursor.getLong(beginIdx)\r\n                    val end = cursor.getLong(endIdx)\r\n                    val color = cursor.getInt(colorIdx)\r\n\r\n                    val startTime = Instant.ofEpochMilli(begin).atZone(zoneId).toLocalTime()\r\n                    val endTime = Instant.ofEpochMilli(end).atZone(zoneId).toLocalTime()\r\n\r\n                    events.add(\r\n                        DayEvent(\r\n                            id = id,\r\n                            title = title,\r\n                            start = startTime,\r\n                            end = endTime,\r\n                            color = androidx.compose.ui.graphics.Color(color)\r\n                        )\r\n                    )\r\n                }\r\n            }\r\n        } catch (e: Exception) {\r\n            e.printStackTrace()\r\n            // Returnera tom lista eller logga fel vid problem\r\n        }\r\n        events\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/data/CalendarRepository.kt b/app/src/main/java/com/example/stalp/data/CalendarRepository.kt
--- a/app/src/main/java/com/example/stalp/data/CalendarRepository.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/data/CalendarRepository.kt	(date 1764633892488)
@@ -10,72 +10,74 @@
 
 class CalendarRepository(private val context: Context) {
 
-    suspend fun getEventsForToday(): List<DayEvent> = kotlinx.coroutines.withContext(kotlinx.coroutines.Dispatchers.IO) {
-        // Kontrollera behörighet först
-        if (context.checkSelfPermission(android.Manifest.permission.READ_CALENDAR) != android.content.pm.PackageManager.PERMISSION_GRANTED) {
-            return@withContext emptyList<DayEvent>()
-        }
+	suspend fun getEventsForToday(): List<DayEvent> =
+		kotlinx.coroutines.withContext(kotlinx.coroutines.Dispatchers.IO) {
+			// Kontrollera behörighet först
+			if (context.checkSelfPermission(android.Manifest.permission.READ_CALENDAR) != android.content.pm.PackageManager.PERMISSION_GRANTED) {
+				return@withContext emptyList<DayEvent>()
+			}
 
-        val events = mutableListOf<DayEvent>()
+			val events = mutableListOf<DayEvent>()
 
-        val projection = arrayOf(
-            CalendarContract.Instances.EVENT_ID,
-            CalendarContract.Instances.TITLE,
-            CalendarContract.Instances.BEGIN,
-            CalendarContract.Instances.END,
-            CalendarContract.Instances.DISPLAY_COLOR
-        )
+			val projection = arrayOf(
+				CalendarContract.Instances.EVENT_ID,
+				CalendarContract.Instances.TITLE,
+				CalendarContract.Instances.BEGIN,
+				CalendarContract.Instances.END,
+				CalendarContract.Instances.DISPLAY_COLOR
+			)
 
-        // Sätt upp tid för "idag" med java.time
-        val zoneId = ZoneId.systemDefault()
-        val today = LocalDate.now(zoneId)
-        val startOfDayMillis = today.atStartOfDay(zoneId).toInstant().toEpochMilli()
-        val endOfDayMillis = today.atTime(LocalTime.MAX).atZone(zoneId).toInstant().toEpochMilli()
+			// Sätt upp tid för "idag" med java.time
+			val zoneId = ZoneId.systemDefault()
+			val today = LocalDate.now(zoneId)
+			val startOfDayMillis = today.atStartOfDay(zoneId).toInstant().toEpochMilli()
+			val endOfDayMillis =
+				today.atTime(LocalTime.MAX).atZone(zoneId).toInstant().toEpochMilli()
 
-        // Bygg query
-        val builder = CalendarContract.Instances.CONTENT_URI.buildUpon()
-        ContentUris.appendId(builder, startOfDayMillis)
-        ContentUris.appendId(builder, endOfDayMillis)
+			// Bygg query
+			val builder = CalendarContract.Instances.CONTENT_URI.buildUpon()
+			ContentUris.appendId(builder, startOfDayMillis)
+			ContentUris.appendId(builder, endOfDayMillis)
 
-        try {
-            context.contentResolver.query(
-                builder.build(),
-                projection,
-                null,
-                null,
-                "${CalendarContract.Instances.BEGIN} ASC"
-            )?.use { cursor ->
-                val idIdx = cursor.getColumnIndex(CalendarContract.Instances.EVENT_ID)
-                val titleIdx = cursor.getColumnIndex(CalendarContract.Instances.TITLE)
-                val beginIdx = cursor.getColumnIndex(CalendarContract.Instances.BEGIN)
-                val endIdx = cursor.getColumnIndex(CalendarContract.Instances.END)
-                val colorIdx = cursor.getColumnIndex(CalendarContract.Instances.DISPLAY_COLOR)
+			try {
+				context.contentResolver.query(
+					builder.build(),
+					projection,
+					null,
+					null,
+					"${CalendarContract.Instances.BEGIN} ASC"
+				)?.use { cursor ->
+					val idIdx = cursor.getColumnIndex(CalendarContract.Instances.EVENT_ID)
+					val titleIdx = cursor.getColumnIndex(CalendarContract.Instances.TITLE)
+					val beginIdx = cursor.getColumnIndex(CalendarContract.Instances.BEGIN)
+					val endIdx = cursor.getColumnIndex(CalendarContract.Instances.END)
+					val colorIdx = cursor.getColumnIndex(CalendarContract.Instances.DISPLAY_COLOR)
 
-                while (cursor.moveToNext()) {
-                    val id = cursor.getString(idIdx)
-                    val title = cursor.getString(titleIdx) ?: "No Title"
-                    val begin = cursor.getLong(beginIdx)
-                    val end = cursor.getLong(endIdx)
-                    val color = cursor.getInt(colorIdx)
+					while (cursor.moveToNext()) {
+						val id = cursor.getString(idIdx)
+						val title = cursor.getString(titleIdx) ?: "No Title"
+						val begin = cursor.getLong(beginIdx)
+						val end = cursor.getLong(endIdx)
+						val color = cursor.getInt(colorIdx)
 
-                    val startTime = Instant.ofEpochMilli(begin).atZone(zoneId).toLocalTime()
-                    val endTime = Instant.ofEpochMilli(end).atZone(zoneId).toLocalTime()
+						val startTime = Instant.ofEpochMilli(begin).atZone(zoneId).toLocalTime()
+						val endTime = Instant.ofEpochMilli(end).atZone(zoneId).toLocalTime()
 
-                    events.add(
-                        DayEvent(
-                            id = id,
-                            title = title,
-                            start = startTime,
-                            end = endTime,
-                            color = androidx.compose.ui.graphics.Color(color)
-                        )
-                    )
-                }
-            }
-        } catch (e: Exception) {
-            e.printStackTrace()
-            // Returnera tom lista eller logga fel vid problem
-        }
-        events
-    }
+						events.add(
+							DayEvent(
+								id = id,
+								title = title,
+								start = startTime,
+								end = endTime,
+								color = androidx.compose.ui.graphics.Color(color)
+							)
+						)
+					}
+				}
+			} catch (e: Exception) {
+				e.printStackTrace()
+				// Returnera tom lista eller logga fel vid problem
+			}
+			events
+		}
 }
Index: app/src/main/java/com/example/stalp/data/DayEvent.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.data\r\n\r\nimport androidx.compose.ui.graphics.Color\r\nimport java.time.LocalTime\r\n\r\ndata class DayEvent(\r\n    val id: String,\r\n    val title: String,\r\n    val start: LocalTime,\r\n    val end: LocalTime? = null,\r\n    val icon: String? = null,\r\n    val color: Color = Color(0xFF6AA6FF)\r\n)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/data/DayEvent.kt b/app/src/main/java/com/example/stalp/data/DayEvent.kt
--- a/app/src/main/java/com/example/stalp/data/DayEvent.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/data/DayEvent.kt	(date 1764633892269)
@@ -4,10 +4,10 @@
 import java.time.LocalTime
 
 data class DayEvent(
-    val id: String,
-    val title: String,
-    val start: LocalTime,
-    val end: LocalTime? = null,
-    val icon: String? = null,
-    val color: Color = Color(0xFF6AA6FF)
+	val id: String,
+	val title: String,
+	val start: LocalTime,
+	val end: LocalTime? = null,
+	val icon: String? = null,
+	val color: Color = Color(0xFF6AA6FF)
 )
Index: app/src/main/java/com/example/stalp/workers/WeatherWorker.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.workers\r\n\r\nimport android.content.Context\r\nimport androidx.glance.appwidget.GlanceAppWidgetManager\r\nimport androidx.work.CoroutineWorker\r\nimport androidx.work.Constraints\r\nimport androidx.work.ExistingPeriodicWorkPolicy\r\nimport androidx.work.NetworkType\r\nimport androidx.work.PeriodicWorkRequestBuilder\r\nimport androidx.work.WorkManager\r\nimport androidx.work.WorkerParameters\r\nimport com.example.stalp.data.WeatherRepository\r\nimport com.example.stalp.widget.LinearClockWidget\r\nimport kotlinx.coroutines.Dispatchers\r\nimport kotlinx.coroutines.flow.first\r\nimport kotlinx.coroutines.withContext\r\nimport java.util.concurrent.TimeUnit\r\n\r\nclass WeatherWorker(\r\n    private val context: Context,\r\n    workerParams: WorkerParameters\r\n) : CoroutineWorker(context, workerParams) {\r\n\r\n    override suspend fun doWork(): Result = withContext(Dispatchers.IO) {\r\n        try {\r\n            val repository = WeatherRepository(context)\r\n\r\n            // Fetch settings to determine location source\r\n            val settings = repository.locationSettingsFlow.first()\r\n\r\n            // Mock weather fetching logic\r\n            val temp: Int\r\n            val precipChance: Int\r\n\r\n            if (settings.useCurrentLocation) {\r\n                // Simulating GPS location weather (random but consistent for \"local\")\r\n                temp = (-5..25).random()\r\n                precipChance = (0..50).random()\r\n            } else {\r\n                 // Simulating Manual location weather\r\n                 if (settings.manualLocationName.isNotBlank()) {\r\n                     // Generate \"deterministic\" random based on name length to simulate different weather for different cities\r\n                     val seed = settings.manualLocationName.length\r\n                     temp = (seed % 30)\r\n                     precipChance = (seed * 10 % 100)\r\n                 } else {\r\n                     temp = 20\r\n                     precipChance = 0\r\n                 }\r\n            }\r\n            \r\n            repository.saveWeatherData(temp, precipChance)\r\n\r\n            // Update all widgets\r\n            val manager = GlanceAppWidgetManager(context)\r\n            val glanceIds = manager.getGlanceIds(LinearClockWidget::class.java)\r\n            \r\n            glanceIds.forEach { glanceId ->\r\n                // Trigger widget update. \r\n                LinearClockWidget.update(context, glanceId)\r\n            }\r\n\r\n            Result.success()\r\n        } catch (e: Exception) {\r\n            e.printStackTrace()\r\n            Result.retry()\r\n        }\r\n    }\r\n\r\n    companion object {\r\n        private const val UNIQUE_WORK_NAME = \"weather_worker_periodic\"\r\n\r\n        fun schedule(context: Context) {\r\n            val constraints = Constraints.Builder()\r\n                .setRequiredNetworkType(NetworkType.CONNECTED)\r\n                .build()\r\n\r\n            val workRequest = PeriodicWorkRequestBuilder<WeatherWorker>(30, TimeUnit.MINUTES)\r\n                .setConstraints(constraints)\r\n                .build()\r\n\r\n            WorkManager.getInstance(context).enqueueUniquePeriodicWork(\r\n                UNIQUE_WORK_NAME,\r\n                ExistingPeriodicWorkPolicy.UPDATE,\r\n                workRequest\r\n            )\r\n        }\r\n\r\n        fun cancel(context: Context) {\r\n            WorkManager.getInstance(context).cancelUniqueWork(UNIQUE_WORK_NAME)\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/workers/WeatherWorker.kt b/app/src/main/java/com/example/stalp/workers/WeatherWorker.kt
--- a/app/src/main/java/com/example/stalp/workers/WeatherWorker.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/workers/WeatherWorker.kt	(date 1764633892340)
@@ -2,8 +2,8 @@
 
 import android.content.Context
 import androidx.glance.appwidget.GlanceAppWidgetManager
-import androidx.work.CoroutineWorker
 import androidx.work.Constraints
+import androidx.work.CoroutineWorker
 import androidx.work.ExistingPeriodicWorkPolicy
 import androidx.work.NetworkType
 import androidx.work.PeriodicWorkRequestBuilder
@@ -17,77 +17,77 @@
 import java.util.concurrent.TimeUnit
 
 class WeatherWorker(
-    private val context: Context,
-    workerParams: WorkerParameters
+	private val context: Context,
+	workerParams: WorkerParameters
 ) : CoroutineWorker(context, workerParams) {
 
-    override suspend fun doWork(): Result = withContext(Dispatchers.IO) {
-        try {
-            val repository = WeatherRepository(context)
+	override suspend fun doWork(): Result = withContext(Dispatchers.IO) {
+		try {
+			val repository = WeatherRepository(context)
 
-            // Fetch settings to determine location source
-            val settings = repository.locationSettingsFlow.first()
+			// Fetch settings to determine location source
+			val settings = repository.locationSettingsFlow.first()
 
-            // Mock weather fetching logic
-            val temp: Int
-            val precipChance: Int
+			// Mock weather fetching logic
+			val temp: Int
+			val precipChance: Int
 
-            if (settings.useCurrentLocation) {
-                // Simulating GPS location weather (random but consistent for "local")
-                temp = (-5..25).random()
-                precipChance = (0..50).random()
-            } else {
-                 // Simulating Manual location weather
-                 if (settings.manualLocationName.isNotBlank()) {
-                     // Generate "deterministic" random based on name length to simulate different weather for different cities
-                     val seed = settings.manualLocationName.length
-                     temp = (seed % 30)
-                     precipChance = (seed * 10 % 100)
-                 } else {
-                     temp = 20
-                     precipChance = 0
-                 }
-            }
-            
-            repository.saveWeatherData(temp, precipChance)
+			if (settings.useCurrentLocation) {
+				// Simulating GPS location weather (random but consistent for "local")
+				temp = (-5..25).random()
+				precipChance = (0..50).random()
+			} else {
+				// Simulating Manual location weather
+				if (settings.manualLocationName.isNotBlank()) {
+					// Generate "deterministic" random based on name length to simulate different weather for different cities
+					val seed = settings.manualLocationName.length
+					temp = (seed % 30)
+					precipChance = (seed * 10 % 100)
+				} else {
+					temp = 20
+					precipChance = 0
+				}
+			}
+
+			repository.saveWeatherData(temp, precipChance)
 
-            // Update all widgets
-            val manager = GlanceAppWidgetManager(context)
-            val glanceIds = manager.getGlanceIds(LinearClockWidget::class.java)
-            
-            glanceIds.forEach { glanceId ->
-                // Trigger widget update. 
-                LinearClockWidget.update(context, glanceId)
-            }
+			// Update all widgets
+			val manager = GlanceAppWidgetManager(context)
+			val glanceIds = manager.getGlanceIds(LinearClockWidget::class.java)
+
+			glanceIds.forEach { glanceId ->
+				// Trigger widget update.
+				LinearClockWidget.update(context, glanceId)
+			}
 
-            Result.success()
-        } catch (e: Exception) {
-            e.printStackTrace()
-            Result.retry()
-        }
-    }
+			Result.success()
+		} catch (e: Exception) {
+			e.printStackTrace()
+			Result.retry()
+		}
+	}
 
-    companion object {
-        private const val UNIQUE_WORK_NAME = "weather_worker_periodic"
+	companion object {
+		private const val UNIQUE_WORK_NAME = "weather_worker_periodic"
 
-        fun schedule(context: Context) {
-            val constraints = Constraints.Builder()
-                .setRequiredNetworkType(NetworkType.CONNECTED)
-                .build()
+		fun schedule(context: Context) {
+			val constraints = Constraints.Builder()
+				.setRequiredNetworkType(NetworkType.CONNECTED)
+				.build()
 
-            val workRequest = PeriodicWorkRequestBuilder<WeatherWorker>(30, TimeUnit.MINUTES)
-                .setConstraints(constraints)
-                .build()
+			val workRequest = PeriodicWorkRequestBuilder<WeatherWorker>(30, TimeUnit.MINUTES)
+				.setConstraints(constraints)
+				.build()
 
-            WorkManager.getInstance(context).enqueueUniquePeriodicWork(
-                UNIQUE_WORK_NAME,
-                ExistingPeriodicWorkPolicy.UPDATE,
-                workRequest
-            )
-        }
+			WorkManager.getInstance(context).enqueueUniquePeriodicWork(
+				UNIQUE_WORK_NAME,
+				ExistingPeriodicWorkPolicy.UPDATE,
+				workRequest
+			)
+		}
 
-        fun cancel(context: Context) {
-            WorkManager.getInstance(context).cancelUniqueWork(UNIQUE_WORK_NAME)
-        }
-    }
+		fun cancel(context: Context) {
+			WorkManager.getInstance(context).cancelUniqueWork(UNIQUE_WORK_NAME)
+		}
+	}
 }
Index: app/build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>plugins {\r\n\r\n        alias(libs.plugins.android.application)\r\n        alias(libs.plugins.org.jetbrains.kotlin.android)\r\n        alias(libs.plugins.compose.compiler) // <-- Correct way to apply the plugin\r\n        id(\"org.jetbrains.kotlin.plugin.parcelize\")\r\n}\r\n\r\nandroid {\r\n    namespace = \"com.example.stalp\"\r\n    // SDK 34 är en stabil och bra version att kompilera mot.\r\n    compileSdk = 36\r\n\r\n    defaultConfig {\r\n        applicationId = \"com.example.stalp\"\r\n        // minSdk 33 är ett bra val för moderna funktioner som Glance.\r\n        minSdk = 33\r\n        targetSdk = 36\r\n\r\n        val gitCommitCount = try {\r\n            \"git rev-list --count HEAD\".execute().trim().toInt()\r\n        } catch (e: Exception) {\r\n            1\r\n        }\r\n\r\n        versionCode = gitCommitCount\r\n        versionName = \"1.0.$gitCommitCount\"\r\n\r\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\r\n        vectorDrawables {\r\n            useSupportLibrary = true\r\n        }\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\r\n                \"proguard-rules.pro\"\r\n            )\r\n        }\r\n    }\r\n\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_1_8\r\n        targetCompatibility = JavaVersion.VERSION_1_8\r\n    }\r\n\r\n    kotlinOptions {\r\n        jvmTarget = \"1.8\"\r\n    }\r\n\r\n    buildFeatures {\r\n        // Aktiverar Jetpack Compose för modulen.\r\n        compose = true\r\n        // Aktiverar BuildConfig för att kunna läsa versionsnamn\r\n        buildConfig = true\r\n    }\r\n\r\n    // TAS BORT: 'composeOptions' behövs inte längre när du använder 'kotlin.compose'-pluginen,\r\n    // eftersom den automatiskt väljer rätt kompilatorversion baserat på din Kotlin-version.\r\n    // composeOptions {\r\n    //     kotlinCompilerExtensionVersion = \"1.5.11\"\r\n    // }\r\n\r\n    packaging {\r\n        resources {\r\n            excludes += \"/META-INF/{AL2.0,LGPL2.1}\"\r\n        }\r\n    }\r\n}\r\n\r\nfun String.execute(): String = Runtime.getRuntime().exec(this).inputStream.reader().readText()\r\n\r\n// Allt beroende (dependencies) ska ligga i ett enda block.\r\ndependencies {\r\n    // Kärnbibliotek\r\n    implementation(libs.androidx.core.ktx)\r\n    implementation(libs.androidx.lifecycle.runtime.ktx)\r\n    implementation(libs.androidx.activity.compose)\r\n    implementation(libs.androidx.navigation.compose)\r\n\r\n    // Jetpack Compose\r\n    // Använder \"Bill of Materials\" (BOM) för att hantera Compose-versioner.\r\n    implementation(platform(libs.androidx.compose.bom))\r\n    implementation(libs.androidx.ui)\r\n    implementation(libs.androidx.ui.graphics)\r\n    implementation(libs.androidx.ui.tooling.preview)\r\n    implementation(libs.androidx.material3)\r\n\r\n    // Glance (för App Widgets)\r\n    implementation(libs.androidx.glance)\r\n    implementation(libs.androidx.glance.appwidget)\r\n    implementation(libs.androidx.glance.material3)\r\n\r\n    // WorkManager (för bakgrundsjobb)\r\n    implementation(libs.androidx.work.runtime.ktx)\r\n\r\n    // DataStore (för att spara data asynkront)\r\n    implementation(libs.androidx.datastore.preferences)\r\n\r\n    // Testbibliotek\r\n    testImplementation(libs.junit)\r\n    androidTestImplementation(libs.androidx.test.ext.junit)\r\n    androidTestImplementation(libs.androidx.test.espresso.core)\r\n    androidTestImplementation(platform(libs.androidx.compose.bom))\r\n    androidTestImplementation(libs.androidx.ui.test.junit4)\r\n\r\n    // Debug-verktyg för Compose\r\n    debugImplementation(libs.androidx.ui.tooling)\r\n    debugImplementation(libs.androidx.ui.test.manifest)\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/build.gradle.kts b/app/build.gradle.kts
--- a/app/build.gradle.kts	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/build.gradle.kts	(date 1764634016638)
@@ -1,113 +1,116 @@
 plugins {
 
-        alias(libs.plugins.android.application)
-        alias(libs.plugins.org.jetbrains.kotlin.android)
-        alias(libs.plugins.compose.compiler) // <-- Correct way to apply the plugin
-        id("org.jetbrains.kotlin.plugin.parcelize")
+	alias(libs.plugins.android.application)
+	alias(libs.plugins.org.jetbrains.kotlin.android)
+	alias(libs.plugins.compose.compiler) // <-- Correct way to apply the plugin
+	id("org.jetbrains.kotlin.plugin.parcelize")
 }
 
 android {
-    namespace = "com.example.stalp"
-    // SDK 34 är en stabil och bra version att kompilera mot.
-    compileSdk = 36
+	namespace = "com.example.stalp"
+	// SDK 34 är en stabil och bra version att kompilera mot.
+	compileSdk = 36
 
-    defaultConfig {
-        applicationId = "com.example.stalp"
-        // minSdk 33 är ett bra val för moderna funktioner som Glance.
-        minSdk = 33
-        targetSdk = 36
+	defaultConfig {
+		applicationId = "com.example.stalp"
+		// minSdk 33 är ett bra val för moderna funktioner som Glance.
+		minSdk = 33
+		targetSdk = 36
 
-        val gitCommitCount = try {
-            "git rev-list --count HEAD".execute().trim().toInt()
-        } catch (e: Exception) {
-            1
-        }
+		val gitCommitCount = try {
+			"git rev-list --count HEAD".execute().trim().toInt()
+		} catch (e: Exception) {
+			1
+		}
 
-        versionCode = gitCommitCount
-        versionName = "1.0.$gitCommitCount"
+		versionCode = gitCommitCount
+		versionName = "1.0.$gitCommitCount"
 
-        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
-        vectorDrawables {
-            useSupportLibrary = true
-        }
-    }
+		testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
+		vectorDrawables {
+			useSupportLibrary = true
+		}
+	}
 
-    buildTypes {
-        release {
-            isMinifyEnabled = false
-            proguardFiles(
-                getDefaultProguardFile("proguard-android-optimize.txt"),
-                "proguard-rules.pro"
-            )
-        }
-    }
+	buildTypes {
+		release {
+			isMinifyEnabled = false
+			proguardFiles(
+				getDefaultProguardFile("proguard-android-optimize.txt"),
+				"proguard-rules.pro"
+			)
+		}
+		getByName("debug") {
+			isDebuggable = false
+		}
+	}
 
-    compileOptions {
-        sourceCompatibility = JavaVersion.VERSION_1_8
-        targetCompatibility = JavaVersion.VERSION_1_8
-    }
+	compileOptions {
+		sourceCompatibility = JavaVersion.VERSION_1_8
+		targetCompatibility = JavaVersion.VERSION_1_8
+	}
 
-    kotlinOptions {
-        jvmTarget = "1.8"
-    }
+	kotlinOptions {
+		jvmTarget = "1.8"
+	}
 
-    buildFeatures {
-        // Aktiverar Jetpack Compose för modulen.
-        compose = true
-        // Aktiverar BuildConfig för att kunna läsa versionsnamn
-        buildConfig = true
-    }
+	buildFeatures {
+		// Aktiverar Jetpack Compose för modulen.
+		compose = true
+		// Aktiverar BuildConfig för att kunna läsa versionsnamn
+		buildConfig = true
+	}
 
-    // TAS BORT: 'composeOptions' behövs inte längre när du använder 'kotlin.compose'-pluginen,
-    // eftersom den automatiskt väljer rätt kompilatorversion baserat på din Kotlin-version.
-    // composeOptions {
-    //     kotlinCompilerExtensionVersion = "1.5.11"
-    // }
+	// TAS BORT: 'composeOptions' behövs inte längre när du använder 'kotlin.compose'-pluginen,
+	// eftersom den automatiskt väljer rätt kompilatorversion baserat på din Kotlin-version.
+	// composeOptions {
+	//     kotlinCompilerExtensionVersion = "1.5.11"
+	// }
 
-    packaging {
-        resources {
-            excludes += "/META-INF/{AL2.0,LGPL2.1}"
-        }
-    }
+	packaging {
+		resources {
+			excludes += "/META-INF/{AL2.0,LGPL2.1}"
+		}
+	}
 }
 
 fun String.execute(): String = Runtime.getRuntime().exec(this).inputStream.reader().readText()
 
 // Allt beroende (dependencies) ska ligga i ett enda block.
 dependencies {
-    // Kärnbibliotek
-    implementation(libs.androidx.core.ktx)
-    implementation(libs.androidx.lifecycle.runtime.ktx)
-    implementation(libs.androidx.activity.compose)
-    implementation(libs.androidx.navigation.compose)
+	// Kärnbibliotek
+	implementation(libs.androidx.core.ktx)
+	implementation(libs.androidx.lifecycle.runtime.ktx)
+	implementation(libs.androidx.activity.compose)
+	implementation(libs.androidx.navigation.compose)
 
-    // Jetpack Compose
-    // Använder "Bill of Materials" (BOM) för att hantera Compose-versioner.
-    implementation(platform(libs.androidx.compose.bom))
-    implementation(libs.androidx.ui)
-    implementation(libs.androidx.ui.graphics)
-    implementation(libs.androidx.ui.tooling.preview)
-    implementation(libs.androidx.material3)
+	// Jetpack Compose
+	// Använder "Bill of Materials" (BOM) för att hantera Compose-versioner.
+	implementation(platform(libs.androidx.compose.bom))
+	implementation(libs.androidx.ui)
+	implementation(libs.androidx.ui.graphics)
+	implementation(libs.androidx.ui.tooling.preview)
+	implementation(libs.androidx.material3)
 
-    // Glance (för App Widgets)
-    implementation(libs.androidx.glance)
-    implementation(libs.androidx.glance.appwidget)
-    implementation(libs.androidx.glance.material3)
+	// Glance (för App Widgets)
+	implementation(libs.androidx.glance)
+	implementation(libs.androidx.glance.appwidget)
+	implementation(libs.androidx.glance.material3)
 
-    // WorkManager (för bakgrundsjobb)
-    implementation(libs.androidx.work.runtime.ktx)
+	// WorkManager (för bakgrundsjobb)
+	implementation(libs.androidx.work.runtime.ktx)
 
-    // DataStore (för att spara data asynkront)
-    implementation(libs.androidx.datastore.preferences)
+	// DataStore (för att spara data asynkront)
+	implementation(libs.androidx.datastore.preferences)
 
-    // Testbibliotek
-    testImplementation(libs.junit)
-    androidTestImplementation(libs.androidx.test.ext.junit)
-    androidTestImplementation(libs.androidx.test.espresso.core)
-    androidTestImplementation(platform(libs.androidx.compose.bom))
-    androidTestImplementation(libs.androidx.ui.test.junit4)
+	// Testbibliotek
+	testImplementation(libs.junit)
+	androidTestImplementation(libs.androidx.test.ext.junit)
+	androidTestImplementation(libs.androidx.test.espresso.core)
+	androidTestImplementation(platform(libs.androidx.compose.bom))
+	androidTestImplementation(libs.androidx.ui.test.junit4)
 
-    // Debug-verktyg för Compose
-    debugImplementation(libs.androidx.ui.tooling)
-    debugImplementation(libs.androidx.ui.test.manifest)
+	// Debug-verktyg för Compose
+	debugImplementation(libs.androidx.ui.tooling)
+	debugImplementation(libs.androidx.ui.test.manifest)
 }
Index: app/src/androidTest/java/com/example/stalp/ExampleInstrumentedTest.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp\r\n\r\nimport androidx.test.platform.app.InstrumentationRegistry\r\nimport androidx.test.ext.junit.runners.AndroidJUnit4\r\n\r\nimport org.junit.Test\r\nimport org.junit.runner.RunWith\r\n\r\nimport org.junit.Assert.*\r\n\r\n/**\r\n * Instrumented test, which will execute on an Android device.\r\n *\r\n * See [testing documentation](http://d.android.com/tools/testing).\r\n */\r\n@RunWith(AndroidJUnit4::class)\r\nclass ExampleInstrumentedTest {\r\n    @Test\r\n    fun useAppContext() {\r\n        // Context of the app under test.\r\n        val appContext = InstrumentationRegistry.getInstrumentation().targetContext\r\n        assertEquals(\"com.example.stalp\", appContext.packageName)\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/androidTest/java/com/example/stalp/ExampleInstrumentedTest.kt b/app/src/androidTest/java/com/example/stalp/ExampleInstrumentedTest.kt
--- a/app/src/androidTest/java/com/example/stalp/ExampleInstrumentedTest.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/androidTest/java/com/example/stalp/ExampleInstrumentedTest.kt	(date 1764633892542)
@@ -1,13 +1,11 @@
 package com.example.stalp
 
-import androidx.test.platform.app.InstrumentationRegistry
 import androidx.test.ext.junit.runners.AndroidJUnit4
-
+import androidx.test.platform.app.InstrumentationRegistry
+import org.junit.Assert.assertEquals
 import org.junit.Test
 import org.junit.runner.RunWith
 
-import org.junit.Assert.*
-
 /**
  * Instrumented test, which will execute on an Android device.
  *
@@ -15,10 +13,10 @@
  */
 @RunWith(AndroidJUnit4::class)
 class ExampleInstrumentedTest {
-    @Test
-    fun useAppContext() {
-        // Context of the app under test.
-        val appContext = InstrumentationRegistry.getInstrumentation().targetContext
-        assertEquals("com.example.stalp", appContext.packageName)
-    }
+	@Test
+	fun useAppContext() {
+		// Context of the app under test.
+		val appContext = InstrumentationRegistry.getInstrumentation().targetContext
+		assertEquals("com.example.stalp", appContext.packageName)
+	}
 }
\ No newline at end of file
Index: app/src/main/res/layout/widget_placeholder.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:orientation=\"vertical\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\">\r\n\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/widget_placeholder.xml b/app/src/main/res/layout/widget_placeholder.xml
--- a/app/src/main/res/layout/widget_placeholder.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/layout/widget_placeholder.xml	(date 1764633892451)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    android:orientation="vertical"
     android:layout_width="match_parent"
-    android:layout_height="match_parent">
+    android:layout_height="match_parent"
+    android:orientation="vertical">
 
 </LinearLayout>
\ No newline at end of file
Index: .idea/deploymentTargetSelector.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"deploymentTargetSelector\">\r\n    <selectionStates>\r\n      <SelectionState runConfigName=\"app\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n        <DropdownSelection timestamp=\"2025-11-30T05:32:26.590368200Z\">\r\n          <Target type=\"DEFAULT_BOOT\">\r\n            <handle>\r\n              <DeviceId pluginId=\"LocalEmulator\" identifier=\"path=C:\\Users\\cr0wn\\.android\\avd\\Pixel_9_Pro_XL.avd\" />\r\n            </handle>\r\n          </Target>\r\n        </DropdownSelection>\r\n        <DialogSelection />\r\n      </SelectionState>\r\n      <SelectionState runConfigName=\"LinearClockConfigActivity\">\r\n        <option name=\"selectionMode\" value=\"DROPDOWN\" />\r\n      </SelectionState>\r\n    </selectionStates>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetSelector.xml b/.idea/deploymentTargetSelector.xml
--- a/.idea/deploymentTargetSelector.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/.idea/deploymentTargetSelector.xml	(date 1764657745475)
@@ -4,7 +4,7 @@
     <selectionStates>
       <SelectionState runConfigName="app">
         <option name="selectionMode" value="DROPDOWN" />
-        <DropdownSelection timestamp="2025-11-30T05:32:26.590368200Z">
+        <DropdownSelection timestamp="2025-12-02T06:33:58.173400600Z">
           <Target type="DEFAULT_BOOT">
             <handle>
               <DeviceId pluginId="LocalEmulator" identifier="path=C:\Users\cr0wn\.android\avd\Pixel_9_Pro_XL.avd" />
@@ -12,9 +12,6 @@
           </Target>
         </DropdownSelection>
         <DialogSelection />
-      </SelectionState>
-      <SelectionState runConfigName="LinearClockConfigActivity">
-        <option name="selectionMode" value="DROPDOWN" />
       </SelectionState>
     </selectionStates>
   </component>
Index: app/src/main/res/xml/linear_clock_widget_info.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<AppWidgetProviderInfo xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:minWidth=\"250dp\"\r\n    android:minHeight=\"72dp\"\r\n    android:description=\"@string/widget_name\"\r\n    android:updatePeriodMillis=\"0\"\r\n    android:initialLayout=\"@layout/widget_placeholder\"\r\n    android:widgetCategory=\"home_screen\"\r\n    android:resizeMode=\"horizontal|vertical\"\r\n    android:previewImage=\"@drawable/ic_launcher_foreground\"\r\n    android:autoAdvanceViewId=\"@+id/auto_advance\"\r\n    android:configure=\"com.example.stalp.widget.LinearClockConfigActivity\" />\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/xml/linear_clock_widget_info.xml b/app/src/main/res/xml/linear_clock_widget_info.xml
--- a/app/src/main/res/xml/linear_clock_widget_info.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/xml/linear_clock_widget_info.xml	(date 1764633892467)
@@ -1,12 +1,12 @@
 <?xml version="1.0" encoding="utf-8"?>
 <AppWidgetProviderInfo xmlns:android="http://schemas.android.com/apk/res/android"
-    android:minWidth="250dp"
-    android:minHeight="72dp"
+    android:autoAdvanceViewId="@+id/auto_advance"
+    android:configure="com.example.stalp.widget.LinearClockConfigActivity"
     android:description="@string/widget_name"
-    android:updatePeriodMillis="0"
     android:initialLayout="@layout/widget_placeholder"
-    android:widgetCategory="home_screen"
-    android:resizeMode="horizontal|vertical"
+    android:minWidth="250dp"
+    android:minHeight="72dp"
     android:previewImage="@drawable/ic_launcher_foreground"
-    android:autoAdvanceViewId="@+id/auto_advance"
-    android:configure="com.example.stalp.widget.LinearClockConfigActivity" />
+    android:resizeMode="horizontal|vertical"
+    android:updatePeriodMillis="0"
+    android:widgetCategory="home_screen" />
Index: app/src/main/res/drawable/ic_clothing_hot.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:width=\"24dp\"\r\n    android:height=\"24dp\"\r\n    android:viewportWidth=\"24\"\r\n    android:viewportHeight=\"24\">\r\n    <!-- Sun -->\r\n    <path\r\n        android:fillColor=\"#FFFFD700\"\r\n        android:pathData=\"M20,4 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0\"/>\r\n    <path\r\n        android:fillColor=\"#FFFFD700\"\r\n        android:pathData=\"M20,1 L20,3 M23,4 L21,4 M20,7 L20,5 M17,4 L19,4 M22,2 L21,3 M22,6 L21,5 M18,6 L19,5 M18,2 L19,3\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FFFFD700\"/>\r\n\r\n    <!-- Body (Shorts and T-shirt) -->\r\n    <path\r\n        android:fillColor=\"#FF000000\"\r\n        android:pathData=\"M12,7 L12,14 M12,14 L10,18 M12,14 L14,18 M12,9 L9,11 M12,9 L15,11\"\r\n        android:strokeWidth=\"2\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Head -->\r\n    <path\r\n        android:fillColor=\"#FFFFFFFF\"\r\n        android:pathData=\"M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Shorts visual (Green pants from image) -->\r\n    <path\r\n        android:fillColor=\"#FF00FF00\"\r\n        android:pathData=\"M11,14 L13,14 L13,16 L11,16 Z\"/>\r\n</vector>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_clothing_hot.xml b/app/src/main/res/drawable/ic_clothing_hot.xml
--- a/app/src/main/res/drawable/ic_clothing_hot.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/drawable/ic_clothing_hot.xml	(date 1764633892222)
@@ -6,27 +6,27 @@
     <!-- Sun -->
     <path
         android:fillColor="#FFFFD700"
-        android:pathData="M20,4 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0"/>
+        android:pathData="M20,4 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0" />
     <path
         android:fillColor="#FFFFD700"
         android:pathData="M20,1 L20,3 M23,4 L21,4 M20,7 L20,5 M17,4 L19,4 M22,2 L21,3 M22,6 L21,5 M18,6 L19,5 M18,2 L19,3"
         android:strokeWidth="1"
-        android:strokeColor="#FFFFD700"/>
+        android:strokeColor="#FFFFD700" />
 
     <!-- Body (Shorts and T-shirt) -->
     <path
         android:fillColor="#FF000000"
         android:pathData="M12,7 L12,14 M12,14 L10,18 M12,14 L14,18 M12,9 L9,11 M12,9 L15,11"
         android:strokeWidth="2"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Head -->
     <path
         android:fillColor="#FFFFFFFF"
         android:pathData="M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0"
         android:strokeWidth="1"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Shorts visual (Green pants from image) -->
     <path
         android:fillColor="#FF00FF00"
-        android:pathData="M11,14 L13,14 L13,16 L11,16 Z"/>
+        android:pathData="M11,14 L13,14 L13,16 L11,16 Z" />
 </vector>
\ No newline at end of file
Index: app/src/main/res/drawable/ic_clothing_normal.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:width=\"24dp\"\r\n    android:height=\"24dp\"\r\n    android:viewportWidth=\"24\"\r\n    android:viewportHeight=\"24\">\r\n    <!-- Body -->\r\n    <path\r\n        android:fillColor=\"#FF000000\"\r\n        android:pathData=\"M12,7 L12,17 M12,17 L9,22 M12,17 L15,22 M12,10 L8,12 M12,10 L16,12\"\r\n        android:strokeWidth=\"2\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Head -->\r\n    <path\r\n        android:fillColor=\"#FFFFFFFF\"\r\n        android:pathData=\"M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n</vector>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_clothing_normal.xml b/app/src/main/res/drawable/ic_clothing_normal.xml
--- a/app/src/main/res/drawable/ic_clothing_normal.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/drawable/ic_clothing_normal.xml	(date 1764633892207)
@@ -8,11 +8,11 @@
         android:fillColor="#FF000000"
         android:pathData="M12,7 L12,17 M12,17 L9,22 M12,17 L15,22 M12,10 L8,12 M12,10 L16,12"
         android:strokeWidth="2"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Head -->
     <path
         android:fillColor="#FFFFFFFF"
         android:pathData="M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0"
         android:strokeWidth="1"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
 </vector>
\ No newline at end of file
Index: app/src/main/res/drawable/ic_clothing_cold.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:width=\"24dp\"\r\n    android:height=\"24dp\"\r\n    android:viewportWidth=\"24\"\r\n    android:viewportHeight=\"24\">\r\n    <!-- Body -->\r\n    <path\r\n        android:fillColor=\"#FF000000\"\r\n        android:pathData=\"M12,7 L12,17 M12,17 L9,22 M12,17 L15,22 M12,10 L8,12 M12,10 L16,12\"\r\n        android:strokeWidth=\"2\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Head -->\r\n    <path\r\n        android:fillColor=\"#FFFFFFFF\"\r\n        android:pathData=\"M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Hat (Beanie) -->\r\n    <path\r\n        android:fillColor=\"#FF0000FF\"\r\n        android:pathData=\"M10,3 L14,3 L12,1 Z\"/>\r\n    <!-- Scarf -->\r\n    <path\r\n        android:fillColor=\"#FF0000FF\"\r\n        android:pathData=\"M11,8 L13,8 L13,10 L11,10 Z\"/>\r\n</vector>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_clothing_cold.xml b/app/src/main/res/drawable/ic_clothing_cold.xml
--- a/app/src/main/res/drawable/ic_clothing_cold.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/drawable/ic_clothing_cold.xml	(date 1764633892582)
@@ -8,19 +8,19 @@
         android:fillColor="#FF000000"
         android:pathData="M12,7 L12,17 M12,17 L9,22 M12,17 L15,22 M12,10 L8,12 M12,10 L16,12"
         android:strokeWidth="2"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Head -->
     <path
         android:fillColor="#FFFFFFFF"
         android:pathData="M12,5 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0"
         android:strokeWidth="1"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Hat (Beanie) -->
     <path
         android:fillColor="#FF0000FF"
-        android:pathData="M10,3 L14,3 L12,1 Z"/>
+        android:pathData="M10,3 L14,3 L12,1 Z" />
     <!-- Scarf -->
     <path
         android:fillColor="#FF0000FF"
-        android:pathData="M11,8 L13,8 L13,10 L11,10 Z"/>
+        android:pathData="M11,8 L13,8 L13,10 L11,10 Z" />
 </vector>
\ No newline at end of file
Index: build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>// Top-level build file where you can add configuration options common to all sub-projects/modules.\r\nplugins {\r\n    alias(libs.plugins.android.application) apply false\r\n    alias(libs.plugins.kotlin.android) apply false\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/build.gradle.kts b/build.gradle.kts
--- a/build.gradle.kts	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/build.gradle.kts	(date 1764633892557)
@@ -1,5 +1,5 @@
 // Top-level build file where you can add configuration options common to all sub-projects/modules.
 plugins {
-    alias(libs.plugins.android.application) apply false
-    alias(libs.plugins.kotlin.android) apply false
+	alias(libs.plugins.android.application) apply false
+	alias(libs.plugins.kotlin.android) apply false
 }
Index: settings.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>pluginManagement {\r\n    repositories {\r\n        google()\r\n        mavenCentral()\r\n        gradlePluginPortal()\r\n    }\r\n}\r\ndependencyResolutionManagement {\r\n    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)\r\n    repositories {\r\n        google()\r\n        mavenCentral()\r\n    }\r\n}\r\n\r\nrootProject.name = \"Stalp\"\r\ninclude(\":app\")\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/settings.gradle.kts b/settings.gradle.kts
--- a/settings.gradle.kts	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/settings.gradle.kts	(date 1764633892398)
@@ -1,16 +1,16 @@
 pluginManagement {
-    repositories {
-        google()
-        mavenCentral()
-        gradlePluginPortal()
-    }
+	repositories {
+		google()
+		mavenCentral()
+		gradlePluginPortal()
+	}
 }
 dependencyResolutionManagement {
-    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
-    repositories {
-        google()
-        mavenCentral()
-    }
+	repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
+	repositories {
+		google()
+		mavenCentral()
+	}
 }
 
 rootProject.name = "Stalp"
Index: app/src/main/res/drawable/ic_clothing_rain.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:width=\"24dp\"\r\n    android:height=\"24dp\"\r\n    android:viewportWidth=\"24\"\r\n    android:viewportHeight=\"24\">\r\n    <!-- Umbrella -->\r\n    <path\r\n        android:fillColor=\"#FF0000FF\"\r\n        android:pathData=\"M8,10 Q12,6 16,10 Z\"/>\r\n    <path\r\n        android:fillColor=\"#00000000\"\r\n        android:pathData=\"M12,10 L12,15\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n\r\n    <!-- Body -->\r\n    <path\r\n        android:fillColor=\"#FF000000\"\r\n        android:pathData=\"M12,12 L12,17 M12,17 L9,22 M12,17 L15,22 M12,13 L9,14 M12,13 L15,12\"\r\n        android:strokeWidth=\"2\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n    <!-- Head -->\r\n    <path\r\n        android:fillColor=\"#FFFFFFFF\"\r\n        android:pathData=\"M12,11 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF000000\"/>\r\n\r\n    <!-- Rain drops -->\r\n    <path\r\n        android:fillColor=\"#FF0000FF\"\r\n        android:pathData=\"M6,5 L6,7 M8,4 L8,6 M5,8 L5,10 M18,5 L18,7 M16,8 L16,10\"\r\n        android:strokeWidth=\"1\"\r\n        android:strokeColor=\"#FF0000FF\"/>\r\n</vector>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_clothing_rain.xml b/app/src/main/res/drawable/ic_clothing_rain.xml
--- a/app/src/main/res/drawable/ic_clothing_rain.xml	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/res/drawable/ic_clothing_rain.xml	(date 1764633892370)
@@ -6,30 +6,30 @@
     <!-- Umbrella -->
     <path
         android:fillColor="#FF0000FF"
-        android:pathData="M8,10 Q12,6 16,10 Z"/>
+        android:pathData="M8,10 Q12,6 16,10 Z" />
     <path
         android:fillColor="#00000000"
         android:pathData="M12,10 L12,15"
         android:strokeWidth="1"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
 
     <!-- Body -->
     <path
         android:fillColor="#FF000000"
         android:pathData="M12,12 L12,17 M12,17 L9,22 M12,17 L15,22 M12,13 L9,14 M12,13 L15,12"
         android:strokeWidth="2"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
     <!-- Head -->
     <path
         android:fillColor="#FFFFFFFF"
         android:pathData="M12,11 m-2,0 a2,2 0 1,1 4,0 a2,2 0 1,1 -4,0"
         android:strokeWidth="1"
-        android:strokeColor="#FF000000"/>
+        android:strokeColor="#FF000000" />
 
     <!-- Rain drops -->
     <path
         android:fillColor="#FF0000FF"
         android:pathData="M6,5 L6,7 M8,4 L8,6 M5,8 L5,10 M18,5 L18,7 M16,8 L16,10"
         android:strokeWidth="1"
-        android:strokeColor="#FF0000FF"/>
+        android:strokeColor="#FF0000FF" />
 </vector>
\ No newline at end of file
Index: app/src/main/java/com/example/stalp/ui/MainViewModel.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui\r\n\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.mutableStateOf\r\nimport androidx.compose.runtime.setValue\r\nimport androidx.lifecycle.ViewModel\r\nimport androidx.lifecycle.viewModelScope\r\nimport com.example.stalp.ui.settings.ThemePreferences\r\nimport com.example.stalp.ui.theme.ThemeOption\r\nimport kotlinx.coroutines.flow.Flow\r\nimport kotlinx.coroutines.launch\r\n\r\nclass MainViewModel(private val themePreferences: ThemePreferences) : ViewModel() {\r\n    // Note: showSettings state is handled by Navigation now, so we don't strictly need it here\r\n    // unless we want to control navigation from VM logic, but the prompt suggested using VM for state.\r\n    // However, with Navigation Compose, the \"screen\" state is implicitly the route.\r\n    // We will still keep theme logic here.\r\n\r\n    val themeOptionFlow: Flow<ThemeOption> = themePreferences.themeOptionFlow()\r\n\r\n    fun onThemeOptionChange(option: ThemeOption) {\r\n        viewModelScope.launch {\r\n            themePreferences.setThemeOption(option)\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/MainViewModel.kt b/app/src/main/java/com/example/stalp/ui/MainViewModel.kt
--- a/app/src/main/java/com/example/stalp/ui/MainViewModel.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/MainViewModel.kt	(date 1764633892358)
@@ -1,8 +1,5 @@
 package com.example.stalp.ui
 
-import androidx.compose.runtime.getValue
-import androidx.compose.runtime.mutableStateOf
-import androidx.compose.runtime.setValue
 import androidx.lifecycle.ViewModel
 import androidx.lifecycle.viewModelScope
 import com.example.stalp.ui.settings.ThemePreferences
@@ -11,16 +8,16 @@
 import kotlinx.coroutines.launch
 
 class MainViewModel(private val themePreferences: ThemePreferences) : ViewModel() {
-    // Note: showSettings state is handled by Navigation now, so we don't strictly need it here
-    // unless we want to control navigation from VM logic, but the prompt suggested using VM for state.
-    // However, with Navigation Compose, the "screen" state is implicitly the route.
-    // We will still keep theme logic here.
+	// Note: showSettings state is handled by Navigation now, so we don't strictly need it here
+	// unless we want to control navigation from VM logic, but the prompt suggested using VM for state.
+	// However, with Navigation Compose, the "screen" state is implicitly the route.
+	// We will still keep theme logic here.
 
-    val themeOptionFlow: Flow<ThemeOption> = themePreferences.themeOptionFlow()
+	val themeOptionFlow: Flow<ThemeOption> = themePreferences.themeOptionFlow()
 
-    fun onThemeOptionChange(option: ThemeOption) {
-        viewModelScope.launch {
-            themePreferences.setThemeOption(option)
-        }
-    }
+	fun onThemeOptionChange(option: ThemeOption) {
+		viewModelScope.launch {
+			themePreferences.setThemeOption(option)
+		}
+	}
 }
Index: app/src/main/java/com/example/stalp/ui/theme/Color.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.theme\r\n\r\nimport androidx.compose.ui.graphics.Color\r\n\r\nenum class ThemeOption(val displayName: String) {\r\n    NordicCalm(\"Nordic Calm\"),\r\n    SolarDawn(\"Solar Dawn\")\r\n}\r\n\r\ndata class ThemePaletteColors(\r\n    val primary: Color,\r\n    val onPrimary: Color,\r\n    val primaryContainer: Color,\r\n    val onPrimaryContainer: Color,\r\n    val secondary: Color,\r\n    val onSecondary: Color,\r\n    val secondaryContainer: Color,\r\n    val onSecondaryContainer: Color,\r\n    val tertiary: Color,\r\n    val onTertiary: Color,\r\n    val tertiaryContainer: Color,\r\n    val onTertiaryContainer: Color,\r\n    val background: Color,\r\n    val onBackground: Color,\r\n    val surface: Color,\r\n    val onSurface: Color,\r\n    val surfaceVariant: Color,\r\n    val onSurfaceVariant: Color,\r\n    val outline: Color,\r\n)\r\n\r\nval NordicCalmLightPalette = ThemePaletteColors(\r\n    primary = Color(0xFF2D5A6A),\r\n    onPrimary = Color(0xFFFFFFFF),\r\n    primaryContainer = Color(0xFFBCE6FF),\r\n    onPrimaryContainer = Color(0xFF051F2C),\r\n    secondary = Color(0xFF4C6F6B),\r\n    onSecondary = Color(0xFFFFFFFF),\r\n    secondaryContainer = Color(0xFFCDE8E0),\r\n    onSecondaryContainer = Color(0xFF0A241F),\r\n    tertiary = Color(0xFF3E5C7A),\r\n    onTertiary = Color(0xFFFFFFFF),\r\n    tertiaryContainer = Color(0xFFD6E3FF),\r\n    onTertiaryContainer = Color(0xFF0E243A),\r\n    background = Color(0xFFF6F8F9),\r\n    onBackground = Color(0xFF111827),\r\n    surface = Color(0xFFFFFFFF),\r\n    onSurface = Color(0xFF111827),\r\n    surfaceVariant = Color(0xFFDAE4E8),\r\n    onSurfaceVariant = Color(0xFF3F4C52),\r\n    outline = Color(0xFF6A7A81),\r\n)\r\n\r\nval NordicCalmDarkPalette = ThemePaletteColors(\r\n    primary = Color(0xFF89C9E6),\r\n    onPrimary = Color(0xFF0C2A38),\r\n    primaryContainer = Color(0xFF1F4453),\r\n    onPrimaryContainer = Color(0xFFBCE6FF),\r\n    secondary = Color(0xFFB1CCC4),\r\n    onSecondary = Color(0xFF1F3531),\r\n    secondaryContainer = Color(0xFF345149),\r\n    onSecondaryContainer = Color(0xFFCDE8E0),\r\n    tertiary = Color(0xFFABC7EA),\r\n    onTertiary = Color(0xFF142D45),\r\n    tertiaryContainer = Color(0xFF294463),\r\n    onTertiaryContainer = Color(0xFFD6E3FF),\r\n    background = Color(0xFF0B1218),\r\n    onBackground = Color(0xFFE2E8F0),\r\n    surface = Color(0xFF0F1720),\r\n    onSurface = Color(0xFFE2E8F0),\r\n    surfaceVariant = Color(0xFF3F4C52),\r\n    onSurfaceVariant = Color(0xFFBEC8CD),\r\n    outline = Color(0xFF85939A),\r\n)\r\n\r\nval SolarDawnLightPalette = ThemePaletteColors(\r\n    primary = Color(0xFFCC5A1A),\r\n    onPrimary = Color(0xFFFFFFFF),\r\n    primaryContainer = Color(0xFFFFD8C4),\r\n    onPrimaryContainer = Color(0xFF2C0A00),\r\n    secondary = Color(0xFF965A16),\r\n    onSecondary = Color(0xFFFFFFFF),\r\n    secondaryContainer = Color(0xFFFFDEAB),\r\n    onSecondaryContainer = Color(0xFF301400),\r\n    tertiary = Color(0xFF7C3E65),\r\n    onTertiary = Color(0xFFFFFFFF),\r\n    tertiaryContainer = Color(0xFFFFD7EF),\r\n    onTertiaryContainer = Color(0xFF310B2A),\r\n    background = Color(0xFFFFF8F4),\r\n    onBackground = Color(0xFF1F130E),\r\n    surface = Color(0xFFFFFBFA),\r\n    onSurface = Color(0xFF201915),\r\n    surfaceVariant = Color(0xFFF0DFD7),\r\n    onSurfaceVariant = Color(0xFF52443D),\r\n    outline = Color(0xFF85746C),\r\n)\r\n\r\nval SolarDawnDarkPalette = ThemePaletteColors(\r\n    primary = Color(0xFFFFB78D),\r\n    onPrimary = Color(0xFF471700),\r\n    primaryContainer = Color(0xFF673000),\r\n    onPrimaryContainer = Color(0xFFFFD8C4),\r\n    secondary = Color(0xFFF3BD7A),\r\n    onSecondary = Color(0xFF4D2700),\r\n    secondaryContainer = Color(0xFF6E3C00),\r\n    onSecondaryContainer = Color(0xFFFFDEAB),\r\n    tertiary = Color(0xFFEEB5D9),\r\n    onTertiary = Color(0xFF4B193E),\r\n    tertiaryContainer = Color(0xFF632A55),\r\n    onTertiaryContainer = Color(0xFFFFD7EF),\r\n    background = Color(0xFF15100C),\r\n    onBackground = Color(0xFFF4E5DD),\r\n    surface = Color(0xFF1C1511),\r\n    onSurface = Color(0xFFECDDD4),\r\n    surfaceVariant = Color(0xFF52443D),\r\n    onSurfaceVariant = Color(0xFFD3C2B9),\r\n    outline = Color(0xFF9C8C84),\r\n)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/theme/Color.kt b/app/src/main/java/com/example/stalp/ui/theme/Color.kt
--- a/app/src/main/java/com/example/stalp/ui/theme/Color.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/theme/Color.kt	(date 1764633892189)
@@ -3,116 +3,116 @@
 import androidx.compose.ui.graphics.Color
 
 enum class ThemeOption(val displayName: String) {
-    NordicCalm("Nordic Calm"),
-    SolarDawn("Solar Dawn")
+	NordicCalm("Nordic Calm"),
+	SolarDawn("Solar Dawn")
 }
 
 data class ThemePaletteColors(
-    val primary: Color,
-    val onPrimary: Color,
-    val primaryContainer: Color,
-    val onPrimaryContainer: Color,
-    val secondary: Color,
-    val onSecondary: Color,
-    val secondaryContainer: Color,
-    val onSecondaryContainer: Color,
-    val tertiary: Color,
-    val onTertiary: Color,
-    val tertiaryContainer: Color,
-    val onTertiaryContainer: Color,
-    val background: Color,
-    val onBackground: Color,
-    val surface: Color,
-    val onSurface: Color,
-    val surfaceVariant: Color,
-    val onSurfaceVariant: Color,
-    val outline: Color,
+	val primary: Color,
+	val onPrimary: Color,
+	val primaryContainer: Color,
+	val onPrimaryContainer: Color,
+	val secondary: Color,
+	val onSecondary: Color,
+	val secondaryContainer: Color,
+	val onSecondaryContainer: Color,
+	val tertiary: Color,
+	val onTertiary: Color,
+	val tertiaryContainer: Color,
+	val onTertiaryContainer: Color,
+	val background: Color,
+	val onBackground: Color,
+	val surface: Color,
+	val onSurface: Color,
+	val surfaceVariant: Color,
+	val onSurfaceVariant: Color,
+	val outline: Color,
 )
 
 val NordicCalmLightPalette = ThemePaletteColors(
-    primary = Color(0xFF2D5A6A),
-    onPrimary = Color(0xFFFFFFFF),
-    primaryContainer = Color(0xFFBCE6FF),
-    onPrimaryContainer = Color(0xFF051F2C),
-    secondary = Color(0xFF4C6F6B),
-    onSecondary = Color(0xFFFFFFFF),
-    secondaryContainer = Color(0xFFCDE8E0),
-    onSecondaryContainer = Color(0xFF0A241F),
-    tertiary = Color(0xFF3E5C7A),
-    onTertiary = Color(0xFFFFFFFF),
-    tertiaryContainer = Color(0xFFD6E3FF),
-    onTertiaryContainer = Color(0xFF0E243A),
-    background = Color(0xFFF6F8F9),
-    onBackground = Color(0xFF111827),
-    surface = Color(0xFFFFFFFF),
-    onSurface = Color(0xFF111827),
-    surfaceVariant = Color(0xFFDAE4E8),
-    onSurfaceVariant = Color(0xFF3F4C52),
-    outline = Color(0xFF6A7A81),
+	primary = Color(0xFF2D5A6A),
+	onPrimary = Color(0xFFFFFFFF),
+	primaryContainer = Color(0xFFBCE6FF),
+	onPrimaryContainer = Color(0xFF051F2C),
+	secondary = Color(0xFF4C6F6B),
+	onSecondary = Color(0xFFFFFFFF),
+	secondaryContainer = Color(0xFFCDE8E0),
+	onSecondaryContainer = Color(0xFF0A241F),
+	tertiary = Color(0xFF3E5C7A),
+	onTertiary = Color(0xFFFFFFFF),
+	tertiaryContainer = Color(0xFFD6E3FF),
+	onTertiaryContainer = Color(0xFF0E243A),
+	background = Color(0xFFF6F8F9),
+	onBackground = Color(0xFF111827),
+	surface = Color(0xFFFFFFFF),
+	onSurface = Color(0xFF111827),
+	surfaceVariant = Color(0xFFDAE4E8),
+	onSurfaceVariant = Color(0xFF3F4C52),
+	outline = Color(0xFF6A7A81),
 )
 
 val NordicCalmDarkPalette = ThemePaletteColors(
-    primary = Color(0xFF89C9E6),
-    onPrimary = Color(0xFF0C2A38),
-    primaryContainer = Color(0xFF1F4453),
-    onPrimaryContainer = Color(0xFFBCE6FF),
-    secondary = Color(0xFFB1CCC4),
-    onSecondary = Color(0xFF1F3531),
-    secondaryContainer = Color(0xFF345149),
-    onSecondaryContainer = Color(0xFFCDE8E0),
-    tertiary = Color(0xFFABC7EA),
-    onTertiary = Color(0xFF142D45),
-    tertiaryContainer = Color(0xFF294463),
-    onTertiaryContainer = Color(0xFFD6E3FF),
-    background = Color(0xFF0B1218),
-    onBackground = Color(0xFFE2E8F0),
-    surface = Color(0xFF0F1720),
-    onSurface = Color(0xFFE2E8F0),
-    surfaceVariant = Color(0xFF3F4C52),
-    onSurfaceVariant = Color(0xFFBEC8CD),
-    outline = Color(0xFF85939A),
+	primary = Color(0xFF89C9E6),
+	onPrimary = Color(0xFF0C2A38),
+	primaryContainer = Color(0xFF1F4453),
+	onPrimaryContainer = Color(0xFFBCE6FF),
+	secondary = Color(0xFFB1CCC4),
+	onSecondary = Color(0xFF1F3531),
+	secondaryContainer = Color(0xFF345149),
+	onSecondaryContainer = Color(0xFFCDE8E0),
+	tertiary = Color(0xFFABC7EA),
+	onTertiary = Color(0xFF142D45),
+	tertiaryContainer = Color(0xFF294463),
+	onTertiaryContainer = Color(0xFFD6E3FF),
+	background = Color(0xFF0B1218),
+	onBackground = Color(0xFFE2E8F0),
+	surface = Color(0xFF0F1720),
+	onSurface = Color(0xFFE2E8F0),
+	surfaceVariant = Color(0xFF3F4C52),
+	onSurfaceVariant = Color(0xFFBEC8CD),
+	outline = Color(0xFF85939A),
 )
 
 val SolarDawnLightPalette = ThemePaletteColors(
-    primary = Color(0xFFCC5A1A),
-    onPrimary = Color(0xFFFFFFFF),
-    primaryContainer = Color(0xFFFFD8C4),
-    onPrimaryContainer = Color(0xFF2C0A00),
-    secondary = Color(0xFF965A16),
-    onSecondary = Color(0xFFFFFFFF),
-    secondaryContainer = Color(0xFFFFDEAB),
-    onSecondaryContainer = Color(0xFF301400),
-    tertiary = Color(0xFF7C3E65),
-    onTertiary = Color(0xFFFFFFFF),
-    tertiaryContainer = Color(0xFFFFD7EF),
-    onTertiaryContainer = Color(0xFF310B2A),
-    background = Color(0xFFFFF8F4),
-    onBackground = Color(0xFF1F130E),
-    surface = Color(0xFFFFFBFA),
-    onSurface = Color(0xFF201915),
-    surfaceVariant = Color(0xFFF0DFD7),
-    onSurfaceVariant = Color(0xFF52443D),
-    outline = Color(0xFF85746C),
+	primary = Color(0xFFCC5A1A),
+	onPrimary = Color(0xFFFFFFFF),
+	primaryContainer = Color(0xFFFFD8C4),
+	onPrimaryContainer = Color(0xFF2C0A00),
+	secondary = Color(0xFF965A16),
+	onSecondary = Color(0xFFFFFFFF),
+	secondaryContainer = Color(0xFFFFDEAB),
+	onSecondaryContainer = Color(0xFF301400),
+	tertiary = Color(0xFF7C3E65),
+	onTertiary = Color(0xFFFFFFFF),
+	tertiaryContainer = Color(0xFFFFD7EF),
+	onTertiaryContainer = Color(0xFF310B2A),
+	background = Color(0xFFFFF8F4),
+	onBackground = Color(0xFF1F130E),
+	surface = Color(0xFFFFFBFA),
+	onSurface = Color(0xFF201915),
+	surfaceVariant = Color(0xFFF0DFD7),
+	onSurfaceVariant = Color(0xFF52443D),
+	outline = Color(0xFF85746C),
 )
 
 val SolarDawnDarkPalette = ThemePaletteColors(
-    primary = Color(0xFFFFB78D),
-    onPrimary = Color(0xFF471700),
-    primaryContainer = Color(0xFF673000),
-    onPrimaryContainer = Color(0xFFFFD8C4),
-    secondary = Color(0xFFF3BD7A),
-    onSecondary = Color(0xFF4D2700),
-    secondaryContainer = Color(0xFF6E3C00),
-    onSecondaryContainer = Color(0xFFFFDEAB),
-    tertiary = Color(0xFFEEB5D9),
-    onTertiary = Color(0xFF4B193E),
-    tertiaryContainer = Color(0xFF632A55),
-    onTertiaryContainer = Color(0xFFFFD7EF),
-    background = Color(0xFF15100C),
-    onBackground = Color(0xFFF4E5DD),
-    surface = Color(0xFF1C1511),
-    onSurface = Color(0xFFECDDD4),
-    surfaceVariant = Color(0xFF52443D),
-    onSurfaceVariant = Color(0xFFD3C2B9),
-    outline = Color(0xFF9C8C84),
+	primary = Color(0xFFFFB78D),
+	onPrimary = Color(0xFF471700),
+	primaryContainer = Color(0xFF673000),
+	onPrimaryContainer = Color(0xFFFFD8C4),
+	secondary = Color(0xFFF3BD7A),
+	onSecondary = Color(0xFF4D2700),
+	secondaryContainer = Color(0xFF6E3C00),
+	onSecondaryContainer = Color(0xFFFFDEAB),
+	tertiary = Color(0xFFEEB5D9),
+	onTertiary = Color(0xFF4B193E),
+	tertiaryContainer = Color(0xFF632A55),
+	onTertiaryContainer = Color(0xFFFFD7EF),
+	background = Color(0xFF15100C),
+	onBackground = Color(0xFFF4E5DD),
+	surface = Color(0xFF1C1511),
+	onSurface = Color(0xFFECDDD4),
+	surfaceVariant = Color(0xFF52443D),
+	onSurfaceVariant = Color(0xFFD3C2B9),
+	outline = Color(0xFF9C8C84),
 )
Index: app/src/main/java/com/example/stalp/ui/theme/Theme.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.theme\r\n\r\nimport android.os.Build\r\nimport androidx.compose.foundation.isSystemInDarkTheme\r\nimport androidx.compose.material3.ColorScheme\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.darkColorScheme\r\nimport androidx.compose.material3.dynamicDarkColorScheme\r\nimport androidx.compose.material3.dynamicLightColorScheme\r\nimport androidx.compose.material3.lightColorScheme\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.platform.LocalContext\r\n\r\nprivate data class ThemePalette(val light: ColorScheme, val dark: ColorScheme)\r\n\r\nprivate fun ThemePaletteColors.toLightColorScheme(): ColorScheme = lightColorScheme(\r\n    primary = primary,\r\n    onPrimary = onPrimary,\r\n    primaryContainer = primaryContainer,\r\n    onPrimaryContainer = onPrimaryContainer,\r\n    secondary = secondary,\r\n    onSecondary = onSecondary,\r\n    secondaryContainer = secondaryContainer,\r\n    onSecondaryContainer = onSecondaryContainer,\r\n    tertiary = tertiary,\r\n    onTertiary = onTertiary,\r\n    tertiaryContainer = tertiaryContainer,\r\n    onTertiaryContainer = onTertiaryContainer,\r\n    background = background,\r\n    onBackground = onBackground,\r\n    surface = surface,\r\n    onSurface = onSurface,\r\n    surfaceVariant = surfaceVariant,\r\n    onSurfaceVariant = onSurfaceVariant,\r\n    outline = outline,\r\n)\r\n\r\nprivate fun ThemePaletteColors.toDarkColorScheme(): ColorScheme = darkColorScheme(\r\n    primary = primary,\r\n    onPrimary = onPrimary,\r\n    primaryContainer = primaryContainer,\r\n    onPrimaryContainer = onPrimaryContainer,\r\n    secondary = secondary,\r\n    onSecondary = onSecondary,\r\n    secondaryContainer = secondaryContainer,\r\n    onSecondaryContainer = onSecondaryContainer,\r\n    tertiary = tertiary,\r\n    onTertiary = onTertiary,\r\n    tertiaryContainer = tertiaryContainer,\r\n    onTertiaryContainer = onTertiaryContainer,\r\n    background = background,\r\n    onBackground = onBackground,\r\n    surface = surface,\r\n    onSurface = onSurface,\r\n    surfaceVariant = surfaceVariant,\r\n    onSurfaceVariant = onSurfaceVariant,\r\n    outline = outline,\r\n)\r\n\r\nprivate val themeColorSchemes = mapOf(\r\n    ThemeOption.NordicCalm to ThemePalette(\r\n        light = NordicCalmLightPalette.toLightColorScheme(),\r\n        dark = NordicCalmDarkPalette.toDarkColorScheme(),\r\n    ),\r\n    ThemeOption.SolarDawn to ThemePalette(\r\n        light = SolarDawnLightPalette.toLightColorScheme(),\r\n        dark = SolarDawnDarkPalette.toDarkColorScheme(),\r\n    ),\r\n)\r\n\r\n@Composable\r\nfun StalpTheme(\r\n    themeOption: ThemeOption = ThemeOption.NordicCalm,\r\n    darkTheme: Boolean = isSystemInDarkTheme(),\r\n    dynamicColorEnabled: Boolean = true,\r\n    content: @Composable () -> Unit,\r\n) {\r\n    val colorScheme = when {\r\n        dynamicColorEnabled && Build.VERSION.SDK_INT >= Build.VERSION_CODES.S -> {\r\n            val context = LocalContext.current\r\n            if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)\r\n        }\r\n\r\n        else -> {\r\n            val palette = themeColorSchemes[themeOption] ?: themeColorSchemes.getValue(ThemeOption.NordicCalm)\r\n            if (darkTheme) palette.dark else palette.light\r\n        }\r\n    }\r\n\r\n    MaterialTheme(\r\n        colorScheme = colorScheme,\r\n        typography = Typography,\r\n        content = content,\r\n    )\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/theme/Theme.kt b/app/src/main/java/com/example/stalp/ui/theme/Theme.kt
--- a/app/src/main/java/com/example/stalp/ui/theme/Theme.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/theme/Theme.kt	(date 1764633892158)
@@ -14,82 +14,83 @@
 private data class ThemePalette(val light: ColorScheme, val dark: ColorScheme)
 
 private fun ThemePaletteColors.toLightColorScheme(): ColorScheme = lightColorScheme(
-    primary = primary,
-    onPrimary = onPrimary,
-    primaryContainer = primaryContainer,
-    onPrimaryContainer = onPrimaryContainer,
-    secondary = secondary,
-    onSecondary = onSecondary,
-    secondaryContainer = secondaryContainer,
-    onSecondaryContainer = onSecondaryContainer,
-    tertiary = tertiary,
-    onTertiary = onTertiary,
-    tertiaryContainer = tertiaryContainer,
-    onTertiaryContainer = onTertiaryContainer,
-    background = background,
-    onBackground = onBackground,
-    surface = surface,
-    onSurface = onSurface,
-    surfaceVariant = surfaceVariant,
-    onSurfaceVariant = onSurfaceVariant,
-    outline = outline,
+	primary = primary,
+	onPrimary = onPrimary,
+	primaryContainer = primaryContainer,
+	onPrimaryContainer = onPrimaryContainer,
+	secondary = secondary,
+	onSecondary = onSecondary,
+	secondaryContainer = secondaryContainer,
+	onSecondaryContainer = onSecondaryContainer,
+	tertiary = tertiary,
+	onTertiary = onTertiary,
+	tertiaryContainer = tertiaryContainer,
+	onTertiaryContainer = onTertiaryContainer,
+	background = background,
+	onBackground = onBackground,
+	surface = surface,
+	onSurface = onSurface,
+	surfaceVariant = surfaceVariant,
+	onSurfaceVariant = onSurfaceVariant,
+	outline = outline,
 )
 
 private fun ThemePaletteColors.toDarkColorScheme(): ColorScheme = darkColorScheme(
-    primary = primary,
-    onPrimary = onPrimary,
-    primaryContainer = primaryContainer,
-    onPrimaryContainer = onPrimaryContainer,
-    secondary = secondary,
-    onSecondary = onSecondary,
-    secondaryContainer = secondaryContainer,
-    onSecondaryContainer = onSecondaryContainer,
-    tertiary = tertiary,
-    onTertiary = onTertiary,
-    tertiaryContainer = tertiaryContainer,
-    onTertiaryContainer = onTertiaryContainer,
-    background = background,
-    onBackground = onBackground,
-    surface = surface,
-    onSurface = onSurface,
-    surfaceVariant = surfaceVariant,
-    onSurfaceVariant = onSurfaceVariant,
-    outline = outline,
+	primary = primary,
+	onPrimary = onPrimary,
+	primaryContainer = primaryContainer,
+	onPrimaryContainer = onPrimaryContainer,
+	secondary = secondary,
+	onSecondary = onSecondary,
+	secondaryContainer = secondaryContainer,
+	onSecondaryContainer = onSecondaryContainer,
+	tertiary = tertiary,
+	onTertiary = onTertiary,
+	tertiaryContainer = tertiaryContainer,
+	onTertiaryContainer = onTertiaryContainer,
+	background = background,
+	onBackground = onBackground,
+	surface = surface,
+	onSurface = onSurface,
+	surfaceVariant = surfaceVariant,
+	onSurfaceVariant = onSurfaceVariant,
+	outline = outline,
 )
 
 private val themeColorSchemes = mapOf(
-    ThemeOption.NordicCalm to ThemePalette(
-        light = NordicCalmLightPalette.toLightColorScheme(),
-        dark = NordicCalmDarkPalette.toDarkColorScheme(),
-    ),
-    ThemeOption.SolarDawn to ThemePalette(
-        light = SolarDawnLightPalette.toLightColorScheme(),
-        dark = SolarDawnDarkPalette.toDarkColorScheme(),
-    ),
+	ThemeOption.NordicCalm to ThemePalette(
+		light = NordicCalmLightPalette.toLightColorScheme(),
+		dark = NordicCalmDarkPalette.toDarkColorScheme(),
+	),
+	ThemeOption.SolarDawn to ThemePalette(
+		light = SolarDawnLightPalette.toLightColorScheme(),
+		dark = SolarDawnDarkPalette.toDarkColorScheme(),
+	),
 )
 
 @Composable
 fun StalpTheme(
-    themeOption: ThemeOption = ThemeOption.NordicCalm,
-    darkTheme: Boolean = isSystemInDarkTheme(),
-    dynamicColorEnabled: Boolean = true,
-    content: @Composable () -> Unit,
+	themeOption: ThemeOption = ThemeOption.NordicCalm,
+	darkTheme: Boolean = isSystemInDarkTheme(),
+	dynamicColorEnabled: Boolean = true,
+	content: @Composable () -> Unit,
 ) {
-    val colorScheme = when {
-        dynamicColorEnabled && Build.VERSION.SDK_INT >= Build.VERSION_CODES.S -> {
-            val context = LocalContext.current
-            if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)
-        }
+	val colorScheme = when {
+		dynamicColorEnabled && Build.VERSION.SDK_INT >= Build.VERSION_CODES.S -> {
+			val context = LocalContext.current
+			if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)
+		}
 
-        else -> {
-            val palette = themeColorSchemes[themeOption] ?: themeColorSchemes.getValue(ThemeOption.NordicCalm)
-            if (darkTheme) palette.dark else palette.light
-        }
-    }
+		else -> {
+			val palette =
+				themeColorSchemes[themeOption] ?: themeColorSchemes.getValue(ThemeOption.NordicCalm)
+			if (darkTheme) palette.dark else palette.light
+		}
+	}
 
-    MaterialTheme(
-        colorScheme = colorScheme,
-        typography = Typography,
-        content = content,
-    )
+	MaterialTheme(
+		colorScheme = colorScheme,
+		typography = Typography,
+		content = content,
+	)
 }
Index: app/src/main/java/com/example/stalp/widget/LinearClockPreferences.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.widget\r\n\r\nimport androidx.datastore.preferences.core.*\r\n\r\nobject LinearClockPrefs {\r\n    val FONT_FAMILY = stringPreferencesKey(\"font_family\")\r\n    val FONT_SCALE  = floatPreferencesKey(\"font_scale\")\r\n    val COLOR_BG    = intPreferencesKey(\"color_bg\")\r\n    val COLOR_TEXT  = intPreferencesKey(\"color_text\")\r\n    val COLOR_ACCENT= intPreferencesKey(\"color_accent\")\r\n    val HOURS_TO_SHOW = intPreferencesKey(\"hours_to_show\")\r\n\r\n    const val DEF_FONT = \"system\"\r\n    const val DEF_SCALE = 1.0f\r\n    const val DEF_BG = 0xFFFFFFFF.toInt()\r\n    const val DEF_TEXT = 0xFF111111.toInt()\r\n    const val DEF_ACCENT = 0xFFB7EA27.toInt()\r\n    const val DEF_HOURS_TO_SHOW = 6\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/widget/LinearClockPreferences.kt b/app/src/main/java/com/example/stalp/widget/LinearClockPreferences.kt
--- a/app/src/main/java/com/example/stalp/widget/LinearClockPreferences.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/widget/LinearClockPreferences.kt	(date 1764633892434)
@@ -1,19 +1,21 @@
 package com.example.stalp.widget
 
-import androidx.datastore.preferences.core.*
+import androidx.datastore.preferences.core.floatPreferencesKey
+import androidx.datastore.preferences.core.intPreferencesKey
+import androidx.datastore.preferences.core.stringPreferencesKey
 
 object LinearClockPrefs {
-    val FONT_FAMILY = stringPreferencesKey("font_family")
-    val FONT_SCALE  = floatPreferencesKey("font_scale")
-    val COLOR_BG    = intPreferencesKey("color_bg")
-    val COLOR_TEXT  = intPreferencesKey("color_text")
-    val COLOR_ACCENT= intPreferencesKey("color_accent")
-    val HOURS_TO_SHOW = intPreferencesKey("hours_to_show")
+	val FONT_FAMILY = stringPreferencesKey("font_family")
+	val FONT_SCALE = floatPreferencesKey("font_scale")
+	val COLOR_BG = intPreferencesKey("color_bg")
+	val COLOR_TEXT = intPreferencesKey("color_text")
+	val COLOR_ACCENT = intPreferencesKey("color_accent")
+	val HOURS_TO_SHOW = intPreferencesKey("hours_to_show")
 
-    const val DEF_FONT = "system"
-    const val DEF_SCALE = 1.0f
-    const val DEF_BG = 0xFFFFFFFF.toInt()
-    const val DEF_TEXT = 0xFF111111.toInt()
-    const val DEF_ACCENT = 0xFFB7EA27.toInt()
-    const val DEF_HOURS_TO_SHOW = 6
+	const val DEF_FONT = "system"
+	const val DEF_SCALE = 1.0f
+	const val DEF_BG = 0xFFFFFFFF.toInt()
+	const val DEF_TEXT = 0xFF111111.toInt()
+	const val DEF_ACCENT = 0xFFB7EA27.toInt()
+	const val DEF_HOURS_TO_SHOW = 6
 }
\ No newline at end of file
Index: app/src/main/java/com/example/stalp/widget/LinearClockWidget.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.widget\r\n\r\nimport android.content.Context\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.collectAsState\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.glance.GlanceId\r\nimport androidx.glance.GlanceModifier\r\nimport androidx.glance.action.actionStartActivity\r\nimport androidx.glance.action.clickable\r\nimport androidx.glance.appwidget.GlanceAppWidget\r\nimport androidx.glance.appwidget.cornerRadius\r\nimport androidx.glance.appwidget.provideContent\r\nimport androidx.glance.state.PreferencesGlanceStateDefinition\r\nimport androidx.glance.background\r\nimport androidx.glance.layout.Alignment\r\nimport androidx.glance.layout.Box\r\nimport androidx.glance.layout.Column\r\nimport androidx.glance.layout.Row\r\nimport androidx.glance.layout.Spacer\r\nimport androidx.glance.layout.fillMaxHeight\r\nimport androidx.glance.layout.fillMaxSize\r\nimport androidx.glance.layout.fillMaxWidth\r\nimport androidx.glance.layout.height\r\nimport androidx.glance.layout.padding\r\nimport androidx.glance.layout.width\r\nimport androidx.glance.Image\r\nimport androidx.glance.ImageProvider\r\nimport androidx.glance.LocalContext\r\nimport androidx.glance.LocalSize\r\nimport androidx.glance.text.FontWeight\r\nimport androidx.glance.text.Text\r\nimport androidx.glance.text.TextStyle\r\nimport androidx.glance.unit.ColorProvider\r\nimport androidx.compose.ui.unit.TextUnit\r\nimport androidx.compose.ui.unit.TextUnitType\r\nimport com.example.stalp.data.CalendarRepository\r\nimport com.example.stalp.data.WeatherRepository\r\nimport com.example.stalp.data.DayEvent\r\nimport java.time.LocalTime\r\n\r\nobject LinearClockWidget : GlanceAppWidget() {\r\n\r\n    override val stateDefinition = PreferencesGlanceStateDefinition\r\n\r\n    override suspend fun provideGlance(context: Context, id: GlanceId) {\r\n        val weatherRepo = WeatherRepository(context)\r\n        val calendarRepo = CalendarRepository(context)\r\n\r\n        // Hämta event (detta sker vid uppdatering)\r\n        val events = calendarRepo.getEventsForToday()\r\n\r\n        provideContent {\r\n            val weatherData by weatherRepo.weatherDataFlow.collectAsState(initial = null)\r\n            LinearClockWidgetContent(weatherData, events)\r\n        }\r\n    }\r\n}\r\n\r\n@Composable\r\nprivate fun LinearClockWidgetContent(\r\n    weatherData: com.example.stalp.data.WeatherData?,\r\n    events: List<DayEvent>\r\n) {\r\n    val context = LocalContext.current\r\n    val size = LocalSize.current\r\n    val colorBorder = ColorProvider(0xFF000000.toInt())\r\n\r\n    // Enkel logik för px-beräkning (kan behöva justeras för exakt precision)\r\n    val density = context.resources.displayMetrics.density\r\n    val widthPx = (size.width.value * density).toInt().coerceAtLeast(300)\r\n    val heightPx = (80 * density).toInt().coerceAtLeast(100)\r\n\r\n    Column(\r\n        GlanceModifier\r\n            .fillMaxSize()\r\n            .background(ColorProvider(0xFFFFFFFF.toInt()))\r\n            .padding(8.dp)\r\n            .clickable(actionStartActivity<LinearClockConfigActivity>())\r\n    ) {\r\n\r\n        // 1. TOP SECTION: Klockan\r\n        Box(\r\n            GlanceModifier\r\n                .fillMaxWidth()\r\n                .height(80.dp)\r\n                .background(colorBorder)\r\n                .padding(2.dp)\r\n        ) {\r\n            // OBS: Se till att LinearClockBitmapGenerator finns!\r\n            val bitmap = LinearClockBitmapGenerator.generate(\r\n                context = context,\r\n                width = widthPx,\r\n                height = heightPx,\r\n                events = events,\r\n                currentTime = LocalTime.now()\r\n            )\r\n\r\n            Image(\r\n                provider = ImageProvider(bitmap),\r\n                contentDescription = \"Linear Clock\",\r\n                modifier = GlanceModifier.fillMaxSize()\r\n            )\r\n        }\r\n\r\n        Spacer(GlanceModifier.height(8.dp))\r\n\r\n        // 2. BOTTOM SECTION\r\n        Row(GlanceModifier.fillMaxWidth().height(120.dp)) {\r\n\r\n            // 2.1 Weather Box\r\n            Box(\r\n                GlanceModifier\r\n                    .defaultWeight() // RÄTTAT: Inga argument här!\r\n                    .fillMaxHeight()\r\n                    .background(ColorProvider(0xFFFFFFFF.toInt()))\r\n                    .cornerRadius(16.dp)\r\n                    .padding(2.dp)\r\n                    .background(colorBorder)\r\n            ) {\r\n                Column(\r\n                    GlanceModifier\r\n                        .fillMaxSize()\r\n                        .padding(2.dp)\r\n                        .background(ColorProvider(0xFFFFFFFF.toInt()))\r\n                        .padding(8.dp),\r\n                    horizontalAlignment = Alignment.Start,\r\n                    verticalAlignment = Alignment.CenterVertically\r\n                ) {\r\n                    if (weatherData != null && weatherData.isDataLoaded) {\r\n                        Text(\r\n                            text = \"${weatherData.temperatureCelsius}°C\",\r\n                            style = TextStyle(fontSize = TextUnit(24.dp.value, TextUnitType.Sp), fontWeight = FontWeight.Bold)\r\n                        )\r\n                        Spacer(GlanceModifier.height(4.dp))\r\n                        Text(\r\n                            text = weatherData.adviceText,\r\n                            style = TextStyle(fontSize = TextUnit(12.dp.value, TextUnitType.Sp)),\r\n                            maxLines = 4\r\n                        )\r\n                    } else {\r\n                        Text(\"Laddar...\")\r\n                    }\r\n                }\r\n            }\r\n\r\n            Spacer(GlanceModifier.width(8.dp))\r\n\r\n            // 2.2 Clothing Box\r\n            Box(\r\n                GlanceModifier\r\n                    .defaultWeight() // RÄTTAT: Inga argument här!\r\n                    .fillMaxHeight()\r\n                    .background(ColorProvider(0xFFFFFFFF.toInt()))\r\n                    .cornerRadius(16.dp)\r\n                    .padding(2.dp)\r\n                    .background(colorBorder)\r\n            ) {\r\n                Column(\r\n                    GlanceModifier\r\n                        .fillMaxSize()\r\n                        .padding(2.dp)\r\n                        .background(ColorProvider(0xFFFFFFFF.toInt()))\r\n                        .padding(8.dp),\r\n                    horizontalAlignment = Alignment.CenterHorizontally,\r\n                    verticalAlignment = Alignment.CenterVertically\r\n                ) {\r\n                    if (weatherData != null && weatherData.isDataLoaded) {\r\n                        Image(\r\n                            provider = ImageProvider(weatherData.getClothingResourceId()),\r\n                            contentDescription = \"Clothing advice\",\r\n                            modifier = GlanceModifier.fillMaxSize()\r\n                        )\r\n                    } else {\r\n                        Text(\"...\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/widget/LinearClockWidget.kt b/app/src/main/java/com/example/stalp/widget/LinearClockWidget.kt
--- a/app/src/main/java/com/example/stalp/widget/LinearClockWidget.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/widget/LinearClockWidget.kt	(date 1764633892304)
@@ -4,15 +4,20 @@
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.collectAsState
 import androidx.compose.runtime.getValue
+import androidx.compose.ui.unit.TextUnit
+import androidx.compose.ui.unit.TextUnitType
 import androidx.compose.ui.unit.dp
 import androidx.glance.GlanceId
 import androidx.glance.GlanceModifier
+import androidx.glance.Image
+import androidx.glance.ImageProvider
+import androidx.glance.LocalContext
+import androidx.glance.LocalSize
 import androidx.glance.action.actionStartActivity
 import androidx.glance.action.clickable
 import androidx.glance.appwidget.GlanceAppWidget
 import androidx.glance.appwidget.cornerRadius
 import androidx.glance.appwidget.provideContent
-import androidx.glance.state.PreferencesGlanceStateDefinition
 import androidx.glance.background
 import androidx.glance.layout.Alignment
 import androidx.glance.layout.Box
@@ -25,158 +30,156 @@
 import androidx.glance.layout.height
 import androidx.glance.layout.padding
 import androidx.glance.layout.width
-import androidx.glance.Image
-import androidx.glance.ImageProvider
-import androidx.glance.LocalContext
-import androidx.glance.LocalSize
+import androidx.glance.state.PreferencesGlanceStateDefinition
 import androidx.glance.text.FontWeight
 import androidx.glance.text.Text
 import androidx.glance.text.TextStyle
 import androidx.glance.unit.ColorProvider
-import androidx.compose.ui.unit.TextUnit
-import androidx.compose.ui.unit.TextUnitType
 import com.example.stalp.data.CalendarRepository
-import com.example.stalp.data.WeatherRepository
 import com.example.stalp.data.DayEvent
+import com.example.stalp.data.WeatherRepository
 import java.time.LocalTime
 
 object LinearClockWidget : GlanceAppWidget() {
 
-    override val stateDefinition = PreferencesGlanceStateDefinition
+	override val stateDefinition = PreferencesGlanceStateDefinition
 
-    override suspend fun provideGlance(context: Context, id: GlanceId) {
-        val weatherRepo = WeatherRepository(context)
-        val calendarRepo = CalendarRepository(context)
+	override suspend fun provideGlance(context: Context, id: GlanceId) {
+		val weatherRepo = WeatherRepository(context)
+		val calendarRepo = CalendarRepository(context)
 
-        // Hämta event (detta sker vid uppdatering)
-        val events = calendarRepo.getEventsForToday()
+		// Hämta event (detta sker vid uppdatering)
+		val events = calendarRepo.getEventsForToday()
 
-        provideContent {
-            val weatherData by weatherRepo.weatherDataFlow.collectAsState(initial = null)
-            LinearClockWidgetContent(weatherData, events)
-        }
-    }
+		provideContent {
+			val weatherData by weatherRepo.weatherDataFlow.collectAsState(initial = null)
+			LinearClockWidgetContent(weatherData, events)
+		}
+	}
 }
 
 @Composable
 private fun LinearClockWidgetContent(
-    weatherData: com.example.stalp.data.WeatherData?,
-    events: List<DayEvent>
+	weatherData: com.example.stalp.data.WeatherData?,
+	events: List<DayEvent>
 ) {
-    val context = LocalContext.current
-    val size = LocalSize.current
-    val colorBorder = ColorProvider(0xFF000000.toInt())
+	val context = LocalContext.current
+	val size = LocalSize.current
+	val colorBorder = ColorProvider(0xFF000000.toInt())
 
-    // Enkel logik för px-beräkning (kan behöva justeras för exakt precision)
-    val density = context.resources.displayMetrics.density
-    val widthPx = (size.width.value * density).toInt().coerceAtLeast(300)
-    val heightPx = (80 * density).toInt().coerceAtLeast(100)
+	// Enkel logik för px-beräkning (kan behöva justeras för exakt precision)
+	val density = context.resources.displayMetrics.density
+	val widthPx = (size.width.value * density).toInt().coerceAtLeast(300)
+	val heightPx = (80 * density).toInt().coerceAtLeast(100)
 
-    Column(
-        GlanceModifier
-            .fillMaxSize()
-            .background(ColorProvider(0xFFFFFFFF.toInt()))
-            .padding(8.dp)
-            .clickable(actionStartActivity<LinearClockConfigActivity>())
-    ) {
+	Column(
+		GlanceModifier
+			.fillMaxSize()
+			.background(ColorProvider(0xFFFFFFFF.toInt()))
+			.padding(8.dp)
+			.clickable(actionStartActivity<LinearClockConfigActivity>())
+	) {
 
-        // 1. TOP SECTION: Klockan
-        Box(
-            GlanceModifier
-                .fillMaxWidth()
-                .height(80.dp)
-                .background(colorBorder)
-                .padding(2.dp)
-        ) {
-            // OBS: Se till att LinearClockBitmapGenerator finns!
-            val bitmap = LinearClockBitmapGenerator.generate(
-                context = context,
-                width = widthPx,
-                height = heightPx,
-                events = events,
-                currentTime = LocalTime.now()
-            )
+		// 1. TOP SECTION: Klockan
+		Box(
+			GlanceModifier
+				.fillMaxWidth()
+				.height(80.dp)
+				.background(colorBorder)
+				.padding(2.dp)
+		) {
+			// OBS: Se till att LinearClockBitmapGenerator finns!
+			val bitmap = LinearClockBitmapGenerator.generate(
+				context = context,
+				width = widthPx,
+				height = heightPx,
+				events = events,
+				currentTime = LocalTime.now()
+			)
 
-            Image(
-                provider = ImageProvider(bitmap),
-                contentDescription = "Linear Clock",
-                modifier = GlanceModifier.fillMaxSize()
-            )
-        }
+			Image(
+				provider = ImageProvider(bitmap),
+				contentDescription = "Linear Clock",
+				modifier = GlanceModifier.fillMaxSize()
+			)
+		}
 
-        Spacer(GlanceModifier.height(8.dp))
+		Spacer(GlanceModifier.height(8.dp))
 
-        // 2. BOTTOM SECTION
-        Row(GlanceModifier.fillMaxWidth().height(120.dp)) {
+		// 2. BOTTOM SECTION
+		Row(GlanceModifier.fillMaxWidth().height(120.dp)) {
 
-            // 2.1 Weather Box
-            Box(
-                GlanceModifier
-                    .defaultWeight() // RÄTTAT: Inga argument här!
-                    .fillMaxHeight()
-                    .background(ColorProvider(0xFFFFFFFF.toInt()))
-                    .cornerRadius(16.dp)
-                    .padding(2.dp)
-                    .background(colorBorder)
-            ) {
-                Column(
-                    GlanceModifier
-                        .fillMaxSize()
-                        .padding(2.dp)
-                        .background(ColorProvider(0xFFFFFFFF.toInt()))
-                        .padding(8.dp),
-                    horizontalAlignment = Alignment.Start,
-                    verticalAlignment = Alignment.CenterVertically
-                ) {
-                    if (weatherData != null && weatherData.isDataLoaded) {
-                        Text(
-                            text = "${weatherData.temperatureCelsius}°C",
-                            style = TextStyle(fontSize = TextUnit(24.dp.value, TextUnitType.Sp), fontWeight = FontWeight.Bold)
-                        )
-                        Spacer(GlanceModifier.height(4.dp))
-                        Text(
-                            text = weatherData.adviceText,
-                            style = TextStyle(fontSize = TextUnit(12.dp.value, TextUnitType.Sp)),
-                            maxLines = 4
-                        )
-                    } else {
-                        Text("Laddar...")
-                    }
-                }
-            }
+			// 2.1 Weather Box
+			Box(
+				GlanceModifier
+					.defaultWeight() // RÄTTAT: Inga argument här!
+					.fillMaxHeight()
+					.background(ColorProvider(0xFFFFFFFF.toInt()))
+					.cornerRadius(16.dp)
+					.padding(2.dp)
+					.background(colorBorder)
+			) {
+				Column(
+					GlanceModifier
+						.fillMaxSize()
+						.padding(2.dp)
+						.background(ColorProvider(0xFFFFFFFF.toInt()))
+						.padding(8.dp),
+					horizontalAlignment = Alignment.Start,
+					verticalAlignment = Alignment.CenterVertically
+				) {
+					if (weatherData != null && weatherData.isDataLoaded) {
+						Text(
+							text = "${weatherData.temperatureCelsius}°C",
+							style = TextStyle(
+								fontSize = TextUnit(24.dp.value, TextUnitType.Sp),
+								fontWeight = FontWeight.Bold
+							)
+						)
+						Spacer(GlanceModifier.height(4.dp))
+						Text(
+							text = weatherData.adviceText,
+							style = TextStyle(fontSize = TextUnit(12.dp.value, TextUnitType.Sp)),
+							maxLines = 4
+						)
+					} else {
+						Text("Laddar...")
+					}
+				}
+			}
 
-            Spacer(GlanceModifier.width(8.dp))
+			Spacer(GlanceModifier.width(8.dp))
 
-            // 2.2 Clothing Box
-            Box(
-                GlanceModifier
-                    .defaultWeight() // RÄTTAT: Inga argument här!
-                    .fillMaxHeight()
-                    .background(ColorProvider(0xFFFFFFFF.toInt()))
-                    .cornerRadius(16.dp)
-                    .padding(2.dp)
-                    .background(colorBorder)
-            ) {
-                Column(
-                    GlanceModifier
-                        .fillMaxSize()
-                        .padding(2.dp)
-                        .background(ColorProvider(0xFFFFFFFF.toInt()))
-                        .padding(8.dp),
-                    horizontalAlignment = Alignment.CenterHorizontally,
-                    verticalAlignment = Alignment.CenterVertically
-                ) {
-                    if (weatherData != null && weatherData.isDataLoaded) {
-                        Image(
-                            provider = ImageProvider(weatherData.getClothingResourceId()),
-                            contentDescription = "Clothing advice",
-                            modifier = GlanceModifier.fillMaxSize()
-                        )
-                    } else {
-                        Text("...")
-                    }
-                }
-            }
-        }
-    }
+			// 2.2 Clothing Box
+			Box(
+				GlanceModifier
+					.defaultWeight() // RÄTTAT: Inga argument här!
+					.fillMaxHeight()
+					.background(ColorProvider(0xFFFFFFFF.toInt()))
+					.cornerRadius(16.dp)
+					.padding(2.dp)
+					.background(colorBorder)
+			) {
+				Column(
+					GlanceModifier
+						.fillMaxSize()
+						.padding(2.dp)
+						.background(ColorProvider(0xFFFFFFFF.toInt()))
+						.padding(8.dp),
+					horizontalAlignment = Alignment.CenterHorizontally,
+					verticalAlignment = Alignment.CenterVertically
+				) {
+					if (weatherData != null && weatherData.isDataLoaded) {
+						Image(
+							provider = ImageProvider(weatherData.getClothingResourceId()),
+							contentDescription = "Clothing advice",
+							modifier = GlanceModifier.fillMaxSize()
+						)
+					} else {
+						Text("...")
+					}
+				}
+			}
+		}
+	}
 }
\ No newline at end of file
Index: app/src/main/java/com/example/stalp/ui/settings/ThemePreferences.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.settings\r\n\r\nimport android.content.Context\r\nimport androidx.datastore.core.DataStore\r\nimport androidx.datastore.preferences.core.Preferences\r\nimport androidx.datastore.preferences.core.edit\r\nimport androidx.datastore.preferences.core.stringPreferencesKey\r\nimport androidx.datastore.preferences.preferencesDataStore\r\nimport com.example.stalp.ui.theme.ThemeOption\r\nimport kotlinx.coroutines.flow.Flow\r\nimport kotlinx.coroutines.flow.map\r\n\r\nval Context.themeDataStore: DataStore<Preferences> by preferencesDataStore(name = \"theme_preferences\")\r\n\r\nclass ThemePreferences(context: Context) {\r\n    private val appContext = context.applicationContext\r\n\r\n    companion object {\r\n        private val THEME_OPTION_KEY = stringPreferencesKey(\"theme_option\")\r\n    }\r\n\r\n    fun themeOptionFlow(): Flow<ThemeOption> = appContext.themeDataStore.data\r\n        .map { prefs ->\r\n            val savedValue = prefs[THEME_OPTION_KEY]\r\n            ThemeOption.values().firstOrNull { it.name == savedValue } ?: ThemeOption.NordicCalm\r\n        }\r\n\r\n    suspend fun setThemeOption(option: ThemeOption) {\r\n        appContext.themeDataStore.edit { prefs ->\r\n            prefs[THEME_OPTION_KEY] = option.name\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/settings/ThemePreferences.kt b/app/src/main/java/com/example/stalp/ui/settings/ThemePreferences.kt
--- a/app/src/main/java/com/example/stalp/ui/settings/ThemePreferences.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/settings/ThemePreferences.kt	(date 1764633892635)
@@ -13,21 +13,21 @@
 val Context.themeDataStore: DataStore<Preferences> by preferencesDataStore(name = "theme_preferences")
 
 class ThemePreferences(context: Context) {
-    private val appContext = context.applicationContext
+	private val appContext = context.applicationContext
 
-    companion object {
-        private val THEME_OPTION_KEY = stringPreferencesKey("theme_option")
-    }
+	companion object {
+		private val THEME_OPTION_KEY = stringPreferencesKey("theme_option")
+	}
 
-    fun themeOptionFlow(): Flow<ThemeOption> = appContext.themeDataStore.data
-        .map { prefs ->
-            val savedValue = prefs[THEME_OPTION_KEY]
-            ThemeOption.values().firstOrNull { it.name == savedValue } ?: ThemeOption.NordicCalm
-        }
+	fun themeOptionFlow(): Flow<ThemeOption> = appContext.themeDataStore.data
+		.map { prefs ->
+			val savedValue = prefs[THEME_OPTION_KEY]
+			ThemeOption.values().firstOrNull { it.name == savedValue } ?: ThemeOption.NordicCalm
+		}
 
-    suspend fun setThemeOption(option: ThemeOption) {
-        appContext.themeDataStore.edit { prefs ->
-            prefs[THEME_OPTION_KEY] = option.name
-        }
-    }
+	suspend fun setThemeOption(option: ThemeOption) {
+		appContext.themeDataStore.edit { prefs ->
+			prefs[THEME_OPTION_KEY] = option.name
+		}
+	}
 }
Index: app/src/main/java/com/example/stalp/widget/LinearClockBitmapGenerator.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.widget\r\n\r\nimport android.content.Context\r\nimport android.graphics.Bitmap\r\nimport android.graphics.Canvas\r\nimport android.graphics.Paint\r\nimport android.graphics.Typeface\r\nimport com.example.stalp.data.DayEvent\r\nimport java.time.LocalTime\r\n\r\nobject LinearClockBitmapGenerator {\r\n\r\n    fun generate(\r\n        context: Context,\r\n        width: Int,\r\n        height: Int,\r\n        events: List<DayEvent>,\r\n        currentTime: LocalTime = LocalTime.now()\r\n    ): Bitmap {\r\n        val bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888)\r\n        val canvas = Canvas(bitmap)\r\n\r\n        // Colors\r\n        val colorFuture = 0xFFFFFFFF.toInt() // White\r\n        val colorPassed = 0xFFB7EA27.toInt() // Green\r\n        val colorRedLine = 0xFFEF4444.toInt() // Red\r\n        val colorBorder = 0xFF000000.toInt() // Black\r\n\r\n        // Paint setup\r\n        val paint = Paint().apply {\r\n            isAntiAlias = true\r\n        }\r\n\r\n        // 1. Draw Background (Future - Right Side)\r\n        paint.color = colorFuture\r\n        canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)\r\n\r\n        // 2. Draw Passed Time (Green - Left Side)\r\n        // Since the widget is zoomed and centered on 'now', everything to the left is passed.\r\n        paint.color = colorPassed\r\n        canvas.drawRect(0f, 0f, width / 2f, height.toFloat(), paint)\r\n\r\n        // Time Window Logic\r\n        // The widget shows 2 hours before and 2 hours after 'now'\r\n        val zoomHours = 2\r\n        val windowDurationMinutes = zoomHours * 2 * 60 // 240 minutes\r\n        val minutesPerPixel = windowDurationMinutes.toFloat() / width\r\n\r\n        // Window Range (in minutes from start of day)\r\n        val currentMinuteOfDay = currentTime.hour * 60 + currentTime.minute\r\n        val windowStartMinute = currentMinuteOfDay - (windowDurationMinutes / 2)\r\n        val windowEndMinute = windowStartMinute + windowDurationMinutes\r\n\r\n        // 3. Draw Events (Removed as per request)\r\n\r\n        // 4. Draw Hour Ticks and Text\r\n        paint.color = colorBorder\r\n        paint.strokeWidth = 2f\r\n        paint.textSize = 24f // Fixed size for widget text\r\n        paint.typeface = Typeface.DEFAULT_BOLD\r\n        paint.textAlign = Paint.Align.CENTER\r\n\r\n        // Find first visible hour\r\n        // windowStartMinute might be negative (e.g. 23:00 yesterday), so we floor div correctly\r\n        val firstHour = (windowStartMinute / 60) - 1\r\n        val lastHour = (windowEndMinute / 60) + 1\r\n\r\n        for (h in firstHour..lastHour) {\r\n            val hourMin = h * 60\r\n            val x = (hourMin - windowStartMinute) / minutesPerPixel\r\n\r\n            if (x >= 0 && x <= width) {\r\n                // Draw Tick\r\n                canvas.drawLine(x, 0f, x, height * 0.3f, paint)\r\n\r\n                // Draw Text\r\n                // Normalize negative hours or hours > 24 to 0-23 range\r\n                val hourText = \"${(h % 24 + 24) % 24}\"\r\n                canvas.drawText(hourText, x, height * 0.6f + 12f, paint)\r\n            }\r\n        }\r\n\r\n        // 5. Draw Red Line (Current Time - Center)\r\n        paint.color = colorRedLine\r\n        paint.strokeWidth = 4f\r\n        canvas.drawLine(width / 2f, 0f, width / 2f, height.toFloat(), paint)\r\n\r\n        // 6. Border\r\n        paint.color = colorBorder\r\n        paint.style = Paint.Style.STROKE\r\n        paint.strokeWidth = 4f\r\n        canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)\r\n        paint.style = Paint.Style.FILL // Reset\r\n\r\n        return bitmap\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/widget/LinearClockBitmapGenerator.kt b/app/src/main/java/com/example/stalp/widget/LinearClockBitmapGenerator.kt
--- a/app/src/main/java/com/example/stalp/widget/LinearClockBitmapGenerator.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/widget/LinearClockBitmapGenerator.kt	(date 1764633892617)
@@ -10,88 +10,88 @@
 
 object LinearClockBitmapGenerator {
 
-    fun generate(
-        context: Context,
-        width: Int,
-        height: Int,
-        events: List<DayEvent>,
-        currentTime: LocalTime = LocalTime.now()
-    ): Bitmap {
-        val bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888)
-        val canvas = Canvas(bitmap)
+	fun generate(
+		context: Context,
+		width: Int,
+		height: Int,
+		events: List<DayEvent>,
+		currentTime: LocalTime = LocalTime.now()
+	): Bitmap {
+		val bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888)
+		val canvas = Canvas(bitmap)
 
-        // Colors
-        val colorFuture = 0xFFFFFFFF.toInt() // White
-        val colorPassed = 0xFFB7EA27.toInt() // Green
-        val colorRedLine = 0xFFEF4444.toInt() // Red
-        val colorBorder = 0xFF000000.toInt() // Black
+		// Colors
+		val colorFuture = 0xFFFFFFFF.toInt() // White
+		val colorPassed = 0xFFB7EA27.toInt() // Green
+		val colorRedLine = 0xFFEF4444.toInt() // Red
+		val colorBorder = 0xFF000000.toInt() // Black
 
-        // Paint setup
-        val paint = Paint().apply {
-            isAntiAlias = true
-        }
+		// Paint setup
+		val paint = Paint().apply {
+			isAntiAlias = true
+		}
 
-        // 1. Draw Background (Future - Right Side)
-        paint.color = colorFuture
-        canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)
+		// 1. Draw Background (Future - Right Side)
+		paint.color = colorFuture
+		canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)
 
-        // 2. Draw Passed Time (Green - Left Side)
-        // Since the widget is zoomed and centered on 'now', everything to the left is passed.
-        paint.color = colorPassed
-        canvas.drawRect(0f, 0f, width / 2f, height.toFloat(), paint)
+		// 2. Draw Passed Time (Green - Left Side)
+		// Since the widget is zoomed and centered on 'now', everything to the left is passed.
+		paint.color = colorPassed
+		canvas.drawRect(0f, 0f, width / 2f, height.toFloat(), paint)
 
-        // Time Window Logic
-        // The widget shows 2 hours before and 2 hours after 'now'
-        val zoomHours = 2
-        val windowDurationMinutes = zoomHours * 2 * 60 // 240 minutes
-        val minutesPerPixel = windowDurationMinutes.toFloat() / width
+		// Time Window Logic
+		// The widget shows 2 hours before and 2 hours after 'now'
+		val zoomHours = 2
+		val windowDurationMinutes = zoomHours * 2 * 60 // 240 minutes
+		val minutesPerPixel = windowDurationMinutes.toFloat() / width
 
-        // Window Range (in minutes from start of day)
-        val currentMinuteOfDay = currentTime.hour * 60 + currentTime.minute
-        val windowStartMinute = currentMinuteOfDay - (windowDurationMinutes / 2)
-        val windowEndMinute = windowStartMinute + windowDurationMinutes
+		// Window Range (in minutes from start of day)
+		val currentMinuteOfDay = currentTime.hour * 60 + currentTime.minute
+		val windowStartMinute = currentMinuteOfDay - (windowDurationMinutes / 2)
+		val windowEndMinute = windowStartMinute + windowDurationMinutes
 
-        // 3. Draw Events (Removed as per request)
+		// 3. Draw Events (Removed as per request)
 
-        // 4. Draw Hour Ticks and Text
-        paint.color = colorBorder
-        paint.strokeWidth = 2f
-        paint.textSize = 24f // Fixed size for widget text
-        paint.typeface = Typeface.DEFAULT_BOLD
-        paint.textAlign = Paint.Align.CENTER
+		// 4. Draw Hour Ticks and Text
+		paint.color = colorBorder
+		paint.strokeWidth = 2f
+		paint.textSize = 24f // Fixed size for widget text
+		paint.typeface = Typeface.DEFAULT_BOLD
+		paint.textAlign = Paint.Align.CENTER
 
-        // Find first visible hour
-        // windowStartMinute might be negative (e.g. 23:00 yesterday), so we floor div correctly
-        val firstHour = (windowStartMinute / 60) - 1
-        val lastHour = (windowEndMinute / 60) + 1
+		// Find first visible hour
+		// windowStartMinute might be negative (e.g. 23:00 yesterday), so we floor div correctly
+		val firstHour = (windowStartMinute / 60) - 1
+		val lastHour = (windowEndMinute / 60) + 1
 
-        for (h in firstHour..lastHour) {
-            val hourMin = h * 60
-            val x = (hourMin - windowStartMinute) / minutesPerPixel
+		for (h in firstHour..lastHour) {
+			val hourMin = h * 60
+			val x = (hourMin - windowStartMinute) / minutesPerPixel
 
-            if (x >= 0 && x <= width) {
-                // Draw Tick
-                canvas.drawLine(x, 0f, x, height * 0.3f, paint)
+			if (x >= 0 && x <= width) {
+				// Draw Tick
+				canvas.drawLine(x, 0f, x, height * 0.3f, paint)
 
-                // Draw Text
-                // Normalize negative hours or hours > 24 to 0-23 range
-                val hourText = "${(h % 24 + 24) % 24}"
-                canvas.drawText(hourText, x, height * 0.6f + 12f, paint)
-            }
-        }
+				// Draw Text
+				// Normalize negative hours or hours > 24 to 0-23 range
+				val hourText = "${(h % 24 + 24) % 24}"
+				canvas.drawText(hourText, x, height * 0.6f + 12f, paint)
+			}
+		}
 
-        // 5. Draw Red Line (Current Time - Center)
-        paint.color = colorRedLine
-        paint.strokeWidth = 4f
-        canvas.drawLine(width / 2f, 0f, width / 2f, height.toFloat(), paint)
+		// 5. Draw Red Line (Current Time - Center)
+		paint.color = colorRedLine
+		paint.strokeWidth = 4f
+		canvas.drawLine(width / 2f, 0f, width / 2f, height.toFloat(), paint)
 
-        // 6. Border
-        paint.color = colorBorder
-        paint.style = Paint.Style.STROKE
-        paint.strokeWidth = 4f
-        canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)
-        paint.style = Paint.Style.FILL // Reset
+		// 6. Border
+		paint.color = colorBorder
+		paint.style = Paint.Style.STROKE
+		paint.strokeWidth = 4f
+		canvas.drawRect(0f, 0f, width.toFloat(), height.toFloat(), paint)
+		paint.style = Paint.Style.FILL // Reset
 
-        return bitmap
-    }
+		return bitmap
+	}
 }
Index: app/src/main/java/com/example/stalp/ui/settings/SettingsScreen.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.settings\r\n\r\nimport android.Manifest\r\nimport android.content.pm.PackageManager\r\nimport androidx.activity.compose.rememberLauncherForActivityResult\r\nimport androidx.activity.result.contract.ActivityResultContracts\r\nimport androidx.compose.foundation.clickable\r\nimport androidx.compose.foundation.layout.Column\r\nimport androidx.compose.foundation.layout.Row\r\nimport androidx.compose.foundation.layout.Spacer\r\nimport androidx.compose.foundation.layout.fillMaxSize\r\nimport androidx.compose.foundation.layout.fillMaxWidth\r\nimport androidx.compose.foundation.layout.height\r\nimport androidx.compose.foundation.layout.padding\r\nimport androidx.compose.material3.Button\r\nimport androidx.compose.material3.ExperimentalMaterial3Api\r\nimport androidx.compose.material3.Icon\r\nimport androidx.compose.material3.IconButton\r\nimport androidx.compose.material3.MaterialTheme\r\nimport androidx.compose.material3.OutlinedTextField\r\nimport androidx.compose.material3.RadioButton\r\nimport androidx.compose.material3.Scaffold\r\nimport androidx.compose.material3.Switch\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.material3.TopAppBar\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.runtime.collectAsState\r\nimport androidx.compose.runtime.getValue\r\nimport androidx.compose.runtime.mutableStateOf\r\nimport androidx.compose.runtime.remember\r\nimport androidx.compose.runtime.rememberCoroutineScope\r\nimport androidx.compose.runtime.setValue\r\nimport androidx.compose.ui.Alignment\r\nimport androidx.compose.ui.Modifier\r\nimport androidx.compose.ui.platform.LocalContext\r\nimport androidx.compose.ui.unit.dp\r\nimport androidx.core.content.ContextCompat\r\nimport com.example.stalp.data.WeatherLocationSettings\r\nimport com.example.stalp.data.WeatherRepository\r\nimport com.example.stalp.ui.icons.StalpIcons\r\nimport kotlinx.coroutines.launch\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun SettingsScreen(\r\n    onBack: () -> Unit\r\n) {\r\n    val context = LocalContext.current\r\n    val scope = rememberCoroutineScope()\r\n    val weatherRepository = remember { WeatherRepository(context) }\r\n\r\n    val locationSettings by weatherRepository.locationSettingsFlow.collectAsState(initial = WeatherLocationSettings())\r\n\r\n    // Permission launcher\r\n    val locationPermissionLauncher = rememberLauncherForActivityResult(\r\n        contract = ActivityResultContracts.RequestMultiplePermissions(),\r\n        onResult = { permissions ->\r\n            val granted = permissions[Manifest.permission.ACCESS_COARSE_LOCATION] == true ||\r\n                          permissions[Manifest.permission.ACCESS_FINE_LOCATION] == true\r\n            if (granted) {\r\n                // If granted, we ensure the setting is set to true\r\n                scope.launch {\r\n                    weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName)\r\n                }\r\n            } else {\r\n                // If denied, we might revert the toggle or just leave it.\r\n                // For better UX, we could show a snackbar, but let's stick to simple logic:\r\n                // If denied, we turn off \"Use current location\" to be consistent.\r\n                scope.launch {\r\n                    weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName)\r\n                }\r\n            }\r\n        }\r\n    )\r\n\r\n    Scaffold(\r\n        topBar = {\r\n            TopAppBar(\r\n                title = { Text(\"Inställningar\") },\r\n                navigationIcon = {\r\n                    IconButton(onClick = onBack) {\r\n                        Icon(StalpIcons.ArrowBack, contentDescription = \"Back\")\r\n                    }\r\n                }\r\n            )\r\n        }\r\n    ) { padding ->\r\n        Column(\r\n            modifier = Modifier\r\n                .fillMaxSize()\r\n                .padding(padding)\r\n                .padding(16.dp)\r\n        ) {\r\n            Text(\"Väder\", style = MaterialTheme.typography.titleMedium)\r\n            Spacer(modifier = Modifier.height(16.dp))\r\n\r\n            // Location Settings\r\n            Text(\"Plats\", style = MaterialTheme.typography.titleSmall)\r\n\r\n            // Toggle for Current Location\r\n            Row(\r\n                modifier = Modifier\r\n                    .fillMaxWidth()\r\n                    .clickable {\r\n                         val newValue = !locationSettings.useCurrentLocation\r\n                         if (newValue) {\r\n                             // Check permission before enabling\r\n                             val hasPermission = ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED\r\n                             if (hasPermission) {\r\n                                 scope.launch { weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName) }\r\n                             } else {\r\n                                 locationPermissionLauncher.launch(\r\n                                     arrayOf(\r\n                                         Manifest.permission.ACCESS_COARSE_LOCATION,\r\n                                         Manifest.permission.ACCESS_FINE_LOCATION\r\n                                     )\r\n                                 )\r\n                             }\r\n                         } else {\r\n                             scope.launch { weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName) }\r\n                         }\r\n                    }\r\n                    .padding(vertical = 8.dp),\r\n                verticalAlignment = Alignment.CenterVertically\r\n            ) {\r\n                Text(\r\n                    text = \"Använd nuvarande position\",\r\n                    modifier = Modifier.weight(1f),\r\n                    style = MaterialTheme.typography.bodyMedium\r\n                )\r\n                Switch(\r\n                    checked = locationSettings.useCurrentLocation,\r\n                    onCheckedChange = { checked ->\r\n                        if (checked) {\r\n                             val hasPermission = ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED\r\n                             if (hasPermission) {\r\n                                 scope.launch { weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName) }\r\n                             } else {\r\n                                 locationPermissionLauncher.launch(\r\n                                     arrayOf(\r\n                                         Manifest.permission.ACCESS_COARSE_LOCATION,\r\n                                         Manifest.permission.ACCESS_FINE_LOCATION\r\n                                     )\r\n                                 )\r\n                             }\r\n                        } else {\r\n                            scope.launch { weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName) }\r\n                        }\r\n                    }\r\n                )\r\n            }\r\n\r\n            // Manual Location Input (Visible if Current Location is OFF)\r\n            if (!locationSettings.useCurrentLocation) {\r\n                Spacer(modifier = Modifier.height(8.dp))\r\n                OutlinedTextField(\r\n                    value = locationSettings.manualLocationName,\r\n                    onValueChange = { newName ->\r\n                        scope.launch {\r\n                            weatherRepository.saveLocationSettings(false, newName)\r\n                        }\r\n                    },\r\n                    label = { Text(\"Ange ort\") },\r\n                    modifier = Modifier.fillMaxWidth(),\r\n                    singleLine = true\r\n                )\r\n            }\r\n\r\n            Spacer(modifier = Modifier.height(24.dp))\r\n\r\n            // Provider Info\r\n            Text(\"Väderleverantör: Open-Meteo (Standard)\", style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.onSurfaceVariant)\r\n\r\n            Spacer(modifier = Modifier.height(24.dp))\r\n\r\n            Text(\"Kalender\", style = MaterialTheme.typography.titleMedium)\r\n            Spacer(modifier = Modifier.height(8.dp))\r\n            // Placeholder for Calendar Selection\r\n            Text(\"Kalenderkälla: Enhetskalender\", style = MaterialTheme.typography.bodyMedium)\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/settings/SettingsScreen.kt b/app/src/main/java/com/example/stalp/ui/settings/SettingsScreen.kt
--- a/app/src/main/java/com/example/stalp/ui/settings/SettingsScreen.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/settings/SettingsScreen.kt	(date 1764633892321)
@@ -12,13 +12,11 @@
 import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.height
 import androidx.compose.foundation.layout.padding
-import androidx.compose.material3.Button
 import androidx.compose.material3.ExperimentalMaterial3Api
 import androidx.compose.material3.Icon
 import androidx.compose.material3.IconButton
 import androidx.compose.material3.MaterialTheme
 import androidx.compose.material3.OutlinedTextField
-import androidx.compose.material3.RadioButton
 import androidx.compose.material3.Scaffold
 import androidx.compose.material3.Switch
 import androidx.compose.material3.Text
@@ -26,10 +24,8 @@
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.collectAsState
 import androidx.compose.runtime.getValue
-import androidx.compose.runtime.mutableStateOf
 import androidx.compose.runtime.remember
 import androidx.compose.runtime.rememberCoroutineScope
-import androidx.compose.runtime.setValue
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.platform.LocalContext
@@ -43,140 +39,176 @@
 @OptIn(ExperimentalMaterial3Api::class)
 @Composable
 fun SettingsScreen(
-    onBack: () -> Unit
+	onBack: () -> Unit
 ) {
-    val context = LocalContext.current
-    val scope = rememberCoroutineScope()
-    val weatherRepository = remember { WeatherRepository(context) }
+	val context = LocalContext.current
+	val scope = rememberCoroutineScope()
+	val weatherRepository = remember { WeatherRepository(context) }
 
-    val locationSettings by weatherRepository.locationSettingsFlow.collectAsState(initial = WeatherLocationSettings())
+	val locationSettings by weatherRepository.locationSettingsFlow.collectAsState(initial = WeatherLocationSettings())
 
-    // Permission launcher
-    val locationPermissionLauncher = rememberLauncherForActivityResult(
-        contract = ActivityResultContracts.RequestMultiplePermissions(),
-        onResult = { permissions ->
-            val granted = permissions[Manifest.permission.ACCESS_COARSE_LOCATION] == true ||
-                          permissions[Manifest.permission.ACCESS_FINE_LOCATION] == true
-            if (granted) {
-                // If granted, we ensure the setting is set to true
-                scope.launch {
-                    weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName)
-                }
-            } else {
-                // If denied, we might revert the toggle or just leave it.
-                // For better UX, we could show a snackbar, but let's stick to simple logic:
-                // If denied, we turn off "Use current location" to be consistent.
-                scope.launch {
-                    weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName)
-                }
-            }
-        }
-    )
+	// Permission launcher
+	val locationPermissionLauncher = rememberLauncherForActivityResult(
+		contract = ActivityResultContracts.RequestMultiplePermissions(),
+		onResult = { permissions ->
+			val granted = permissions[Manifest.permission.ACCESS_COARSE_LOCATION] == true ||
+					permissions[Manifest.permission.ACCESS_FINE_LOCATION] == true
+			if (granted) {
+				// If granted, we ensure the setting is set to true
+				scope.launch {
+					weatherRepository.saveLocationSettings(
+						true,
+						locationSettings.manualLocationName
+					)
+				}
+			} else {
+				// If denied, we might revert the toggle or just leave it.
+				// For better UX, we could show a snackbar, but let's stick to simple logic:
+				// If denied, we turn off "Use current location" to be consistent.
+				scope.launch {
+					weatherRepository.saveLocationSettings(
+						false,
+						locationSettings.manualLocationName
+					)
+				}
+			}
+		}
+	)
 
-    Scaffold(
-        topBar = {
-            TopAppBar(
-                title = { Text("Inställningar") },
-                navigationIcon = {
-                    IconButton(onClick = onBack) {
-                        Icon(StalpIcons.ArrowBack, contentDescription = "Back")
-                    }
-                }
-            )
-        }
-    ) { padding ->
-        Column(
-            modifier = Modifier
-                .fillMaxSize()
-                .padding(padding)
-                .padding(16.dp)
-        ) {
-            Text("Väder", style = MaterialTheme.typography.titleMedium)
-            Spacer(modifier = Modifier.height(16.dp))
+	Scaffold(
+		topBar = {
+			TopAppBar(
+				title = { Text("Inställningar") },
+				navigationIcon = {
+					IconButton(onClick = onBack) {
+						Icon(StalpIcons.ArrowBack, contentDescription = "Back")
+					}
+				}
+			)
+		}
+	) { padding ->
+		Column(
+			modifier = Modifier
+				.fillMaxSize()
+				.padding(padding)
+				.padding(16.dp)
+		) {
+			Text("Väder", style = MaterialTheme.typography.titleMedium)
+			Spacer(modifier = Modifier.height(16.dp))
 
-            // Location Settings
-            Text("Plats", style = MaterialTheme.typography.titleSmall)
+			// Location Settings
+			Text("Plats", style = MaterialTheme.typography.titleSmall)
 
-            // Toggle for Current Location
-            Row(
-                modifier = Modifier
-                    .fillMaxWidth()
-                    .clickable {
-                         val newValue = !locationSettings.useCurrentLocation
-                         if (newValue) {
-                             // Check permission before enabling
-                             val hasPermission = ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED
-                             if (hasPermission) {
-                                 scope.launch { weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName) }
-                             } else {
-                                 locationPermissionLauncher.launch(
-                                     arrayOf(
-                                         Manifest.permission.ACCESS_COARSE_LOCATION,
-                                         Manifest.permission.ACCESS_FINE_LOCATION
-                                     )
-                                 )
-                             }
-                         } else {
-                             scope.launch { weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName) }
-                         }
-                    }
-                    .padding(vertical = 8.dp),
-                verticalAlignment = Alignment.CenterVertically
-            ) {
-                Text(
-                    text = "Använd nuvarande position",
-                    modifier = Modifier.weight(1f),
-                    style = MaterialTheme.typography.bodyMedium
-                )
-                Switch(
-                    checked = locationSettings.useCurrentLocation,
-                    onCheckedChange = { checked ->
-                        if (checked) {
-                             val hasPermission = ContextCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) == PackageManager.PERMISSION_GRANTED
-                             if (hasPermission) {
-                                 scope.launch { weatherRepository.saveLocationSettings(true, locationSettings.manualLocationName) }
-                             } else {
-                                 locationPermissionLauncher.launch(
-                                     arrayOf(
-                                         Manifest.permission.ACCESS_COARSE_LOCATION,
-                                         Manifest.permission.ACCESS_FINE_LOCATION
-                                     )
-                                 )
-                             }
-                        } else {
-                            scope.launch { weatherRepository.saveLocationSettings(false, locationSettings.manualLocationName) }
-                        }
-                    }
-                )
-            }
+			// Toggle for Current Location
+			Row(
+				modifier = Modifier
+					.fillMaxWidth()
+					.clickable {
+						val newValue = !locationSettings.useCurrentLocation
+						if (newValue) {
+							// Check permission before enabling
+							val hasPermission = ContextCompat.checkSelfPermission(
+								context,
+								Manifest.permission.ACCESS_COARSE_LOCATION
+							) == PackageManager.PERMISSION_GRANTED
+							if (hasPermission) {
+								scope.launch {
+									weatherRepository.saveLocationSettings(
+										true,
+										locationSettings.manualLocationName
+									)
+								}
+							} else {
+								locationPermissionLauncher.launch(
+									arrayOf(
+										Manifest.permission.ACCESS_COARSE_LOCATION,
+										Manifest.permission.ACCESS_FINE_LOCATION
+									)
+								)
+							}
+						} else {
+							scope.launch {
+								weatherRepository.saveLocationSettings(
+									false,
+									locationSettings.manualLocationName
+								)
+							}
+						}
+					}
+					.padding(vertical = 8.dp),
+				verticalAlignment = Alignment.CenterVertically
+			) {
+				Text(
+					text = "Använd nuvarande position",
+					modifier = Modifier.weight(1f),
+					style = MaterialTheme.typography.bodyMedium
+				)
+				Switch(
+					checked = locationSettings.useCurrentLocation,
+					onCheckedChange = { checked ->
+						if (checked) {
+							val hasPermission = ContextCompat.checkSelfPermission(
+								context,
+								Manifest.permission.ACCESS_COARSE_LOCATION
+							) == PackageManager.PERMISSION_GRANTED
+							if (hasPermission) {
+								scope.launch {
+									weatherRepository.saveLocationSettings(
+										true,
+										locationSettings.manualLocationName
+									)
+								}
+							} else {
+								locationPermissionLauncher.launch(
+									arrayOf(
+										Manifest.permission.ACCESS_COARSE_LOCATION,
+										Manifest.permission.ACCESS_FINE_LOCATION
+									)
+								)
+							}
+						} else {
+							scope.launch {
+								weatherRepository.saveLocationSettings(
+									false,
+									locationSettings.manualLocationName
+								)
+							}
+						}
+					}
+				)
+			}
 
-            // Manual Location Input (Visible if Current Location is OFF)
-            if (!locationSettings.useCurrentLocation) {
-                Spacer(modifier = Modifier.height(8.dp))
-                OutlinedTextField(
-                    value = locationSettings.manualLocationName,
-                    onValueChange = { newName ->
-                        scope.launch {
-                            weatherRepository.saveLocationSettings(false, newName)
-                        }
-                    },
-                    label = { Text("Ange ort") },
-                    modifier = Modifier.fillMaxWidth(),
-                    singleLine = true
-                )
-            }
+			// Manual Location Input (Visible if Current Location is OFF)
+			if (!locationSettings.useCurrentLocation) {
+				Spacer(modifier = Modifier.height(8.dp))
+				OutlinedTextField(
+					value = locationSettings.manualLocationName,
+					onValueChange = { newName ->
+						scope.launch {
+							weatherRepository.saveLocationSettings(false, newName)
+						}
+					},
+					label = { Text("Ange ort") },
+					modifier = Modifier.fillMaxWidth(),
+					singleLine = true
+				)
+			}
 
-            Spacer(modifier = Modifier.height(24.dp))
+			Spacer(modifier = Modifier.height(24.dp))
 
-            // Provider Info
-            Text("Väderleverantör: Open-Meteo (Standard)", style = MaterialTheme.typography.bodySmall, color = MaterialTheme.colorScheme.onSurfaceVariant)
+			// Provider Info
+			Text(
+				"Väderleverantör: Open-Meteo (Standard)",
+				style = MaterialTheme.typography.bodySmall,
+				color = MaterialTheme.colorScheme.onSurfaceVariant
+			)
 
-            Spacer(modifier = Modifier.height(24.dp))
+			Spacer(modifier = Modifier.height(24.dp))
 
-            Text("Kalender", style = MaterialTheme.typography.titleMedium)
-            Spacer(modifier = Modifier.height(8.dp))
-            // Placeholder for Calendar Selection
-            Text("Kalenderkälla: Enhetskalender", style = MaterialTheme.typography.bodyMedium)
-        }
-    }
+			Text("Kalender", style = MaterialTheme.typography.titleMedium)
+			Spacer(modifier = Modifier.height(8.dp))
+			// Placeholder for Calendar Selection
+			Text("Kalenderkälla: Enhetskalender", style = MaterialTheme.typography.bodyMedium)
+		}
+	}
 }
Index: app/src/main/java/com/example/stalp/ui/icons/StalpIcons.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.icons\r\n\r\nimport androidx.compose.ui.graphics.Color\r\nimport androidx.compose.ui.graphics.PathFillType\r\nimport androidx.compose.ui.graphics.SolidColor\r\nimport androidx.compose.ui.graphics.StrokeCap\r\nimport androidx.compose.ui.graphics.StrokeJoin\r\nimport androidx.compose.ui.graphics.vector.ImageVector\r\nimport androidx.compose.ui.graphics.vector.path\r\nimport androidx.compose.ui.unit.dp\r\n\r\nobject StalpIcons {\r\n    val Settings: ImageVector = ImageVector.Builder(\r\n        name = \"Menu\",\r\n        defaultWidth = 24.0.dp,\r\n        defaultHeight = 24.0.dp,\r\n        viewportWidth = 24.0f,\r\n        viewportHeight = 24.0f\r\n    ).apply {\r\n        path(\r\n            fill = SolidColor(Color.Black),\r\n            fillAlpha = 1f,\r\n            stroke = null,\r\n            strokeAlpha = 1f,\r\n            strokeLineWidth = 1.0f,\r\n            strokeLineCap = StrokeCap.Butt,\r\n            strokeLineJoin = StrokeJoin.Miter,\r\n            strokeLineMiter = 1.0f,\r\n            pathFillType = PathFillType.NonZero\r\n        ) {\r\n            moveTo(3f, 18f)\r\n            horizontalLineToRelative(18f)\r\n            verticalLineToRelative(-2f)\r\n            horizontalLineTo(3f)\r\n            verticalLineToRelative(2f)\r\n            close()\r\n            moveTo(3f, 13f)\r\n            horizontalLineToRelative(18f)\r\n            verticalLineToRelative(-2f)\r\n            horizontalLineTo(3f)\r\n            verticalLineToRelative(2f)\r\n            close()\r\n            moveTo(3f, 6f)\r\n            verticalLineToRelative(2f)\r\n            horizontalLineToRelative(18f)\r\n            verticalLineTo(6f)\r\n            horizontalLineTo(3f)\r\n            close()\r\n        }\r\n    }.build()\r\n\r\n    val ArrowBack: ImageVector = ImageVector.Builder(\r\n        name = \"ArrowBack\",\r\n        defaultWidth = 24.0.dp,\r\n        defaultHeight = 24.0.dp,\r\n        viewportWidth = 24.0f,\r\n        viewportHeight = 24.0f,\r\n        autoMirror = true\r\n    ).apply {\r\n        path(\r\n            fill = SolidColor(Color.Black),\r\n            fillAlpha = 1.0f,\r\n            stroke = null,\r\n            strokeAlpha = 1.0f,\r\n            strokeLineWidth = 1.0f,\r\n            strokeLineCap = StrokeCap.Butt,\r\n            strokeLineJoin = StrokeJoin.Miter,\r\n            strokeLineMiter = 1.0f,\r\n            pathFillType = PathFillType.NonZero\r\n        ) {\r\n            moveTo(20f, 11f)\r\n            horizontalLineTo(7.83f)\r\n            lineToRelative(5.59f, -5.59f)\r\n            lineTo(12f, 4f)\r\n            lineToRelative(-8f, 8f)\r\n            lineToRelative(8f, 8f)\r\n            lineToRelative(1.41f, -1.41f)\r\n            lineTo(7.83f, 13f)\r\n            horizontalLineTo(20f)\r\n            verticalLineToRelative(-2f)\r\n            close()\r\n        }\r\n    }.build()\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/icons/StalpIcons.kt b/app/src/main/java/com/example/stalp/ui/icons/StalpIcons.kt
--- a/app/src/main/java/com/example/stalp/ui/icons/StalpIcons.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/icons/StalpIcons.kt	(date 1764633892285)
@@ -10,75 +10,75 @@
 import androidx.compose.ui.unit.dp
 
 object StalpIcons {
-    val Settings: ImageVector = ImageVector.Builder(
-        name = "Menu",
-        defaultWidth = 24.0.dp,
-        defaultHeight = 24.0.dp,
-        viewportWidth = 24.0f,
-        viewportHeight = 24.0f
-    ).apply {
-        path(
-            fill = SolidColor(Color.Black),
-            fillAlpha = 1f,
-            stroke = null,
-            strokeAlpha = 1f,
-            strokeLineWidth = 1.0f,
-            strokeLineCap = StrokeCap.Butt,
-            strokeLineJoin = StrokeJoin.Miter,
-            strokeLineMiter = 1.0f,
-            pathFillType = PathFillType.NonZero
-        ) {
-            moveTo(3f, 18f)
-            horizontalLineToRelative(18f)
-            verticalLineToRelative(-2f)
-            horizontalLineTo(3f)
-            verticalLineToRelative(2f)
-            close()
-            moveTo(3f, 13f)
-            horizontalLineToRelative(18f)
-            verticalLineToRelative(-2f)
-            horizontalLineTo(3f)
-            verticalLineToRelative(2f)
-            close()
-            moveTo(3f, 6f)
-            verticalLineToRelative(2f)
-            horizontalLineToRelative(18f)
-            verticalLineTo(6f)
-            horizontalLineTo(3f)
-            close()
-        }
-    }.build()
+	val Settings: ImageVector = ImageVector.Builder(
+		name = "Menu",
+		defaultWidth = 24.0.dp,
+		defaultHeight = 24.0.dp,
+		viewportWidth = 24.0f,
+		viewportHeight = 24.0f
+	).apply {
+		path(
+			fill = SolidColor(Color.Black),
+			fillAlpha = 1f,
+			stroke = null,
+			strokeAlpha = 1f,
+			strokeLineWidth = 1.0f,
+			strokeLineCap = StrokeCap.Butt,
+			strokeLineJoin = StrokeJoin.Miter,
+			strokeLineMiter = 1.0f,
+			pathFillType = PathFillType.NonZero
+		) {
+			moveTo(3f, 18f)
+			horizontalLineToRelative(18f)
+			verticalLineToRelative(-2f)
+			horizontalLineTo(3f)
+			verticalLineToRelative(2f)
+			close()
+			moveTo(3f, 13f)
+			horizontalLineToRelative(18f)
+			verticalLineToRelative(-2f)
+			horizontalLineTo(3f)
+			verticalLineToRelative(2f)
+			close()
+			moveTo(3f, 6f)
+			verticalLineToRelative(2f)
+			horizontalLineToRelative(18f)
+			verticalLineTo(6f)
+			horizontalLineTo(3f)
+			close()
+		}
+	}.build()
 
-    val ArrowBack: ImageVector = ImageVector.Builder(
-        name = "ArrowBack",
-        defaultWidth = 24.0.dp,
-        defaultHeight = 24.0.dp,
-        viewportWidth = 24.0f,
-        viewportHeight = 24.0f,
-        autoMirror = true
-    ).apply {
-        path(
-            fill = SolidColor(Color.Black),
-            fillAlpha = 1.0f,
-            stroke = null,
-            strokeAlpha = 1.0f,
-            strokeLineWidth = 1.0f,
-            strokeLineCap = StrokeCap.Butt,
-            strokeLineJoin = StrokeJoin.Miter,
-            strokeLineMiter = 1.0f,
-            pathFillType = PathFillType.NonZero
-        ) {
-            moveTo(20f, 11f)
-            horizontalLineTo(7.83f)
-            lineToRelative(5.59f, -5.59f)
-            lineTo(12f, 4f)
-            lineToRelative(-8f, 8f)
-            lineToRelative(8f, 8f)
-            lineToRelative(1.41f, -1.41f)
-            lineTo(7.83f, 13f)
-            horizontalLineTo(20f)
-            verticalLineToRelative(-2f)
-            close()
-        }
-    }.build()
+	val ArrowBack: ImageVector = ImageVector.Builder(
+		name = "ArrowBack",
+		defaultWidth = 24.0.dp,
+		defaultHeight = 24.0.dp,
+		viewportWidth = 24.0f,
+		viewportHeight = 24.0f,
+		autoMirror = true
+	).apply {
+		path(
+			fill = SolidColor(Color.Black),
+			fillAlpha = 1.0f,
+			stroke = null,
+			strokeAlpha = 1.0f,
+			strokeLineWidth = 1.0f,
+			strokeLineCap = StrokeCap.Butt,
+			strokeLineJoin = StrokeJoin.Miter,
+			strokeLineMiter = 1.0f,
+			pathFillType = PathFillType.NonZero
+		) {
+			moveTo(20f, 11f)
+			horizontalLineTo(7.83f)
+			lineToRelative(5.59f, -5.59f)
+			lineTo(12f, 4f)
+			lineToRelative(-8f, 8f)
+			lineToRelative(8f, 8f)
+			lineToRelative(1.41f, -1.41f)
+			lineTo(7.83f, 13f)
+			horizontalLineTo(20f)
+			verticalLineToRelative(-2f)
+			close()
+		}
+	}.build()
 }
Index: app/src/main/java/com/example/stalp/ui/theme/Type.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.theme\r\n\r\nimport androidx.compose.material3.Typography\r\nimport androidx.compose.ui.text.TextStyle\r\nimport androidx.compose.ui.text.font.FontFamily\r\nimport androidx.compose.ui.text.font.FontWeight\r\nimport androidx.compose.ui.unit.sp\r\n\r\n// Set of Material typography styles to start with\r\nval Typography = Typography(\r\n    bodyLarge = TextStyle(\r\n        fontFamily = FontFamily.Default,\r\n        fontWeight = FontWeight.Normal,\r\n        fontSize = 16.sp,\r\n        lineHeight = 24.sp,\r\n        letterSpacing = 0.5.sp\r\n    )\r\n    /* Other default text styles to override\r\n    titleLarge = TextStyle(\r\n        fontFamily = FontFamily.Default,\r\n        fontWeight = FontWeight.Normal,\r\n        fontSize = 22.sp,\r\n        lineHeight = 28.sp,\r\n        letterSpacing = 0.sp\r\n    ),\r\n    labelSmall = TextStyle(\r\n        fontFamily = FontFamily.Default,\r\n        fontWeight = FontWeight.Medium,\r\n        fontSize = 11.sp,\r\n        lineHeight = 16.sp,\r\n        letterSpacing = 0.5.sp\r\n    )\r\n    */\r\n)
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/theme/Type.kt b/app/src/main/java/com/example/stalp/ui/theme/Type.kt
--- a/app/src/main/java/com/example/stalp/ui/theme/Type.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/theme/Type.kt	(date 1764633892504)
@@ -8,27 +8,27 @@
 
 // Set of Material typography styles to start with
 val Typography = Typography(
-    bodyLarge = TextStyle(
-        fontFamily = FontFamily.Default,
-        fontWeight = FontWeight.Normal,
-        fontSize = 16.sp,
-        lineHeight = 24.sp,
-        letterSpacing = 0.5.sp
-    )
-    /* Other default text styles to override
-    titleLarge = TextStyle(
-        fontFamily = FontFamily.Default,
-        fontWeight = FontWeight.Normal,
-        fontSize = 22.sp,
-        lineHeight = 28.sp,
-        letterSpacing = 0.sp
-    ),
-    labelSmall = TextStyle(
-        fontFamily = FontFamily.Default,
-        fontWeight = FontWeight.Medium,
-        fontSize = 11.sp,
-        lineHeight = 16.sp,
-        letterSpacing = 0.5.sp
-    )
-    */
+	bodyLarge = TextStyle(
+		fontFamily = FontFamily.Default,
+		fontWeight = FontWeight.Normal,
+		fontSize = 16.sp,
+		lineHeight = 24.sp,
+		letterSpacing = 0.5.sp
+	)
+	/* Other default text styles to override
+	titleLarge = TextStyle(
+		fontFamily = FontFamily.Default,
+		fontWeight = FontWeight.Normal,
+		fontSize = 22.sp,
+		lineHeight = 28.sp,
+		letterSpacing = 0.sp
+	),
+	labelSmall = TextStyle(
+		fontFamily = FontFamily.Default,
+		fontWeight = FontWeight.Medium,
+		fontSize = 11.sp,
+		lineHeight = 16.sp,
+		letterSpacing = 0.5.sp
+	)
+	*/
 )
\ No newline at end of file
Index: app/src/main/java/com/example/stalp/ui/theme/ThemeSelector.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.stalp.ui.theme\r\n\r\nimport androidx.compose.foundation.layout.fillMaxWidth\r\nimport androidx.compose.material3.ExperimentalMaterial3Api\r\nimport androidx.compose.material3.SegmentedButton\r\nimport androidx.compose.material3.SegmentedButtonDefaults\r\nimport androidx.compose.material3.SingleChoiceSegmentedButtonRow\r\nimport androidx.compose.material3.Text\r\nimport androidx.compose.runtime.Composable\r\nimport androidx.compose.ui.Modifier\r\n\r\n@OptIn(ExperimentalMaterial3Api::class)\r\n@Composable\r\nfun ThemeSelector(\r\n    selectedOption: ThemeOption,\r\n    onOptionSelected: (ThemeOption) -> Unit,\r\n    modifier: Modifier = Modifier,\r\n) {\r\n    SingleChoiceSegmentedButtonRow(modifier = modifier.fillMaxWidth()) {\r\n        ThemeOption.values().forEachIndexed { index, option ->\r\n            SegmentedButton(\r\n                selected = option == selectedOption,\r\n                onClick = { onOptionSelected(option) },\r\n                shape = SegmentedButtonDefaults.itemShape(index, ThemeOption.values().size),\r\n                label = { Text(option.displayName) },\r\n            )\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/stalp/ui/theme/ThemeSelector.kt b/app/src/main/java/com/example/stalp/ui/theme/ThemeSelector.kt
--- a/app/src/main/java/com/example/stalp/ui/theme/ThemeSelector.kt	(revision 5bf5ca3d14c53559713a46bada169f48551727ed)
+++ b/app/src/main/java/com/example/stalp/ui/theme/ThemeSelector.kt	(date 1764633892599)
@@ -12,18 +12,18 @@
 @OptIn(ExperimentalMaterial3Api::class)
 @Composable
 fun ThemeSelector(
-    selectedOption: ThemeOption,
-    onOptionSelected: (ThemeOption) -> Unit,
-    modifier: Modifier = Modifier,
+	selectedOption: ThemeOption,
+	onOptionSelected: (ThemeOption) -> Unit,
+	modifier: Modifier = Modifier,
 ) {
-    SingleChoiceSegmentedButtonRow(modifier = modifier.fillMaxWidth()) {
-        ThemeOption.values().forEachIndexed { index, option ->
-            SegmentedButton(
-                selected = option == selectedOption,
-                onClick = { onOptionSelected(option) },
-                shape = SegmentedButtonDefaults.itemShape(index, ThemeOption.values().size),
-                label = { Text(option.displayName) },
-            )
-        }
-    }
+	SingleChoiceSegmentedButtonRow(modifier = modifier.fillMaxWidth()) {
+		ThemeOption.values().forEachIndexed { index, option ->
+			SegmentedButton(
+				selected = option == selectedOption,
+				onClick = { onOptionSelected(option) },
+				shape = SegmentedButtonDefaults.itemShape(index, ThemeOption.values().size),
+				label = { Text(option.displayName) },
+			)
+		}
+	}
 }
